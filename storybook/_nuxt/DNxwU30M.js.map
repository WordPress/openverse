{"version":3,"file":"DNxwU30M.js","sources":["../../src/components/VHeader/VSearchBar/VStandaloneSearchBar.vue","../../src/components/VHomepageContent.vue","../../src/pages/index.vue"],"sourcesContent":["<script setup lang=\"ts\">\n/**\n * Displays a search input for a search query and is attached to an action button\n * that fires a search request. Can contain other elements like the search type\n * popover. Is uncontrolled: Vue code does not try to set a default value when\n * hydrating the server-rendered code, so the value entered before full hydration\n * is not removed.\n */\nimport { ref } from \"vue\"\n\nimport VSearchButton from \"~/components/VHeader/VSearchBar/VSearchButton.vue\"\n\nwithDefaults(\n  defineProps<{\n    route?: \"home\" | \"404\"\n    /**\n     * Search bar should not have a focus box when a popover is open.\n     */\n    hasPopover?: boolean\n  }>(),\n  {\n    route: \"home\",\n    hasPopover: false,\n  }\n)\n\nconst emit = defineEmits<{\n  submit: [string]\n}>()\n\nconst inputRef = ref<HTMLInputElement | null>(null)\n\n// Only emit `submit` if the input value is not blank\nconst handleSearch = () => {\n  const searchTerm = inputRef.value?.value.trim()\n  if (searchTerm) {\n    emit(\"submit\", searchTerm)\n  }\n}\n\nconst focusInput = () => {\n  inputRef.value?.focus()\n}\n\ndefineExpose({ focusInput })\n</script>\n\n<template>\n  <!-- Form action is a fallback for when JavaScript is disabled. -->\n  <form\n    id=\"search-form\"\n    action=\"/search\"\n    role=\"search\"\n    class=\"group flex h-14 flex-row items-center rounded-sm border-tx bg-default sm:h-16 dark:bg-overlay\"\n    @submit.prevent=\"handleSearch\"\n  >\n    <div\n      class=\"input-field search-field group flex h-full flex-grow items-center overflow-hidden rounded-sm rounded-e-none border-1.5 border-e-0 pe-2\"\n      :class=\"[\n        route === 'home' ? 'border-tx' : 'border-black dark:border-tx',\n        { 'has-popover': hasPopover, black: route !== 'home' },\n      ]\"\n    >\n      <input\n        id=\"search-bar\"\n        ref=\"inputRef\"\n        type=\"search\"\n        name=\"q\"\n        :placeholder=\"$t('hero.search.placeholder')\"\n        class=\"paragraph-large md:label-regular focus-visible:outline-style-none ms-4 h-full w-full appearance-none rounded-none bg-tx leading-none text-default placeholder-default\"\n        :aria-label=\"\n          $t('search.searchBarLabel', {\n            openverse: 'Openverse',\n          })\n        \"\n      />\n      <!-- @slot Extra information goes here -->\n      <slot />\n    </div>\n    <VSearchButton :route=\"route\" />\n  </form>\n</template>\n\n<style scoped>\n.input-field:has(#search-bar:focus-visible) {\n  @apply border-focus;\n}\n\n.input-field.has-popover:has(#search-bar:focus-visible) {\n  @apply border-tx;\n}\n#search-form:has(button[type=\"submit\"]:focus) .input-field.black {\n  @apply border-tx;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { computed, ref } from \"vue\"\n\nimport type { SearchType } from \"#shared/constants/media\"\nimport { skipToContentTargetId } from \"#shared/constants/window\"\nimport { HOMEPAGE_CONTENT_SETTINGS_DIALOG } from \"#shared/constants/dialogs\"\nimport { useUiStore } from \"~/stores/ui\"\nimport { useDialogControl } from \"~/composables/use-dialog-control\"\n\nimport VContentSettingsModalContent from \"~/components/VHeader/VHeaderMobile/VContentSettingsModalContent.vue\"\nimport VLink from \"~/components/VLink.vue\"\nimport VPopoverContent from \"~/components/VPopover/VPopoverContent.vue\"\nimport VSearchTypeButton from \"~/components/VContentSwitcher/VSearchTypeButton.vue\"\nimport VSearchTypes from \"~/components/VContentSwitcher/VSearchTypes.vue\"\nimport VStandaloneSearchBar from \"~/components/VHeader/VSearchBar/VStandaloneSearchBar.vue\"\n\nconst props = defineProps<{\n  handleSearch: (query: string) => void\n  searchType: SearchType\n  setSearchType: (searchType: SearchType) => void\n}>()\n\nconst emit = defineEmits<{\n  keydown: []\n  blur: []\n  focus: []\n  open: []\n  close: []\n}>()\n\nconst searchTypeButtonRef = ref<InstanceType<typeof VSearchTypeButton> | null>(\n  null\n)\nconst searchBarRef = ref<InstanceType<typeof VStandaloneSearchBar> | null>(null)\nconst nodeRef = computed(() => searchBarRef.value?.$el ?? null)\n\nconst uiStore = useUiStore()\n\nconst isContentSwitcherVisible = ref(false)\n\nconst isSm = computed(() => uiStore.isBreakpoint(\"sm\"))\nconst isLg = computed(() => uiStore.isBreakpoint(\"lg\"))\n\nconst triggerElement = computed(() => searchTypeButtonRef.value?.$el || null)\n\nconst lockBodyScroll = computed(() => !isLg.value)\n\n/**\n * When a search type is selected, we close the popover or modal,\n * and focus the search input.\n *\n * @param searchType\n */\nconst handleSelect = (searchType: SearchType) => {\n  props.setSearchType(searchType)\n  searchBarRef.value?.focusInput()\n  closeContentSwitcher()\n}\n\nconst {\n  close: closeContentSwitcher,\n  open: openContentSwitcher,\n  onTriggerClick,\n  triggerA11yProps,\n} = useDialogControl({\n  id: HOMEPAGE_CONTENT_SETTINGS_DIALOG,\n  visibleRef: isContentSwitcherVisible,\n  nodeRef,\n  lockBodyScroll,\n  emit: emit as (event: string) => void,\n})\n</script>\n\n<template>\n  <div :id=\"skipToContentTargetId\" tabindex=\"-1\">\n    <h1\n      class=\"mb-2 mt-auto text-[40px] font-light leading-tight lg:text-[63px]\"\n    >\n      {{ $t(\"hero.subtitle\") }}\n    </h1>\n\n    <p class=\"text-base leading-relaxed\">\n      {{ $t(\"hero.description\") }}\n    </p>\n\n    <VStandaloneSearchBar\n      ref=\"searchBarRef\"\n      class=\"mt-4 md:mt-6 xl:max-w-[43.75rem]\"\n      :has-popover=\"!!triggerElement && isContentSwitcherVisible\"\n      @submit=\"handleSearch\"\n    >\n      <VSearchTypeButton\n        id=\"search-type-button\"\n        ref=\"searchTypeButtonRef\"\n        class=\"ms-2 flex-none\"\n        :search-type=\"searchType\"\n        v-bind=\"triggerA11yProps\"\n        :show-label=\"isSm\"\n        aria-controls=\"content-switcher-popover\"\n        @click=\"onTriggerClick\"\n      />\n      <template v-if=\"triggerElement\">\n        <VPopoverContent\n          v-if=\"isLg\"\n          :id=\"HOMEPAGE_CONTENT_SETTINGS_DIALOG\"\n          z-index=\"popover\"\n          :hide=\"closeContentSwitcher\"\n          :trap-focus=\"false\"\n          :visible=\"isContentSwitcherVisible\"\n          :trigger-element=\"triggerElement\"\n          aria-labelledby=\"search-type-button\"\n        >\n          <VSearchTypes\n            size=\"small\"\n            :use-links=\"false\"\n            @select=\"handleSelect\"\n          />\n        </VPopoverContent>\n\n        <VContentSettingsModalContent\n          v-else\n          :id=\"HOMEPAGE_CONTENT_SETTINGS_DIALOG\"\n          aria-labelledby=\"search-type-button\"\n          :close=\"closeContentSwitcher\"\n          :visible=\"isContentSwitcherVisible\"\n          :use-links=\"false\"\n          :show-filters=\"false\"\n          variant=\"fit-content\"\n          @open=\"openContentSwitcher\"\n          @select=\"handleSelect\"\n        />\n      </template>\n    </VStandaloneSearchBar>\n\n    <!-- Disclaimer for large screens -->\n    <i18n-t\n      scope=\"global\"\n      keypath=\"hero.disclaimer.content\"\n      tag=\"p\"\n      class=\"mt-4 text-sr\"\n    >\n      <template #license>\n        <VLink\n          href=\"https://creativecommons.org/licenses/\"\n          class=\"text-default underline hover:text-default\"\n          >{{ $t(\"hero.disclaimer.license\") }}</VLink\n        >\n      </template>\n    </i18n-t>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { definePageMeta, navigateTo, useHead } from \"#imports\"\nimport { computed, onMounted, ref } from \"vue\"\n\nimport {\n  ALL_MEDIA,\n  isAdditionalSearchType,\n  isSupportedMediaType,\n  SearchType,\n} from \"#shared/constants/media\"\nimport { useMediaStore } from \"~/stores/media\"\nimport { useSearchStore } from \"~/stores/search\"\nimport { useUiStore } from \"~/stores/ui\"\nimport { useFeatureFlagStore } from \"~/stores/feature-flag\"\nimport { useAnalytics } from \"~/composables/use-analytics\"\n\nimport VHomeGallery from \"~/components/VHomeGallery/VHomeGallery.vue\"\nimport VHomepageContent from \"~/components/VHomepageContent.vue\"\n\ndefineOptions({\n  name: \"HomePage\",\n})\n\ndefinePageMeta({\n  layout: \"default\",\n})\n\nconst featureFlagStore = useFeatureFlagStore()\nconst mediaStore = useMediaStore()\nconst searchStore = useSearchStore()\nconst uiStore = useUiStore()\n\nconst { sendCustomEvent } = useAnalytics()\n\nuseHead({\n  meta: [{ hid: \"theme-color\", name: \"theme-color\", content: \"#ffe033\" }],\n})\n\n/**\n * Reset the search type, search term and filters when the user navigates [back] to the homepage.\n */\nonMounted(() => {\n  searchStore.$reset()\n  mediaStore.$reset()\n})\n\nconst isXl = computed(() => uiStore.isBreakpoint(\"xl\"))\n\nconst searchType = ref<SearchType>(ALL_MEDIA)\n\nconst setSearchType = (type: SearchType) => {\n  if (type === ALL_MEDIA || isSupportedMediaType(type)) {\n    searchType.value = type\n  } else if (\n    featureFlagStore.isOn(\"additional_search_types\") &&\n    isAdditionalSearchType(type)\n  ) {\n    searchType.value = type\n  }\n}\n\nconst handleSearch = (searchTerm: string) => {\n  sendCustomEvent(\"SUBMIT_SEARCH\", {\n    searchType: searchType.value,\n    query: searchTerm,\n  })\n\n  return navigateTo(\n    searchStore.updateSearchPath({\n      type: searchType.value,\n      searchTerm,\n    })\n  )\n}\n</script>\n\n<template>\n  <main\n    class=\"index flex w-full flex-shrink-0 flex-grow flex-col justify-center gap-6 px-6 sm:px-0 xl:flex-row xl:items-center xl:justify-between xl:gap-0\"\n  >\n    <div\n      class=\"grid flex-grow place-items-center justify-center gap-6 xl:h-[33rem] xl:flex-grow-0 xl:items-start\"\n    >\n      <VHomepageContent\n        class=\"page-content my-auto sm:px-14 md:px-20 lg:px-26 xl:w-[53.375rem] xl:pe-0\"\n        :handle-search=\"handleSearch\"\n        :search-type=\"searchType\"\n        :set-search-type=\"setSearchType\"\n      />\n    </div>\n\n    <!-- Image carousel -->\n    <VHomeGallery v-if=\"isXl\" class=\"mx-10 me-12 flex h-full flex-grow\" />\n  </main>\n</template>\n\n<style>\n.page-content,\n.notice {\n  grid-area: 1/1;\n}\n@screen lg {\n  .homepage-images {\n    transform: translateY(-7.143vh);\n  }\n\n  .homepage-image:nth-child(even) {\n    transform: translateY(50%);\n  }\n}\n\n.homepage-image {\n  transition-delay: var(--transition-index) !important;\n}\n\n.fade-enter,\n.fade-leave-to {\n  opacity: 0;\n}\n\n.fade-enter-active,\n.fade-leave-active {\n  transition: 0.5s;\n}\n</style>\n"],"names":["emit","__emit","inputRef","ref","handleSearch","searchTerm","_a","__expose","props","__props","searchTypeButtonRef","searchBarRef","nodeRef","computed","uiStore","useUiStore","isContentSwitcherVisible","isSm","isLg","triggerElement","lockBodyScroll","handleSelect","searchType","closeContentSwitcher","openContentSwitcher","onTriggerClick","triggerA11yProps","useDialogControl","HOMEPAGE_CONTENT_SETTINGS_DIALOG","featureFlagStore","useFeatureFlagStore","mediaStore","useMediaStore","searchStore","useSearchStore","sendCustomEvent","useAnalytics","useHead","onMounted","isXl","ALL_MEDIA","setSearchType","type","isSupportedMediaType","isAdditionalSearchType","navigateTo"],"mappings":"s8EA0BA,MAAMA,EAAOC,EAIPC,EAAWC,EAA6B,IAAI,EAG5CC,EAAe,IAAM,OACzB,MAAMC,GAAaC,EAAAJ,EAAS,QAAT,YAAAI,EAAgB,MAAM,OACrCD,GACFL,EAAK,SAAUK,CAAU,CAE7B,EAMa,OAAAE,EAAA,CAAE,WAJI,IAAM,QACvBD,EAAAJ,EAAS,QAAT,MAAAI,EAAgB,OAClB,EAE2B,i6DC5B3B,MAAME,EAAQC,EAMRT,EAAOC,EAQPS,EAAsBP,EAC1B,IACF,EACMQ,EAAeR,EAAsD,IAAI,EACzES,EAAUC,EAAS,IAAA,OAAM,QAAAP,EAAAK,EAAa,QAAb,YAAAL,EAAoB,MAAO,KAAI,EAExDQ,EAAUC,EAAW,EAErBC,EAA2Bb,EAAI,EAAK,EAEpCc,EAAOJ,EAAS,IAAMC,EAAQ,aAAa,IAAI,CAAC,EAChDI,EAAOL,EAAS,IAAMC,EAAQ,aAAa,IAAI,CAAC,EAEhDK,EAAiBN,EAAS,IAAA,OAAM,QAAAP,EAAAI,EAAoB,QAApB,YAAAJ,EAA2B,MAAO,KAAI,EAEtEc,EAAiBP,EAAS,IAAM,CAACK,EAAK,KAAK,EAQ3CG,EAAgBC,GAA2B,OAC/Cd,EAAM,cAAcc,CAAU,GAC9BhB,EAAAK,EAAa,QAAb,MAAAL,EAAoB,aACCiB,EAAA,CACvB,EAEM,CACJ,MAAOA,EACP,KAAMC,EACN,eAAAC,EACA,iBAAAC,GACEC,GAAiB,CACnB,GAAIC,EACJ,WAAYZ,EACZ,QAAAJ,EACA,eAAAQ,EACA,KAAApB,CAAA,CACD,qpEC3CD,MAAM6B,EAAmBC,EAAoB,EACvCC,EAAaC,EAAc,EAC3BC,EAAcC,EAAe,EAC7BpB,EAAUC,EAAW,EAErB,CAAE,gBAAAoB,CAAgB,EAAIC,EAAa,EAEjCC,GAAA,CACN,KAAM,CAAC,CAAE,IAAK,cAAe,KAAM,cAAe,QAAS,SAAW,CAAA,CAAA,CACvE,EAKDC,EAAU,IAAM,CACdL,EAAY,OAAO,EACnBF,EAAW,OAAO,CAAA,CACnB,EAED,MAAMQ,EAAO1B,EAAS,IAAMC,EAAQ,aAAa,IAAI,CAAC,EAEhDQ,EAAanB,EAAgBqC,CAAS,EAEtCC,EAAiBC,GAAqB,EACtCA,IAASF,GAAaG,EAAqBD,CAAI,GAGjDb,EAAiB,KAAK,yBAAyB,GAC/Ce,EAAuBF,CAAI,KAE3BpB,EAAW,MAAQoB,EAEvB,EAEMtC,EAAgBC,IACpB8B,EAAgB,gBAAiB,CAC/B,WAAYb,EAAW,MACvB,MAAOjB,CAAA,CACR,EAEMwC,GACLZ,EAAY,iBAAiB,CAC3B,KAAMX,EAAW,MACjB,WAAAjB,CACD,CAAA,CACH"}