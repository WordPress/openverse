import{d as H,r as p,o as Z,j as i,k as f,Q as E,u as b,c as v,a0 as ee,w as te,K as _,F,S as ae,e as c,N as w}from"./53SD24Bo.js";import{c as re}from"./MJVc8exl.js";import{I as T}from"./CD1OwZH3.js";import{s as oe}from"./DzXFAWuk.js";import{f as ie,v as se}from"./D8YLUWro.js";import{h as ne}from"./DeQHrU1s.js";import{u as le,d as S}from"./Bt8kfw_-.js";import{u as me}from"./Cw5DoNPI.js";import{u as ue}from"./BFw7Q72o.js";import{u as de,_ as ce,a as pe,b as fe}from"./BDZy9eOE.js";import{u as ge}from"./BquTSqEY.js";import{u as he}from"./CNGp5JOx.js";import{a as V}from"./th-5LjfD.js";import{_ as ve}from"./Bm7DGESM.js";import"./ey6Ec0eW.js";import{u as _e}from"./B9Cuo1Ro.js";import{u as N}from"./C81jPTEF.js";import{_ as we}from"./yE_o5zxM.js";import{a as be,b as ye}from"./B6_o2emp.js";import{_ as Ie}from"./Cxl2PPTT.js";import{e as ke}from"./CgpgALVD.js";import{u as xe}from"./BlclDm7O.js";import{u as Se}from"./mmo1Ekea.js";import{u as Ee}from"./Bdn_xeD6.js";import{_ as $e}from"./DhTbjJlp.js";import"./B_xeuOb0.js";import"./BPAP40Rv.js";import"./BhptSssS.js";import"./D6STwiFZ.js";import"./7RO02bE1.js";import"./uTbLe7kf.js";import"./C0_S5Dz7.js";import"./ETC5RdxK.js";import"./Bcilh3GR.js";import"./QQWdHC9P.js";import"./DhVXE6x0.js";import"./okj3qyDJ.js";import"./DlQTGb70.js";import"./B7QaUHa9.js";import"./BPQLkSin.js";import"./MIUWhl2z.js";import"./C4eH9tZc.js";import"./B06vE1PI.js";import"./BhFmBc_s.js";import"./BQrorSEU.js";import"./CzMus7W4.js";import"./CCSsdpEp.js";import"./BxMTa-Rq.js";import"./BeGEdgZS.js";import"./DaEyxQLt.js";import"./DhmiD3Ot.js";import"./CtCLusXQ.js";import"./V_R3UgdV.js";import"./hoiiP6gd.js";import"./DtcCBiui.js";import"./DXy0qqp8.js";import"./CuEczufm.js";import"./AzdQnjy0.js";import"./DXDVXRO9.js";import"./BMq_QD9n.js";import"./CbICIgXw.js";import"./D6iFto7b.js";import"./DpgQd5ed.js";import"./BEouSYFk.js";import"./EAnWs5xO.js";import"./DlS2iuOS.js";import"./BExq3E3C.js";import"./BvmvFHjK.js";import"./CEfxz6y7.js";import"./CoWEw4AU.js";import"./DyLaWeiI.js";import"./CSMi9OhC.js";import"./BWZtNLCL.js";import"./IGaTK-x7.js";import"./KMULbkEe.js";import"./CNvJpAKB.js";import"./DhH_zm2N.js";import"../sb-preview/runtime.js";import"./BEtur8L0.js";import"./C3kPveT_.js";import"./OKxrPVC4.js";import"./Bw05OD2d.js";import"./BGXkQbrZ.js";import"./Bi1eZFvn.js";import"./CMkDfgbZ.js";import"./CORWBjPI.js";import"./DzfofqJ1.js";import"./B0QARrDW.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},r=new s.Error().stack;r&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[r]="a8252f70-f99b-4281-a622-b4b3ffff1a71",s._sentryDebugIdIdentifier="sentry-dbid-a8252f70-f99b-4281-a622-b4b3ffff1a71")}catch{}})();const Ce=(s="")=>new Promise((r,l)=>{typeof document>"u"&&l();const a=document.createElement("script");a.src=s,a.defer=!0,a.addEventListener("load",r),a.addEventListener("error",l),document.head.appendChild(a)}),Re={class:"block aspect-[2/1]"},Le=["title","aria-label"],Me="https://static.sketchfab.com/api/sketchfab-viewer-1.10.1.js",A=H({__name:"VSketchFabViewer",props:{uid:{}},emits:["failure"],setup(s,{emit:r}){const l=s,a=r,{t:g}=_e({useScope:"global"}),n=g("sketchfabIframeTitle",{sketchfab:"Sketchfab"}),o=p(),{$captureException:e,$captureMessage:u}=N(),I=async()=>{if(await Ce(Me),typeof window.Sketchfab>"u"){u("Unable to find window.Sketchfab after loading");return}if(!o.value)return;new window.Sketchfab(o.value).init(l.uid,{error:h=>{e(h),a("failure")}})};return Z(()=>{I()}),(d,h)=>(i(),f("div",Re,[E("iframe",{id:"sketchfab-iframe",ref_key:"node",ref:o,src:"",sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",title:b(n),"aria-label":b(n),allow:"autoplay; fullscreen; vr",autoplay:!0,class:"h-full w-full"},null,8,Le)]))}});A.__docgenInfo={exportName:"default",displayName:"VSketchFabViewer",description:"",tags:{},props:[{name:"uid",required:!0,type:{name:"string"}}],events:[{name:"failure"}],sourceFiles:["/home/runner/work/openverse/openverse/frontend/src/components/VSketchFabViewer.vue"]};const Pe=["id"],De={class:"relative mb-4 grid grid-cols-1 grid-rows-1 justify-items-center border-b border-default px-6"},Fe=["src","alt","width","height"],Te={key:2,class:"col-span-full row-span-full w-full lg:max-w-4xl lg:px-4"},Ve={class:"grid grid-cols-1 grid-rows-[auto,1fr] sm:grid-cols-[1fr,auto] sm:grid-rows-1 sm:gap-x-6"},B=H({name:"ImageDetailPage",__name:"index",async setup(s){var M,P,D;let r,l;ge();const a=le(),g=N(),n=Ee(),o=v(()=>ie(n==null?void 0:n.params.id));(!o.value||!se(o.value))&&S({statusCode:404,message:`Invalid image id: "${o.value}" on ${n==null?void 0:n.fullPath}.`,fatal:!0});const e=p((M=a.image)!=null&&M.id&&o.value&&a.image.id===o.value?a.image:null),u=v(()=>a.fetchState.error),I=v(()=>!g.isHydrating),d=p(I.value?(P=e.value)==null?void 0:P.thumbnail:(D=e.value)==null?void 0:D.url),h=p(!g.isHydrating),$=v(()=>y.value?!1:h.value),{sendCustomEvent:U}=me(),{resultParams:j}=he(),G=()=>{U("RIGHT_CLICK_IMAGE",j.value)},{reveal:K,isHidden:q}=ue(e.value),{pageTitle:z,detailPageMeta:O}=de(e);Se(()=>({...O,title:z.value}));const C=p(!0),R=p(!1),y=v(()=>{var t;return((t=e.value)==null?void 0:t.source)!=="sketchfab"||R.value?null:e.value.url.split("https://media.sketchfab.com/models/")[1].split("/")[0]}),Q=t=>{var m;t.target instanceof HTMLImageElement&&(d.value=t.target.src===((m=e.value)==null?void 0:m.url)?e.value.thumbnail:ke)},W=t=>{var m;if(!(!(t.target instanceof HTMLImageElement)||!e.value)&&(h.value=!1,C.value)){const x={width:t.target.naturalWidth,height:t.target.naturalHeight};((m=a.mediaItem)==null?void 0:m.frontendMediaType)===T&&(a.mediaItem.width=x.width,a.mediaItem.height=x.height),e.value.filetype||re.head(e.value.url).then(X=>{const Y=X.headers["content-type"];a.mediaItem&&(a.mediaItem.filetype=Y)}).catch(()=>{}),d.value=e.value.url,C.value=!1}},J=async()=>{if(g.isHydrating)return e.value;const t=await a.fetch(T,o.value);if(t)return e.value=t,d.value=t.thumbnail,t;throw new Error(`Could not fetch image with id ${o.value}`)},{error:k}=([r,l]=ee(async()=>xe("single-image-result",async()=>await J(),{lazy:!0,server:!1})),r=await r,l(),r),L=t=>{["Image not found","Image ID not found"].includes(t.message)&&S({statusCode:404,message:"Image ID not found",fatal:!0}),u.value&&!ne(u.value)&&S({...u.value??{},fatal:!0})};return k.value&&L(k.value),te(k,t=>{t&&L(t)}),(t,m)=>(i(),f("main",{id:b(oe),tabindex:"-1",class:"relative flex-grow"},[u.value?(i(),_(Ie,{key:0,"fetching-error":u.value,class:"px-6 py-10 lg:px-10"},null,8,["fetching-error"])):e.value?(i(),f(F,{key:1},[b(q)?(i(),_(we,ae({key:0},e.value,{onReveal:b(K)}),null,16,["onReveal"])):(i(),f(F,{key:1},[c(ce,{media:e.value},null,8,["media"]),E("figure",De,[$.value?(i(),_(V,{key:0,class:"col-span-full row-span-full h-[500px] w-[500px] self-center"})):w("",!0),y.value?w("",!0):(i(),f("img",{key:1,id:"main-image",src:d.value,alt:e.value.title,class:"col-span-full row-span-full h-full max-h-[500px] w-full rounded-se-sm rounded-ss-sm object-contain",width:e.value.width??0,height:e.value.height??0,onLoad:W,onError:Q,onContextmenu:G},null,40,Fe)),y.value?(i(),f("div",Te,[c(A,{uid:y.value,class:"rounded-se-sm rounded-ss-sm",onFailure:m[0]||(m[0]=x=>R.value=!0)},null,8,["uid"])])):w("",!0)]),E("section",Ve,[c(be,{media:e.value,class:"min-w-0 sm:col-start-1"},null,8,["media"]),c(ye,{media:e.value,"media-type":"image",class:"row-start-1 mb-4 !w-full flex-initial sm:col-start-2 sm:mb-0 sm:mt-1 sm:!w-auto"},null,8,["media"])]),c(ve,{media:e.value},null,8,["media"]),c(pe,{media:e.value},null,8,["media"]),e.value?(i(),_(fe,{key:0,"media-type":"image","related-to":e.value.id},null,8,["related-to"])):w("",!0)],64))],64)):$.value?(i(),_(V,{key:2,class:"col-span-full row-span-full mx-auto h-[500px] w-[500px]"})):w("",!0)],8,Pe))}}),va=$e(B,[["__scopeId","data-v-21389429"]]);B.__docgenInfo={name:"ImageDetailPage",exportName:"default",displayName:"[id]",description:"",tags:{},sourceFiles:["/home/runner/work/openverse/openverse/frontend/src/pages/image/[id]/index.vue"]};export{va as default};
