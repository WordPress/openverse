{"version":3,"file":"uB6TsBQk.js","sources":["../../src/pages/audio/collection.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { definePageMeta, useAsyncData, useHead } from \"#imports\"\n\nimport { skipToContentTargetId } from \"#shared/constants/window\"\nimport { AUDIO } from \"#shared/constants/media\"\nimport type { CollectionParams } from \"#shared/types/search\"\nimport { collectionMiddleware } from \"~/middleware/collection\"\nimport { useCollection } from \"~/composables/use-collection\"\nimport { usePageRobotsRule } from \"~/composables/use-page-robots-rule\"\n\nimport VCollectionResults from \"~/components/VSearchResultsGrid/VCollectionResults.vue\"\n\ndefineOptions({\n  name: \"AudioCollection\",\n})\n\ndefinePageMeta({\n  layout: \"content-layout\",\n  middleware: collectionMiddleware,\n})\n\nconst {\n  collectionParams,\n  isFetching,\n  media,\n  creatorUrl,\n  collectionLabel,\n  fetchMedia,\n  loadMore,\n  pageTitle,\n  canLoadMore,\n} = useCollection({ mediaType: AUDIO })\n\n// Collection params are not nullable in the collections route, this is enforced by the middleware\n// Question: should this non-nullability be filtered in the type and enforced in runtime by `useCollection`?\nusePageRobotsRule(\n  `${(collectionParams.value as NonNullable<CollectionParams>).collection}-collection`\n)\n\nuseHead({\n  meta: [{ hid: \"og:title\", property: \"og:title\", content: pageTitle.value }],\n  title: pageTitle.value,\n})\n\n/**\n * Media is not empty when we navigate back to this page, so we don't need to fetch\n * it again to make sure that all the previously fetched media is displayed.\n */\nawait useAsyncData(\n  \"audio-collection\",\n  async () => (media.value.length ? media.value : await fetchMedia()),\n  { lazy: true, server: false }\n)\n</script>\n\n<template>\n  <div\n    :id=\"skipToContentTargetId\"\n    tabindex=\"-1\"\n    class=\"p-6 pt-0 lg:p-10 lg:pt-2\"\n  >\n    <VCollectionResults\n      v-if=\"collectionParams\"\n      search-term=\"\"\n      :is-fetching=\"isFetching\"\n      :results=\"{ type: 'audio', items: media }\"\n      :collection-label=\"collectionLabel\"\n      :collection-params=\"collectionParams\"\n      :creator-url=\"creatorUrl\"\n      :can-load-more=\"canLoadMore\"\n      @load-more=\"loadMore\"\n    />\n  </div>\n</template>\n"],"names":["collectionParams","isFetching","media","creatorUrl","collectionLabel","fetchMedia","loadMore","pageTitle","canLoadMore","useCollection","AUDIO","usePageRobotsRule","useHead","__temp","__restore","_withAsyncContext","useAsyncData"],"mappings":"8gEAqBM,KAAA,CACJ,iBAAAA,EACA,WAAAC,EACA,MAAAC,EACA,WAAAC,EACA,gBAAAC,EACA,WAAAC,EACA,SAAAC,EACA,UAAAC,EACA,YAAAC,CACE,EAAAC,EAAc,CAAE,UAAWC,EAAO,EAItC,OAAAC,EACE,GAAIX,EAAiB,MAAwC,UAAU,aACzE,EAEQY,EAAA,CACN,KAAM,CAAC,CAAE,IAAK,WAAY,SAAU,WAAY,QAASL,EAAU,MAAO,EAC1E,MAAOA,EAAU,KAAA,CAClB,EAMK,CAAAM,EAAAC,CAAA,EAAAC,EAAA,SAAAC,EACJ,mBACA,SAAad,EAAM,MAAM,OAASA,EAAM,MAAQ,MAAMG,EAAW,EACjE,CAAE,KAAM,GAAM,OAAQ,EAAM,CAAA,CAC9B"}