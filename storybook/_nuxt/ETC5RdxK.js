import{d as n}from"./B_xeuOb0.js";import{A as s,I as a,a as c,b as u}from"./CD1OwZH3.js";import{c as d}from"./Bcilh3GR.js";import{u as h}from"./C81jPTEF.js";import"./ey6Ec0eW.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="321e3563-84a2-4880-9110-7be95be63a48",e._sentryDebugIdIdentifier="sentry-dbid-321e3563-84a2-4880-9110-7be95be63a48")}catch{}})();const f=e=>!e.length||!Array.isArray(e)?[]:e.sort((t,r)=>{const o=t.source_name.toUpperCase(),i=r.source_name.toUpperCase();return o.localeCompare(i)}),y=n("provider",{state:()=>({providers:{[s]:[],[a]:[]},fetchState:{status:"idle",error:null},sourceNames:{[s]:[],[a]:[]}}),actions:{_endFetching(e){e?this.fetchState={status:"error",error:e}:this.fetchState={status:"success",error:null}},_startFetching(){this.fetchState={status:"fetching",error:null}},_updateFetchState(e,t){e==="start"?this._startFetching():this._endFetching(t)},_getProvider(e,t){return this.providers[t].find(r=>r.source_name===e)},getProviderName(e,t){var r;return((r=this._getProvider(e,t))==null?void 0:r.display_name)||d(e)},getSourceUrl(e,t){var r;return(r=this._getProvider(e,t))==null?void 0:r.source_url},setMediaTypeProviders(e,t){!Array.isArray(t)||!t.length||(this.providers[e]=f(t),this.sourceNames[e]=t.map(r=>r.source_name))},async fetchProviders(){this._updateFetchState("start");const{$processFetchingError:e}=h();try{const t=await $fetch("/api/sources/");if(!t)throw new Error("No sources data returned from the API");for(const r of c)this.setMediaTypeProviders(r,t[r]);this._updateFetchState("end")}catch(t){const r=e(t,u,"provider");this._updateFetchState("end",r)}},isSourceNameValid(e,t){return this.sourceNames[e].includes(t)}}});export{y as u};
