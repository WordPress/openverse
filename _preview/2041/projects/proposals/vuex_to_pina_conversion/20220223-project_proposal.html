<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Openverse API Terms of Service" href="../../../terms_of_service.html" /><link rel="prev" title="Pinia Conversion" href="index.html" />

    <link rel="shortcut icon" href="https://raw.githubusercontent.com/WordPress/openverse/master/brand/icon.svg"/><!-- Generated with Sphinx 6.2.1 and Furo 2023.03.27 -->
        <title>2022-02-23 Project Proposal: Vuex to Pinia conversion - Openverse documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Openverse  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/logo_light.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/logo_dark.svg" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../api/index.html">Django API</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/guides/index.html">Guides</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/guides/quickstart.html">Quickstart guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/guides/test.html">Testing guide</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/reference/index.html">Reference</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/reference/search_algorithm.html">Search Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/reference/authentication_and_throttling.html">Authentication and Throttling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../catalog/index.html">Airflow catalog</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../changelogs/index.html">Changelogs</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../changelogs/api/index.html">API changelogs</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelogs/api/2023.05.02.21.26.28.html">2023.05.02.21.26.28</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelogs/api/2023.04.27.07.29.23.html">2023.04.27.07.29.23</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelogs/api/2023.04.23.23.22.14.html">2023.04.23.23.22.14</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelogs/api/2023.04.19.00.01.39.html">2023.04.19.00.01.39</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelogs/api/2023.04.18.15.27.15.html">2023.04.18.15.27.15</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelogs/api/2023.04.12.23.29.59.html">2023.04.12.23.29.59</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../changelogs/catalog/index.html">Catalog changelogs</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelogs/catalog/2023.04.27.02.43.13.html">2023.04.27.02.43.13</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../changelogs/frontend/index.html">Frontend changelogs</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelogs/frontend/2023.05.02.19.17.32.html">2023.05.02.19.17.32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelogs/frontend/2023.04.23.23.07.51.html">2023.04.23.23.07.51</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../changelogs/ingestion_server/index.html">Ingestion server changelogs</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelogs/ingestion_server/2023.05.03.22.29.52.html">2023.05.03.22.29.52</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../frontend/index.html">Nuxt frontend</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../frontend/guides/index.html">Guides</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../frontend/guides/quickstart.html">Quickstart guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../frontend/guides/develop.html">Development guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../frontend/guides/test.html">Running frontend tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../frontend/guides/analytics.html">Analytics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../frontend/guides/icons.html">SVG Icon Sprites in Openverse Frontend</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../frontend/reference/index.html">Reference</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../frontend/reference/feature_flags.html">Feature flags</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../frontend/reference/testing_guidelines.html">Testing Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../frontend/reference/playwright_tests.html">Playwright tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../frontend/reference/storybook_tests.html">Storybook tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../frontend/reference/miscellaneous.html">Miscellaneous notes on the frontend</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../general/index.html">General development guidelines</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../general/general_setup.html">General setup guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../general/quickstart.html">Quickstart guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../general/run.html">Run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../general/test.html">Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../general/publish.html">Publish</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../general/zero_downtime_database_management.html">Zero Downtime and Database Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../general/deployment.html">Deployments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../general/logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../general/https.html">Testing HTTPS</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../ingestion_server/index.html">Ingestion server</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../ingestion_server/guides/index.html">Guides</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../ingestion_server/guides/quickstart.html">Quickstart guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ingestion_server/guides/test.html">Testing guide</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../meta/index.html">Managing the Openverse</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../meta/github_contribution_practices.html">GitHub contribution practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../meta/dev_flow.html">Development workflow</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../meta/ci_cd/index.html">CI + CD workflow</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../meta/ci_cd/actions.html">Actions</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../meta/ci_cd/jobs/index.html">Jobs</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../meta/ci_cd/jobs/preparation.html">Preparation jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../meta/ci_cd/jobs/frontend.html">Frontend jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../meta/ci_cd/jobs/docker_preparation.html">Docker jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../meta/ci_cd/jobs/docker_publishing.html">Docker publishing jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../meta/ci_cd/jobs/catalog.html">Catalog jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../meta/ci_cd/jobs/ingestion_server.html">Ingestion server jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../meta/ci_cd/jobs/api.html">API jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../meta/ci_cd/jobs/documentation.html">Documentation jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../meta/ci_cd/jobs/deployment.html">Deployment jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../meta/ci_cd/jobs/notification.html">Notification jobs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../meta/ci_cd/flow.html">Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../meta/ci_cd/proof_of_functionality.html">Proof-of-functionality</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../meta/decision_making/index.html">Openverse Decision-Making Process</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../meta/decision_making/process_description.html">Process description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../meta/decision_making/how_to_use.html">How to follow the process in different settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../meta/decision_making/additional_practices.html">Additional practices</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../meta/documentation/index.html">Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../meta/documentation/quickstart.html">Quickstart guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../meta/documentation/guidelines.html">Documentation Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../meta/documentation/link_issues.html">Sphinx GitHub issue resolver plugin (<code class="docutils literal notranslate"><span class="pre">link_issues</span></code>)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../index.html">Projects</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../planning.html">Project Planning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../templates/implementation-plan.html">Implementation Plan Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../templates/index.html">Project directory <code class="docutils literal notranslate"><span class="pre">index.md</span></code> template</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../templates/project-proposal.html">Project Proposal Template</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../3d_model_support/index.html">3D Model Support</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../3d_model_support/20220221-project_proposal.html">2022-02-21 Project Proposal: 3D model support</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../analytics/index.html">Analytics</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../analytics/20221006-implementation_plan_frontend.html">2022-10-06 Implentation Plan: Frontend event tracking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analytics/20230307-backend_service.html">2023-03-07 Implementation Plan: Analytics backend and visualisation service</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../core_user_interface_improvement/index.html">Core User Interface Improvements</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../core_user_interface_improvement/20230314-project_proposal_core_ui_improvement.html">2023-03-14 Project Proposal: Core UI Improvement</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../document_all_media_properties/index.html">Document all media properties</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../document_all_media_properties/20230307-project_proposal.html">2023-03-07 Project proposal for Document all media properties</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../feature_flags/index.html">Feature Flags</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../feature_flags/20220309-project_proposal.html">2022-03-09 Project Proposal: Feature flags</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../frontend_ui_state_cookie/index.html">Frontend UI State Cookie</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../frontend_ui_state_cookie/20220218-project_proposal.html">2022-02-18 Project Propsal: Frontend UI State Cookie</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../monitoring/index.html">Monitoring</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../monitoring/20220307-project_proposal.html">2022-03-07 Project Proposal: Monitoring</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../monorepo/index.html">Monorepo</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../monorepo/20221124-project_proposal.html">2022-11-24 Project Proposal: Monorepo</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../popularity_optimizations/index.html">Popularity Calculation Optimizations</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../popularity_optimizations/20230406-project_proposal_popularity_optimizations.html">2023-04-06 Project Proposal: Popularity Calculation Optimizations</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../search_relevancy_sandbox/index.html">Search Relevancy Sandbox</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../search_relevancy_sandbox/20230331-project_proposal_search_relevancy_sandbox.html">2023-03-31 Project Proposal: Search relevancy sandbox</a></li>
<li class="toctree-l3"><a class="reference internal" href="../search_relevancy_sandbox/20230406-implementation_plan_update_staging_database.html">2023-04-06 Implementation Plan: Update Staging Database</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../trust_and_safety/content_report_moderation/index.html">Sensitive Content Report Moderation Initial Practices</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../trust_and_safety/content_report_moderation/20230411-project_proposal_content_report_moderation.html">2023-04-11 Project Proposal: Sensitive content report moderation: initial practices</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../trust_and_safety/detecting_sensitive_textual_content/index.html">Detecting and Blurring Sensitive Textual Content</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../trust_and_safety/detecting_sensitive_textual_content/20230309-implementation_plan_sensitive_terms_list.html">2023-03-09 Implementation Plan: Sensitive Terms List</a></li>
<li class="toctree-l3"><a class="reference internal" href="../trust_and_safety/detecting_sensitive_textual_content/20230309-project_proposal_detecting_sensitive_textual_content.html">2023-03-09 Project Proposal: Detecting sensitive textual content and blurring all sensitive results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../trust_and_safety/detecting_sensitive_textual_content/20230330-implementation_plan_filtering_and_designating_results_with_sensitive_textual_content.html">2023-03-30 Implementation Plan: Filtering and designating results with sensitive textual content</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../trust_and_safety/index.html">Trust and Safety</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../trust_and_safety/20230109-trust_and_safety_preliminary_overview_and_exploration.html">2023-01-09 Initial Overview and User Stories</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../trust_and_safety/content_report_moderation/index.html">Sensitive Content Report Moderation Initial Practices</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../trust_and_safety/content_report_moderation/20230411-project_proposal_content_report_moderation.html">2023-04-11 Project Proposal: Sensitive content report moderation: initial practices</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../trust_and_safety/detecting_sensitive_textual_content/index.html">Detecting and Blurring Sensitive Textual Content</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../trust_and_safety/detecting_sensitive_textual_content/20230309-implementation_plan_sensitive_terms_list.html">2023-03-09 Implementation Plan: Sensitive Terms List</a></li>
<li class="toctree-l4"><a class="reference internal" href="../trust_and_safety/detecting_sensitive_textual_content/20230309-project_proposal_detecting_sensitive_textual_content.html">2023-03-09 Project Proposal: Detecting sensitive textual content and blurring all sensitive results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../trust_and_safety/detecting_sensitive_textual_content/20230330-implementation_plan_filtering_and_designating_results_with_sensitive_textual_content.html">2023-03-30 Implementation Plan: Filtering and designating results with sensitive textual content</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../visual_regression_testing/index.html">Visual Regression Testing</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../visual_regression_testing/20220217-implementation_plan.html">2022-02-17 Implementation Plan: Visual regression testing</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Pinia Conversion</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">2022-02-23 Project Proposal: Vuex to Pinia conversion</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../terms_of_service.html">Openverse API Terms of Service</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://openverse.org">Openverse</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/WordPress/openverse">GitHub</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/WordPress/openverse/edit/main/documentation/projects/proposals/vuex_to_pina_conversion/20220223-project_proposal.md" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="project-proposal-vuex-to-pinia-conversion">
<h1>2022-02-23 Project Proposal: Vuex to Pinia conversion<a class="headerlink" href="#project-proposal-vuex-to-pinia-conversion" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>[x] &#64;dhruvkb</p></li>
<li><p>[x] &#64;sarayourfriend</p></li>
</ul>
<p><strong>Milestone:</strong> https://github.com/WordPress/openverse-frontend/milestone/5</p>
<section id="rationale">
<h2>Rationale<a class="headerlink" href="#rationale" title="Permalink to this heading">#</a></h2>
<p>Currently we use Vuex for global state management. This works fine for Vue 2 but
has some considerable disadvantages for Vue 3, especially when it comes to
TypeScript support and composition-api usage. We should switch to Pinia instead.
It is the new
<a class="reference external" href="https://blog.vuejs.org/posts/vue-3-as-the-new-default.html">official default recommendation</a>
of the Vue project for state management instead of Vuex. Evan You, the creator
of Vue,
<a class="reference external" href="https://twitter.com/youyuxi/status/1463429442076745730?lang=en">has confirmed</a>
that Vuex 5 and Pinia are defacto the same.</p>
<p>Pinia also has better interoperability between Vue 2’s composition-api and Vue
3, and would allow us to decouple our state-management API usage from Nuxt.
Currently we rely on Nuxt’s home-grown <code class="docutils literal notranslate"><span class="pre">useStore</span></code> composable from the
<code class="docutils literal notranslate"><span class="pre">&#64;nuxtjs/composition-api</span></code> extension on top of <code class="docutils literal notranslate"><span class="pre">&#64;vue/composition-api</span></code> but there’s
no guarantee that that composable will stick around in Nuxt 3. Besides, it is
not easy to watch for changes in the store from within the <code class="docutils literal notranslate"><span class="pre">setup</span></code> function, at
least when rendering on the server, and it caused problems with rendering the
correct search input text on SSR.</p>
<p>Moving to Pinia will allow us to reduce the current verbosity of the store
introduced by module, action and mutation constants. In the long run, it will
simplify the unit tests setup.</p>
</section>
<section id="alternatives">
<h2>Alternatives<a class="headerlink" href="#alternatives" title="Permalink to this heading">#</a></h2>
<p>We could just stick with the current Vuex approach and during the Nuxt bridge
upgrade replace all usages of <code class="docutils literal notranslate"><span class="pre">useStore</span></code> with <code class="docutils literal notranslate"><span class="pre">useNuxtApp().$store</span></code> instead.
This would introduce more code changes during the Nuxt bridge upgrade BUT would
prevent us from having to re-write our entire state management strategy before
migrating to Nuxt 3.</p>
</section>
<section id="potential-risks">
<h2>Potential risks<a class="headerlink" href="#potential-risks" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Pinia is currently maintained by a Vue core member, but it’s still not the
official Vue Vuex implementation. However, its development is closely linked
with the development of the new version of Vuex and they strive for the same
API and some feature parity, so we should be able to move to Vuex 5 whenever
it is released if we decide to do so.</p></li>
<li><p>Store changes affect the app as a whole, and changes can cause a lot of
disruption. To mitigate this, we can ensure that each store rewrite is
accompanied with a full rewritten unit test, and try to use types as much as
possible.</p></li>
</ul>
</section>
<section id="conversion-to-pinia">
<h2>Conversion to Pinia<a class="headerlink" href="#conversion-to-pinia" title="Permalink to this heading">#</a></h2>
<p>There are some important differences between Vuex (the version we are currently
using)and Pinia in store structure.</p>
<section id="dividing-the-store-vuex-modules-and-pinia-stores">
<h3>Dividing the store: Vuex modules and Pinia stores<a class="headerlink" href="#dividing-the-store-vuex-modules-and-pinia-stores" title="Permalink to this heading">#</a></h3>
<p>Vuex uses a single store which can have multiple modules that can be namespaced.
In our setup we have several namespaced modules inside <code class="docutils literal notranslate"><span class="pre">src/store</span></code> that Nuxt
uses to create a single store. In Pinia, the equivalent of a Vuex namespaced
module is a single store. Namespacing is achieved by giving a store its <code class="docutils literal notranslate"><span class="pre">id</span></code>.
All Pinia stores are separate modules, and are usually kept in a <code class="docutils literal notranslate"><span class="pre">src/stores</span></code>
folder to emphasize that. To use a store <code class="docutils literal notranslate"><span class="pre">X</span></code> from store <code class="docutils literal notranslate"><span class="pre">Y</span></code>, you need to call
<code class="docutils literal notranslate"><span class="pre">useXStore</span></code> inside <code class="docutils literal notranslate"><span class="pre">storeY</span></code>. I couldn’t find a way to create a central store
equivalent to what we have now. So, when using the store in components, we would
have to import all the stores that the component uses, instead of using a single
<code class="docutils literal notranslate"><span class="pre">useStore()</span></code> call. This means that there will be more than single-line changes
in the components.</p>
</section>
<section id="pinia-store-definitions">
<h3>Pinia store definitions<a class="headerlink" href="#pinia-store-definitions" title="Permalink to this heading">#</a></h3>
<p>Pinia currently supports two types of store definitions: <strong>options store</strong> and
<strong>setup store</strong>. As a team, we lean towards using the <em>setup store</em>, not the
<em>options store</em>.</p>
<p><strong>Options store</strong> is similar to the Vuex store: it has <code class="docutils literal notranslate"><span class="pre">state</span></code>, <code class="docutils literal notranslate"><span class="pre">getters</span></code> and
<code class="docutils literal notranslate"><span class="pre">actions</span></code>. It could be easier to convert the current Vuex modules into the Pinia
options stores as the structure is almost the same, with the main difference
being the fact that the mutations are converted into actions, and lack of
<code class="docutils literal notranslate"><span class="pre">context</span></code> parameter for actions, and <code class="docutils literal notranslate"><span class="pre">state</span></code> parameter for mutation.</p>
<p><strong>Setup store</strong> is a newer kind of store that is more compatible with the
composition API. The store definition itself is very similar to <code class="docutils literal notranslate"><span class="pre">setup</span></code> function
we use in the components. For more context on the <code class="docutils literal notranslate"><span class="pre">setup</span> <span class="pre">store</span></code>, watch a talk by
Eduardo San Martin Morote (the creator of Pinia) where he explains the setup
syntax on minute 22:
<a class="reference external" href="https://portal.gitnation.org/contents/everything-beyond-state-management-in-stores-with-pinia">Everything Beyond State Management in Stores with Pinia by Eduardo San Martin Morote - GitNation</a>.
In short, the <strong>advantages</strong> of using the setup store are:</p>
<ol class="arabic simple">
<li><p>It is very similar to the components <code class="docutils literal notranslate"><span class="pre">setup</span></code> function, so it will be easier
cognitively to switch between the store code and the component code.</p></li>
<li><p>We can use other composables within the store.</p></li>
<li><p>It is easier to use other stores from inside a store: you would only need to
call <code class="docutils literal notranslate"><span class="pre">useXStore</span></code> once to use it in different <code class="docutils literal notranslate"><span class="pre">actions</span></code>. For example, when
fetching media for search and fetching a single media item details, we use
<code class="docutils literal notranslate"><span class="pre">UsageData</span></code> store to send the usage statistics. With the options store, we
would have to use <code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">usageDataStore</span> <span class="pre">=</span> <span class="pre">useUsageDataStore()</span></code> for each
action, and with the setup store we can set it up once and use in any action
that needs it.</p></li>
</ol>
<p>These advantages strongly outweigh some potential <strong>downsides</strong> to using the
setup store:</p>
<ol class="arabic simple">
<li><p>Setup stores are not well documented. Most of the documentation examples use
the options store.</p></li>
<li><p>Setup store does not force us to separate the store code into state, getters
and actions, so we would have to make effort to somehow make sure that the
stores are well-organized, and not just a pile of spaghetti code.</p></li>
</ol>
<p>View a sample simple store in the
<a class="reference external" href="https://github.com/vuejs/pinia/blob/f9ba40a7e86e39f5336b587d248f234ccdbad5ca/packages/pinia/test-dts/storeSetup.test-d.ts">Pinia repository</a>.</p>
</section>
</section>
<section id="prior-work">
<h2>Prior work<a class="headerlink" href="#prior-work" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://github.com/WordPress/openverse-frontend/issues/756">Original issue</a>
with a discussion of Pinia conversion and initial plan.
<a class="reference external" href="https://github.com/WordPress/openverse-frontend/pull/906">&#64;dhruvkb’s PoC PR with Pinia setup and conversion of active-media store to a Pinia options store, which was later rewritten as a setup store</a></p>
</section>
<section id="implementation-plan">
<h2>Implementation plan<a class="headerlink" href="#implementation-plan" title="Permalink to this heading">#</a></h2>
<p>We have considered two options, converting stores one by one, or converting all
stores in a feature branch, and decided that the first option is preferable.</p>
<ol class="arabic simple">
<li><p>Convert the store from Vuex to Pinia gradually, one store at a time. &#64;dhruvkb
has created an excellent PoC PR for a gradual conversion to Pinia while
keeping other stores in Vuex.</p></li>
</ol>
<p>To minimise disruption, each store can be changed using a lock-based approach
where the developer takes a lock on the store using a notification to the group,
makes a PR updating a single store and its usages and this lock is released
after the PR is merged.</p>
<p>This prevents PRs from diverging too much and allows a seamless transition for
all involved.</p>
<ol class="arabic simple" start="2">
<li><p>Create a feature base branch, do all the conversion in it, and only merge a
fully-converted store into main. This will ensure that we are merging a
fully-working converted store, and if we find any blocking concern, we can
easily revert the changes by closing the feature branch.</p></li>
</ol>
<p>While Pinia docs suggest that it is possible to migrate large projects from Vuex
to Pinia module by module, they also say that using <code class="docutils literal notranslate"><span class="pre">disableVuex:</span> <span class="pre">false</span></code> is not
recommended. ~Also, I’m not sure how to use Pinia stores from Vuex modules, and
we do have several interdependent modules that call one another.~ In this case,
we can use Pinia stores inside the Vuex stores by calling <code class="docutils literal notranslate"><span class="pre">useXStore()</span></code> inside
getters, mutations and actions.</p>
</section>
<section id="converting-a-vuex-namespaced-store-module-to-a-pinia-store">
<h2>Converting a Vuex namespaced store module to a Pinia store<a class="headerlink" href="#converting-a-vuex-namespaced-store-module-to-a-pinia-store" title="Permalink to this heading">#</a></h2>
<p>There is an excellent guide on conversion in Pinia docs. This section will give
steps that need to be followed for each store, and add some details specific to
Openverse setup.</p>
<p>For each store, there are several things that need to be done:</p>
<ul class="simple">
<li><p>convert the store creation to use <code class="docutils literal notranslate"><span class="pre">defineStore</span></code>.</p></li>
<li><p>convert state to <code class="docutils literal notranslate"><span class="pre">reactive</span></code></p></li>
<li><p>convert <code class="docutils literal notranslate"><span class="pre">getters</span></code> without params to <code class="docutils literal notranslate"><span class="pre">computed</span></code> and <code class="docutils literal notranslate"><span class="pre">getters</span></code> with parameters
to functions.</p></li>
<li><p>convert <code class="docutils literal notranslate"><span class="pre">actions</span></code> and <code class="docutils literal notranslate"><span class="pre">mutations</span></code> to functions. They will no longer use the
<code class="docutils literal notranslate"><span class="pre">context</span></code> or <code class="docutils literal notranslate"><span class="pre">state</span></code> parameter, and will, instead of using an all-capital
constant for a name, be renamed to use camelCase (e.g. <code class="docutils literal notranslate"><span class="pre">[FETCH_MEDIA]</span></code> will
become <code class="docutils literal notranslate"><span class="pre">fetchMedia</span></code>).</p></li>
<li><p>return the necessary state properties, getters and actions.</p></li>
<li><p>adjust the types where necessary.</p></li>
<li><p>remove the unused constants from - <code class="docutils literal notranslate"><span class="pre">~/constants/mutation-types.js</span></code>,
<code class="docutils literal notranslate"><span class="pre">~/constants/action-types.js</span></code>, <code class="docutils literal notranslate"><span class="pre">~/constants/store-modules.js</span></code>.</p></li>
<li><p>refactor the use of the store in components.</p></li>
<li><p>add or refactor the store unit test.</p></li>
<li><p>refactor the unit tests for components that use this store.</p></li>
<li><p>add e2e tests for the changes in components.</p></li>
</ul>
<section id="state">
<h3>State<a class="headerlink" href="#state" title="Permalink to this heading">#</a></h3>
<p>When using the setup store, we should try to use a <code class="docutils literal notranslate"><span class="pre">reactive</span></code> to create the
initial state object, and not a set of <code class="docutils literal notranslate"><span class="pre">ref</span></code>s. Otherwise, we can create errors
by accidentally having a state property name and an action parameter that is
updating it with the same name. This doesn’t work:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ref</span><span class="p">(</span><span class="s2">&quot;string message&quot;</span><span class="p">)</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">setMessage</span><span class="p">({</span><span class="w"> </span><span class="nx">message</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">message</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">message</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here, the destructured parameter name <code class="docutils literal notranslate"><span class="pre">message</span></code> shadows the state property name
<code class="docutils literal notranslate"><span class="pre">message</span></code>, and the <code class="docutils literal notranslate"><span class="pre">setMessage</span></code> doesn’t update the state as could be expected.</p>
<p>We can use <code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">{</span> <span class="pre">param1,</span> <span class="pre">param2</span> <span class="pre">}</span> <span class="pre">=</span> <span class="pre">toRefs(state)</span></code> to enable store
destructuring, and make each property reactive. If we do not return all of the
state properties, such as when some properties only used from inside the store
itself (e.g. <code class="docutils literal notranslate"><span class="pre">status</span></code> for <code class="docutils literal notranslate"><span class="pre">activeMediaStore</span></code>), we can also add a <code class="docutils literal notranslate"><span class="pre">readonly</span></code>
state <code class="docutils literal notranslate"><span class="pre">state:</span> <span class="pre">readonly(state)</span></code> property to the return to make it testable.</p>
</section>
<section id="actions">
<h3>Actions<a class="headerlink" href="#actions" title="Permalink to this heading">#</a></h3>
<p>Pinia allows changing the state directly in the components (which was frowned
upon by Vuex) so we could do away with mutations in theory. But it is better to
keep using separate functions (actions) to update the state to keep state
changes limited to one file and make it easier to debug.</p>
<p>When using the <code class="docutils literal notranslate"><span class="pre">setup</span> <span class="pre">store</span></code>, we don’t need the strict divide between mutations
that can change the state, and actions that cannot. This way, we can clean up
the code from one-line mutations and test them simply by testing the resulting
state. However, testing the network-based state changes is not possible this
way, so it is better to leave even one line mutations that are based on the
network responses. For example, <code class="docutils literal notranslate"><span class="pre">fetchMedia</span></code> in the <code class="docutils literal notranslate"><span class="pre">mediaStore</span></code> sets
<code class="docutils literal notranslate"><span class="pre">isFetching</span></code> to true before sending the request, and to <code class="docutils literal notranslate"><span class="pre">false</span></code> after getting a
200 OK response. So, the state test would not detect the changes, and we can use
the <code class="docutils literal notranslate"><span class="pre">hasBeenCalled</span></code> mock tests in such cases instead.</p>
</section>
<section id="type-hinting">
<h3>Type hinting<a class="headerlink" href="#type-hinting" title="Permalink to this heading">#</a></h3>
<p>In the interest of a quick migration, we can continue to use the existing type
definitions for the state and the various mutations/actions from the
<code class="docutils literal notranslate"><span class="pre">types.d.ts</span></code> file. Some definitions in the file are out of date (as was the case
for <code class="docutils literal notranslate"><span class="pre">ActiveMediaState</span></code>), so it is useful to check them.</p>
</section>
<section id="testing">
<h3>Testing<a class="headerlink" href="#testing" title="Permalink to this heading">#</a></h3>
<p>One of the acceptance criteria for the store conversion PRs should be 100% unit
test coverage for the store module, and added e2e tests for the component
changes. It is also important to ensure that e2e tests cover both SSR and
client-side rendering. One of the acceptance criteria for the store conversion
PRs should be 100% unit test coverage for the store module, and added e2e tests
for the component changes. It is also important to ensure that e2e tests cover
both SSR and client-side rendering. Pinia Docs has a cookbook page about testing
Pinia stores, and testing components that use Pinia stores. Please note that the
setup for component testing with Vue 2 is
<a class="reference external" href="https://pinia.vuejs.org/cookbook/testing.html#unit-test-components-vue-2">slightly different from the Vue 3 setup</a>.</p>
</section>
</section>
<section id="steps">
<h2>Steps<a class="headerlink" href="#steps" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple" start="0">
<li><p>Install Pinia and test compatibility. Create a sample Pinia store in the
<code class="docutils literal notranslate"><span class="pre">stores</span></code> directory.</p></li>
<li><p>Replace Vuex stores with their Pinia counterparts. The order should be from
smallest modules with fewer connections to the largest modules with more
connections to other modules:</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">active-media</span></code> and <code class="docutils literal notranslate"><span class="pre">nav</span></code> stores - already refactored in
<a class="reference external" href="https://github.com/WordPress/openverse-frontend/pull/906">#906</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">search</span></code> store - another PoC split into 3 PRs
(<a class="reference external" href="https://github.com/WordPress/openverse-frontend/pull/1038">#1038</a>,
<a class="reference external" href="https://github.com/WordPress/openverse-frontend/pull/1039">#1039</a>,
<a class="reference external" href="https://github.com/WordPress/openverse-frontend/pull/1040">#1040</a>) to ensure
that Pinia stores can be used from Vuex stores, and figure out testing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> store</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">usage-data</span></code> store</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">provider</span></code> store</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">media</span></code> store</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>In the end, with no Vuex stores remaining, Vuex and all associated
dependencies will be removed. The <code class="docutils literal notranslate"><span class="pre">store/index.js</span></code> file can also be removed
after the complete migration to Pinia. The <code class="docutils literal notranslate"><span class="pre">disableVuex:</span> <span class="pre">false</span></code> flag should
also be removed.</p></li>
</ol>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../../../terms_of_service.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Openverse API Terms of Service</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Pinia Conversion</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/WordPress/openverse" aria-label="GitHub"><svg fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">2022-02-23 Project Proposal: Vuex to Pinia conversion</a><ul>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#alternatives">Alternatives</a></li>
<li><a class="reference internal" href="#potential-risks">Potential risks</a></li>
<li><a class="reference internal" href="#conversion-to-pinia">Conversion to Pinia</a><ul>
<li><a class="reference internal" href="#dividing-the-store-vuex-modules-and-pinia-stores">Dividing the store: Vuex modules and Pinia stores</a></li>
<li><a class="reference internal" href="#pinia-store-definitions">Pinia store definitions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#prior-work">Prior work</a></li>
<li><a class="reference internal" href="#implementation-plan">Implementation plan</a></li>
<li><a class="reference internal" href="#converting-a-vuex-namespaced-store-module-to-a-pinia-store">Converting a Vuex namespaced store module to a Pinia store</a><ul>
<li><a class="reference internal" href="#state">State</a></li>
<li><a class="reference internal" href="#actions">Actions</a></li>
<li><a class="reference internal" href="#type-hinting">Type hinting</a></li>
<li><a class="reference internal" href="#testing">Testing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#steps">Steps</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="https://unpkg.com/mermaid@9.4.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    </body>
</html>