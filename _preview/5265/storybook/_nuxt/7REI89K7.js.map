{"version":3,"file":"7REI89K7.js","sources":["../../src/components/VSearchResultsGrid/VAudioResult.vue","../../src/components/VSearchResultsGrid/VAudioInstructions.vue","../../src/components/VSearchResultsGrid/VAllResultsGrid.vue","../../src/components/VSearchResultsGrid/VAudioCollection.vue","../../src/components/VSearchResultsGrid/VMediaCollection.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { useNuxtApp } from \"#imports\"\nimport { computed, ref } from \"vue\"\n\nimport { AUDIO } from \"#shared/constants/media\"\nimport type { AudioLayout, AudioSize } from \"#shared/constants/audio\"\nimport { singleResultQuery } from \"#shared/utils/query-utils\"\nimport type { AudioInteractionData } from \"#shared/types/analytics\"\nimport type { AudioTrackClickEvent } from \"#shared/types/events\"\nimport type { AudioDetail } from \"#shared/types/media\"\nimport type { SingleResultProps } from \"#shared/types/collection-component-props\"\nimport { useSearchStore } from \"~/stores/search\"\nimport { useSensitiveMedia } from \"~/composables/use-sensitive-media\"\nimport { useAudioSnackbar } from \"~/composables/use-audio-snackbar\"\n\nimport VAudioTrack from \"~/components/VAudioTrack/VAudioTrack.vue\"\n\ndefineOptions({ inheritAttrs: false })\n\nconst props = withDefaults(\n  defineProps<\n    SingleResultProps & {\n      layout: Extract<AudioLayout, \"box\" | \"row\">\n      size?: AudioSize\n      audio: AudioDetail\n      position?: number\n    }\n  >(),\n  { relatedTo: \"null\", position: -1 }\n)\n\nconst { $sendCustomEvent } = useNuxtApp()\nconst searchStore = useSearchStore()\n\nconst { isHidden: shouldBlur } = useSensitiveMedia(ref(props.audio))\n\nconst href = computed(() => {\n  return `/audio/${props.audio.id}/${singleResultQuery(props.searchTerm, props.position)}`\n})\n\nconst sendSelectSearchResultEvent = (\n  audio: AudioDetail,\n  { inWaveform }: AudioTrackClickEvent\n) => {\n  // Only send the event when the click navigates to the single result page.\n  // If the click is in waveform or audio-control button, it controls the audio player.\n  if (inWaveform) {\n    return\n  }\n  useAudioSnackbar().hide()\n  $sendCustomEvent(\"SELECT_SEARCH_RESULT\", {\n    ...searchStore.searchParamsForEvent,\n    id: audio.id,\n    kind: props.kind,\n    mediaType: AUDIO,\n    position: props.position,\n    provider: audio.provider,\n    relatedTo: props.relatedTo ?? \"null\",\n    sensitivities: audio.sensitivity?.join(\",\") ?? \"\",\n    isBlurred: shouldBlur.value ?? \"null\",\n  })\n}\nconst sendInteractionEvent = (\n  data: Omit<AudioInteractionData, \"component\">\n) => {\n  const component =\n    props.kind === \"related\"\n      ? \"VRelatedAudio\"\n      : props.layout === \"box\"\n        ? \"VAllResultsGrid\"\n        : \"AudioSearch\"\n  $sendCustomEvent(\"AUDIO_INTERACTION\", { ...data, component })\n}\n</script>\n\n<template>\n  <li>\n    <VAudioTrack\n      :audio=\"audio\"\n      :layout=\"layout\"\n      :size=\"size\"\n      :search-term=\"searchTerm\"\n      :href=\"href\"\n      v-bind=\"$attrs\"\n      @interacted=\"sendInteractionEvent\"\n      @mousedown=\"sendSelectSearchResultEvent(audio, $event)\"\n    />\n  </li>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from \"vue\"\n\nimport { useAudioSnackbar } from \"~/composables/use-audio-snackbar\"\n\nimport VSnackbar from \"~/components/VSnackbar.vue\"\n\nconst props = defineProps<{ kind: \"all\" | \"audio\" }>()\n\nconst { isVisible: isSnackbarVisible } = useAudioSnackbar()\n\nconst keyboardKeys = computed(() =>\n  props.kind === \"all\" ? [\"spacebar\"] : [\"spacebar\", \"left\", \"right\"]\n)\n\nconst i18nPrefix = computed(() => {\n  return props.kind === \"all\" ? \"allResults.snackbar\" : \"audioResults.snackbar\"\n})\n</script>\n\n<template>\n  <VSnackbar size=\"large\" :is-visible=\"isSnackbarVisible\">\n    <i18n-t scope=\"global\" :keypath=\"`${i18nPrefix}.text`\" tag=\"p\">\n      <template\n        v-for=\"keyboardKey in keyboardKeys\"\n        #[keyboardKey]\n        :key=\"keyboardKey\"\n      >\n        <kbd class=\"font-sans\">{{ $t(`${i18nPrefix}.${keyboardKey}`) }}</kbd>\n      </template>\n    </i18n-t>\n  </VSnackbar>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from \"vue\"\n\nimport { storeToRefs } from \"pinia\"\n\nimport {\n  type AudioDetail,\n  type ImageDetail,\n  isDetail,\n} from \"#shared/types/media\"\nimport { useUiStore } from \"~/stores/ui\"\n\nimport VImageResult from \"~/components/VImageResult/VImageResult.vue\"\nimport VAudioResult from \"~/components/VSearchResultsGrid/VAudioResult.vue\"\nimport VAudioInstructions from \"~/components/VSearchResultsGrid/VAudioInstructions.vue\"\n\ndefineProps<{\n  searchTerm: string\n  results: (AudioDetail | ImageDetail)[]\n  collectionLabel: string\n}>()\n\nconst uiStore = useUiStore()\nconst { isFilterVisible: isSidebarVisible } = storeToRefs(uiStore)\n\nconst isSm = computed(() => uiStore.isBreakpoint(\"sm\"))\n</script>\n\n<template>\n  <div>\n    <VAudioInstructions kind=\"all\" />\n    <ol\n      class=\"grid grid-cols-2 gap-4\"\n      :class=\"\n        isSidebarVisible\n          ? 'lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5'\n          : 'sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6'\n      \"\n      :aria-label=\"collectionLabel\"\n    >\n      <template v-for=\"(item, idx) in results\">\n        <VImageResult\n          v-if=\"isDetail.image(item)\"\n          :key=\"item.id\"\n          :image=\"item\"\n          :position=\"idx + 1\"\n          :search-term=\"searchTerm\"\n          kind=\"search\"\n          aspect-ratio=\"square\"\n        />\n        <VAudioResult\n          v-if=\"isDetail.audio(item)\"\n          :key=\"item.id\"\n          :audio=\"item\"\n          :position=\"idx + 1\"\n          :search-term=\"searchTerm\"\n          layout=\"box\"\n          :size=\"isSm ? 'l' : 's'\"\n          kind=\"search\"\n        />\n      </template>\n    </ol>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from \"vue\"\n\nimport type { CollectionComponentProps } from \"#shared/types/collection-component-props\"\nimport { useUiStore } from \"~/stores/ui\"\n\nimport VAudioResult from \"~/components/VSearchResultsGrid/VAudioResult.vue\"\nimport VAudioInstructions from \"~/components/VSearchResultsGrid/VAudioInstructions.vue\"\n\n/**\n * This component shows a loading skeleton if the results are not yet loaded,\n * and then shows the list of audio, with the Load more button if needed.\n */\n\nconst props = withDefaults(defineProps<CollectionComponentProps<\"audio\">>(), {\n  kind: \"search\",\n  relatedTo: \"null\",\n})\n\nconst uiStore = useUiStore()\n\n// Determine the size of the audio track based on the kind\n// of collection and the current breakpoint.\nconst audioTrackSize = computed(() => {\n  if (props.kind === \"related\") {\n    return uiStore.isBreakpoint(\"sm\") ? \"m\" : \"s\"\n  } else {\n    return !uiStore.isBreakpoint(\"sm\")\n      ? \"s\"\n      : uiStore.isBreakpoint(\"xl\")\n        ? \"l\"\n        : \"m\"\n  }\n})\n</script>\n\n<template>\n  <div>\n    <VAudioInstructions kind=\"audio\" />\n    <!-- Negative margin compensates for the `p-4` padding in row layout. -->\n    <ol\n      :aria-label=\"collectionLabel\"\n      class=\"-mx-2 flex flex-col md:-mx-4\"\n      :class=\"kind === 'related' ? 'gap-4' : 'gap-2 md:gap-1'\"\n    >\n      <VAudioResult\n        v-for=\"(audio, idx) in results\"\n        :key=\"audio.id\"\n        :search-term=\"searchTerm\"\n        :related-to=\"relatedTo\"\n        :audio=\"audio\"\n        layout=\"row\"\n        :size=\"audioTrackSize\"\n        :kind=\"kind\"\n        :position=\"idx + 1\"\n      />\n    </ol>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from \"vue\"\n\nimport { ALL_MEDIA, AUDIO, IMAGE } from \"#shared/constants/media\"\nimport type { MediaCollectionComponentProps } from \"#shared/types/collection-component-props\"\n\nimport VGridSkeleton from \"~/components/VSkeleton/VGridSkeleton.vue\"\nimport VAllResultsGrid from \"~/components/VSearchResultsGrid/VAllResultsGrid.vue\"\nimport VAudioCollection from \"~/components/VSearchResultsGrid/VAudioCollection.vue\"\nimport VImageCollection from \"~/components/VSearchResultsGrid/VImageCollection.vue\"\n\nconst props = withDefaults(defineProps<MediaCollectionComponentProps>(), {\n  relatedTo: \"null\",\n})\n\ndefineEmits<{ \"load-more\": [] }>()\n\nconst showSkeleton = computed(() => {\n  return props.isFetching && props.results.items.length === 0\n})\n\nconst components = {\n  [IMAGE]: VImageCollection,\n  [AUDIO]: VAudioCollection,\n  [ALL_MEDIA]: VAllResultsGrid,\n}\n\nconst component = computed(() => components[props.results.type])\n</script>\n\n<template>\n  <section>\n    <slot name=\"header\" />\n\n    <VGridSkeleton v-if=\"showSkeleton\" :is-for-tab=\"results.type\" />\n\n    <Component\n      :is=\"component\"\n      v-if=\"!showSkeleton\"\n      :results=\"results.items\"\n      :kind=\"kind\"\n      :search-term=\"searchTerm\"\n      :related-to=\"relatedTo\"\n      :collection-label=\"collectionLabel\"\n      :class=\"{ 'pt-2 sm:pt-0': results.type === 'image' }\"\n    />\n\n    <slot name=\"footer\" />\n  </section>\n</template>\n"],"names":["props","__props","$sendCustomEvent","useNuxtApp","searchStore","useSearchStore","shouldBlur","useSensitiveMedia","ref","href","computed","singleResultQuery","sendSelectSearchResultEvent","audio","inWaveform","useAudioSnackbar","AUDIO","_a","sendInteractionEvent","data","component","isSnackbarVisible","keyboardKeys","i18nPrefix","uiStore","useUiStore","isSidebarVisible","storeToRefs","isSm","audioTrackSize","showSkeleton","components","IMAGE","VImageCollection","VAudioCollection","ALL_MEDIA","VAllResultsGrid"],"mappings":"glCAmBA,MAAMA,EAAQC,EAYR,CAAE,iBAAAC,CAAiB,EAAIC,EAAW,EAClCC,EAAcC,EAAe,EAE7B,CAAE,SAAUC,CAAW,EAAIC,EAAkBC,EAAIR,EAAM,KAAK,CAAC,EAE7DS,EAAOC,EAAS,IACb,UAAUV,EAAM,MAAM,EAAE,IAAIW,EAAkBX,EAAM,WAAYA,EAAM,QAAQ,CAAC,EACvF,EAEKY,EAA8B,CAClCC,EACA,CAAE,WAAAC,KACC,OAGCA,IAGJC,EAAA,EAAmB,KAAK,EACxBb,EAAiB,uBAAwB,CACvC,GAAGE,EAAY,qBACf,GAAIS,EAAM,GACV,KAAMb,EAAM,KACZ,UAAWgB,EACX,SAAUhB,EAAM,SAChB,SAAUa,EAAM,SAChB,UAAWb,EAAM,WAAa,OAC9B,gBAAeiB,EAAAJ,EAAM,cAAN,YAAAI,EAAmB,KAAK,OAAQ,GAC/C,UAAWX,EAAW,OAAS,MAAA,CAChC,EACH,EACMY,EACJC,GACG,CACG,MAAAC,EACJpB,EAAM,OAAS,UACX,gBACAA,EAAM,SAAW,MACf,kBACA,cACRE,EAAiB,oBAAqB,CAAE,GAAGiB,EAAM,UAAAC,EAAW,CAC9D,kpBCjEA,MAAMpB,EAAQC,EAER,CAAE,UAAWoB,CAAkB,EAAIN,EAAiB,EAEpDO,EAAeZ,EAAS,IAC5BV,EAAM,OAAS,MAAQ,CAAC,UAAU,EAAI,CAAC,WAAY,OAAQ,OAAO,CACpE,EAEMuB,EAAab,EAAS,IACnBV,EAAM,OAAS,MAAQ,sBAAwB,uBACvD,2sBCKD,MAAMwB,EAAUC,EAAW,EACrB,CAAE,gBAAiBC,GAAqBC,EAAYH,CAAO,EAE3DI,EAAOlB,EAAS,IAAMc,EAAQ,aAAa,IAAI,CAAC,8vCCXtD,MAAMxB,EAAQC,EAKRuB,EAAUC,EAAW,EAIrBI,EAAiBnB,EAAS,IAC1BV,EAAM,OAAS,UACVwB,EAAQ,aAAa,IAAI,EAAI,IAAM,IAElCA,EAAQ,aAAa,IAAI,EAE7BA,EAAQ,aAAa,IAAI,EACvB,IACA,IAHF,GAKP,qwDCtBD,MAAMxB,EAAQC,EAMR6B,EAAepB,EAAS,IACrBV,EAAM,YAAcA,EAAM,QAAQ,MAAM,SAAW,CAC3D,EAEK+B,EAAa,CACjB,CAACC,CAAK,EAAGC,GACT,CAACjB,CAAK,EAAGkB,EACT,CAACC,CAAS,EAAGC,CACf,EAEMhB,EAAYV,EAAS,IAAMqB,EAAW/B,EAAM,QAAQ,IAAI,CAAC"}