import{d as H,r as p,o as Z,j as i,k as f,L as E,u as b,c as v,X as ee,w as te,D as _,F,N as ae,e as c,I as w}from"./DwwldUEF.js";import{d as re,h as oe}from"./Ds_kB4O7.js";import{I as T}from"./CAa63J2U.js";import{s as ie}from"./CUvT7aun.js";import{f as se,v as ne}from"./Bkc2CSET.js";import{u as le,d as S}from"./BouOeHyj.js";import{u as me}from"./DqyB4W5h.js";import{u as ue}from"./BbQZ5Ga4.js";import{u as de,_ as ce,a as pe,b as fe}from"./CjFwR01r.js";import{u as ge}from"./B94RXM36.js";import{u as he}from"./C33K8QHx.js";import{a as V}from"./BQ0Y0oGM.js";import{_ as ve}from"./c4L3nbZz.js";import"./CWoQmekT.js";import{u as _e}from"./D93TPuWH.js";import{u as N}from"./VcnMPoS3.js";import{_ as we}from"./DmgBhuh4.js";import{a as be,b as ye}from"./CiA8SkQA.js";import{_ as Ie}from"./YyHKzTTw.js";import{e as ke}from"./BRSqBQqg.js";import{u as xe}from"./DXCHDiK8.js";import{u as Se}from"./DyH7cufP.js";import{u as Ee}from"./BtS8wA1z.js";import{_ as $e}from"./DhTbjJlp.js";import"./Z8zkSHZ1.js";import"./BAdCBbtP.js";import"./Dl1S6mqo.js";import"./TLA9Fm80.js";import"./Ck0CgHQL.js";import"./aHnQ5-ra.js";import"./ghAvikQd.js";import"./D8qJDlnG.js";import"./Cyc9srVp.js";import"./I6oWuQE1.js";import"./C8BbUAkk.js";import"./DzAq6MI-.js";import"./BtUmmYon.js";import"./tAHCZdDM.js";import"./BVSSI1w3.js";import"./EYNRPfqu.js";import"./DEUi6v0t.js";import"./DNI0JtzU.js";import"./BCWuNC2L.js";import"./CU-snwr6.js";import"./jkP_3ymO.js";import"./DoSYsHAz.js";import"./aezMCrU2.js";import"./7REI89K7.js";import"./BXlqTUHv.js";import"./DqAbNI4A.js";import"./DZP0BHtF.js";import"./PhiECvvt.js";import"./CUCjtGpu.js";import"./Dhs1Or-2.js";import"./B80ow4_s.js";import"./DGATJxKI.js";import"./CBSn_8fJ.js";import"./9C_OvWUG.js";import"./DpnpvZCo.js";import"./B46r_P4O.js";import"./CUuqYMuc.js";import"./DKDb4atL.js";import"./Co6bLswe.js";import"./CzJ3cZ9I.js";import"./CvEfzrWQ.js";import"./dq26NpIB.js";import"./cfTPNM7V.js";import"./DIFM1i0-.js";import"./DaYT2vHs.js";import"./DOn4i9uW.js";import"./CEvcS2ii.js";import"./p3yRY0a3.js";import"./fcz6QAD5.js";import"./BrBSbq_x.js";import"./DJyfWqgd.js";import"./B6fTz0T-.js";import"../sb-preview/runtime.js";import"./uxIvVnM7.js";import"./--wmzdkw.js";import"./6EtbFbqO.js";import"./B8gBvgeW.js";import"./DvhnXGlP.js";import"./B9kEwDX-.js";import"./BGi7wlVR.js";import"./CtAt4zxF.js";import"./D6RkRnWy.js";import"./DJXVTcEq.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},r=new s.Error().stack;r&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[r]="63fcbddf-496b-42e2-a325-5a0d587b49f1",s._sentryDebugIdIdentifier="sentry-dbid-63fcbddf-496b-42e2-a325-5a0d587b49f1")}catch{}})();const Ce=(s="")=>new Promise((r,l)=>{typeof document>"u"&&l();const a=document.createElement("script");a.src=s,a.defer=!0,a.addEventListener("load",r),a.addEventListener("error",l),document.head.appendChild(a)}),Le={class:"block aspect-[2/1]"},Re=["title","aria-label"],De="https://static.sketchfab.com/api/sketchfab-viewer-1.10.1.js",A=H({__name:"VSketchFabViewer",props:{uid:{}},emits:["failure"],setup(s,{emit:r}){const l=s,a=r,{t:g}=_e({useScope:"global"}),n=g("sketchfabIframeTitle",{sketchfab:"Sketchfab"}),o=p(),{$captureException:e,$captureMessage:u}=N(),I=async()=>{if(await Ce(De),typeof window.Sketchfab>"u"){u("Unable to find window.Sketchfab after loading");return}if(!o.value)return;new window.Sketchfab(o.value).init(l.uid,{error:h=>{e(h),a("failure")}})};return Z(()=>{I()}),(d,h)=>(i(),f("div",Le,[E("iframe",{id:"sketchfab-iframe",ref_key:"node",ref:o,src:"",sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",title:b(n),"aria-label":b(n),allow:"autoplay; fullscreen; vr",autoplay:!0,class:"h-full w-full"},null,8,Re)]))}});A.__docgenInfo={exportName:"default",displayName:"VSketchFabViewer",description:"",tags:{},props:[{name:"uid",required:!0,type:{name:"string"}}],events:[{name:"failure"}],sourceFiles:["/home/runner/work/openverse/openverse/frontend/src/components/VSketchFabViewer.vue"]};const Me=["id"],Pe={class:"relative mb-4 grid grid-cols-1 grid-rows-1 justify-items-center border-b border-default px-6"},Fe=["src","alt","width","height"],Te={key:2,class:"col-span-full row-span-full w-full lg:max-w-4xl lg:px-4"},Ve={class:"grid grid-cols-1 grid-rows-[auto,1fr] sm:grid-cols-[1fr,auto] sm:grid-rows-1 sm:gap-x-6"},B=H({name:"ImageDetailPage",__name:"index",async setup(s){var D,M,P;let r,l;ge();const a=le(),g=N(),n=Ee(),o=v(()=>se(n==null?void 0:n.params.id));(!o.value||!ne(o.value))&&S({statusCode:404,message:`Invalid image id: "${o.value}" on ${n==null?void 0:n.fullPath}.`,fatal:!0});const e=p((D=a.image)!=null&&D.id&&o.value&&a.image.id===o.value?a.image:null),u=v(()=>a.fetchState.fetchingError),I=v(()=>!g.isHydrating),d=p(I.value?(M=e.value)==null?void 0:M.thumbnail:(P=e.value)==null?void 0:P.url),h=p(!g.isHydrating),$=v(()=>y.value?!1:h.value),{sendCustomEvent:U}=me(),{resultParams:j}=he(),G=()=>{U("RIGHT_CLICK_IMAGE",j.value)},{reveal:q,isHidden:z}=ue(e.value),{pageTitle:K,detailPageMeta:O}=de(e);Se(()=>({...O,title:K.value}));const C=p(!0),L=p(!1),y=v(()=>{var t;return((t=e.value)==null?void 0:t.source)!=="sketchfab"||L.value?null:e.value.url.split("https://media.sketchfab.com/models/")[1].split("/")[0]}),W=t=>{var m;t.target instanceof HTMLImageElement&&(d.value=t.target.src===((m=e.value)==null?void 0:m.url)?e.value.thumbnail:ke)},X=t=>{var m;if(!(!(t.target instanceof HTMLImageElement)||!e.value)&&(h.value=!1,C.value)){const x={width:t.target.naturalWidth,height:t.target.naturalHeight};((m=a.mediaItem)==null?void 0:m.frontendMediaType)===T&&(a.mediaItem.width=x.width,a.mediaItem.height=x.height),e.value.filetype||re.head(e.value.url).then(Q=>{const Y=Q.headers["content-type"];a.mediaItem&&(a.mediaItem.filetype=Y)}).catch(()=>{}),d.value=e.value.url,C.value=!1}},J=async()=>{if(g.isHydrating)return e.value;const t=await a.fetch(T,o.value);if(t)return e.value=t,d.value=t.thumbnail,t;throw new Error(`Could not fetch image with id ${o.value}`)},{error:k}=([r,l]=ee(async()=>xe("single-image-result",async()=>await J(),{lazy:!0,server:!1})),r=await r,l(),r),R=t=>{["Image not found","Image ID not found"].includes(t.message)&&S({statusCode:404,message:"Image ID not found",fatal:!0}),u.value&&!oe(u.value)&&S({...u.value??{},fatal:!0})};return k.value&&R(k.value),te(k,t=>{t&&R(t)}),(t,m)=>(i(),f("main",{id:b(ie),tabindex:"-1",class:"relative flex-grow"},[u.value?(i(),_(Ie,{key:0,"fetching-error":u.value,class:"px-6 py-10 lg:px-10"},null,8,["fetching-error"])):e.value?(i(),f(F,{key:1},[b(z)?(i(),_(we,ae({key:0},e.value,{onReveal:b(q)}),null,16,["onReveal"])):(i(),f(F,{key:1},[c(ce,{media:e.value},null,8,["media"]),E("figure",Pe,[$.value?(i(),_(V,{key:0,class:"col-span-full row-span-full h-[500px] w-[500px] self-center"})):w("",!0),y.value?w("",!0):(i(),f("img",{key:1,id:"main-image",src:d.value,alt:e.value.title,class:"col-span-full row-span-full h-full max-h-[500px] w-full rounded-se-sm rounded-ss-sm object-contain",width:e.value.width??0,height:e.value.height??0,onLoad:X,onError:W,onContextmenu:G},null,40,Fe)),y.value?(i(),f("div",Te,[c(A,{uid:y.value,class:"rounded-se-sm rounded-ss-sm",onFailure:m[0]||(m[0]=x=>L.value=!0)},null,8,["uid"])])):w("",!0)]),E("section",Ve,[c(be,{media:e.value,class:"min-w-0 sm:col-start-1"},null,8,["media"]),c(ye,{media:e.value,"media-type":"image",class:"row-start-1 mb-4 !w-full flex-initial sm:col-start-2 sm:mb-0 sm:mt-1 sm:!w-auto"},null,8,["media"])]),c(ve,{media:e.value},null,8,["media"]),c(pe,{media:e.value},null,8,["media"]),e.value?(i(),_(fe,{key:0,"media-type":"image","related-to":e.value.id},null,8,["related-to"])):w("",!0)],64))],64)):$.value?(i(),_(V,{key:2,class:"col-span-full row-span-full mx-auto h-[500px] w-[500px]"})):w("",!0)],8,Me))}}),ha=$e(B,[["__scopeId","data-v-596779c6"]]);B.__docgenInfo={name:"ImageDetailPage",exportName:"default",displayName:"[id]",description:"",tags:{},sourceFiles:["/home/runner/work/openverse/openverse/frontend/src/pages/image/[id]/index.vue"]};export{ha as default};
