{"version":3,"file":"Bq7tJILY.js","sources":["../../src/components/VHeader/VHeaderDesktop.vue"],"sourcesContent":["<script setup lang=\"ts\">\n/**\n * The desktop search header.\n */\nimport { useNuxtApp } from \"#imports\"\nimport { computed, inject, ref } from \"vue\"\nimport type { Ref } from \"vue\"\n\nimport { IsSidebarVisibleKey } from \"#shared/types/provides\"\nimport { ensureFocus } from \"~/utils/reakit-utils/focus\"\nimport { useMediaStore } from \"~/stores/media\"\nimport { useSearchStore } from \"~/stores/search\"\nimport { useUiStore } from \"~/stores/ui\"\nimport { useSearch } from \"~/composables/use-search\"\nimport { useHydrating } from \"~/composables/use-hydrating\"\n\nimport VFilterButton from \"~/components/VHeader/VFilterButton.vue\"\nimport VSearchBar from \"~/components/VHeader/VSearchBar/VSearchBar.vue\"\nimport VLogoButton from \"~/components/VHeader/VLogoButton.vue\"\nimport VSearchBarButton from \"~/components/VHeader/VHeaderMobile/VSearchBarButton.vue\"\nimport VSearchTypePopover from \"~/components/VContentSwitcher/VSearchTypePopover.vue\"\n\nconst filterButtonRef = ref<InstanceType<typeof VFilterButton> | null>(null)\nconst searchBarRef = ref<InstanceType<typeof VSearchBar> | null>(null)\n\nconst mediaStore = useMediaStore()\nconst searchStore = useSearchStore()\nconst uiStore = useUiStore()\n\nconst isSidebarVisible = inject<Ref<boolean>>(IsSidebarVisibleKey)\n\nconst isFetching = computed(() => mediaStore.fetchState.isFetching)\n\nconst { $sendCustomEvent } = useNuxtApp()\n\nconst { updateSearchState, searchTerm, searchStatus } =\n  useSearch($sendCustomEvent)\n\nconst clearSearchTerm = () => {\n  searchTerm.value = \"\"\n  ensureFocus(searchBarRef.value?.$el.querySelector(\"input\") as HTMLElement)\n}\n\nconst handleSearch = async () => {\n  window.scrollTo({ top: 0, left: 0, behavior: \"auto\" })\n  const activeElement = document.activeElement as HTMLElement\n  activeElement?.blur()\n  updateSearchState()\n}\n\nconst areFiltersDisabled = computed(() => !searchStore.searchTypeIsSupported)\n\nconst toggleSidebar = () => {\n  const toState = isSidebarVisible?.value ? \"closed\" : \"opened\"\n  $sendCustomEvent(\"TOGGLE_FILTER_SIDEBAR\", {\n    searchType: searchStore.searchType,\n    toState,\n  })\n  uiStore.toggleFilters()\n}\n\nconst isXl = computed(() => uiStore.isBreakpoint(\"xl\"))\n\nconst { doneHydrating } = useHydrating()\n</script>\n\n<template>\n  <header\n    class=\"main-header z-30 flex w-full items-stretch justify-between gap-x-2 bg-default px-6 py-4\"\n  >\n    <VLogoButton :is-fetching=\"isFetching\" />\n\n    <VSearchBar\n      ref=\"searchBarRef\"\n      v-model.trim=\"searchTerm\"\n      class=\"me-4 flex-grow\"\n      @submit=\"handleSearch\"\n      @recent-hidden=\"handleSearch\"\n    >\n      <VSearchBarButton\n        v-show=\"searchTerm !== ''\"\n        icon=\"close-small\"\n        :label=\"$t('browsePage.searchForm.clear')\"\n        variant=\"filled-white\"\n        class=\"hidden group-focus-within:flex\"\n        @click=\"clearSearchTerm\"\n      />\n      <span\n        v-show=\"Boolean(searchStatus)\"\n        class=\"info mx-4 hidden whitespace-nowrap text-xs text-secondary group-focus-within:hidden group-hover:text-default group-focus:text-default lg:block\"\n      >\n        {{ searchStatus }}\n      </span>\n    </VSearchBar>\n\n    <VSearchTypePopover :show-label=\"isXl\" />\n\n    <VFilterButton\n      ref=\"filterButtonRef\"\n      class=\"flex self-stretch\"\n      :pressed=\"isSidebarVisible\"\n      :disabled=\"!doneHydrating || areFiltersDisabled\"\n      aria-haspopup=\"dialog\"\n      :aria-expanded=\"isSidebarVisible\"\n      @toggle=\"toggleSidebar\"\n    />\n  </header>\n</template>\n"],"names":["filterButtonRef","ref","searchBarRef","mediaStore","useMediaStore","searchStore","useSearchStore","uiStore","useUiStore","isSidebarVisible","inject","IsSidebarVisibleKey","isFetching","computed","$sendCustomEvent","useNuxtApp","updateSearchState","searchTerm","searchStatus","useSearch","clearSearchTerm","ensureFocus","_a","handleSearch","activeElement","areFiltersDisabled","toggleSidebar","toState","isXl","doneHydrating","useHydrating"],"mappings":"q+BAsBM,MAAAA,EAAkBC,EAA+C,IAAI,EACrEC,EAAeD,EAA4C,IAAI,EAE/DE,EAAaC,EAAc,EAC3BC,EAAcC,EAAe,EAC7BC,EAAUC,EAAW,EAErBC,EAAmBC,EAAqBC,CAAmB,EAE3DC,EAAaC,EAAS,IAAMV,EAAW,WAAW,UAAU,EAE5D,CAAE,iBAAAW,CAAiB,EAAIC,EAAW,EAElC,CAAE,kBAAAC,EAAmB,WAAAC,EAAY,aAAAC,CAAa,EAClDC,EAAUL,CAAgB,EAEtBM,EAAkB,IAAM,OAC5BH,EAAW,MAAQ,GACnBI,GAAYC,EAAApB,EAAa,QAAb,YAAAoB,EAAoB,IAAI,cAAc,QAAuB,CAC3E,EAEMC,EAAe,SAAY,CACxB,OAAA,SAAS,CAAE,IAAK,EAAG,KAAM,EAAG,SAAU,OAAQ,EACrD,MAAMC,EAAgB,SAAS,cAC/BA,GAAA,MAAAA,EAAe,OACGR,EAAA,CACpB,EAEMS,EAAqBZ,EAAS,IAAM,CAACR,EAAY,qBAAqB,EAEtEqB,EAAgB,IAAM,CACpB,MAAAC,EAAUlB,GAAA,MAAAA,EAAkB,MAAQ,SAAW,SACrDK,EAAiB,wBAAyB,CACxC,WAAYT,EAAY,WACxB,QAAAsB,CAAA,CACD,EACDpB,EAAQ,cAAc,CACxB,EAEMqB,EAAOf,EAAS,IAAMN,EAAQ,aAAa,IAAI,CAAC,EAEhD,CAAE,cAAAsB,CAAc,EAAIC,EAAa"}