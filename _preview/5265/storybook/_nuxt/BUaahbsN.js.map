{"version":3,"file":"BUaahbsN.js","sources":["../../src/composables/use-i18n-utilities.ts"],"sourcesContent":["import { useNuxtApp } from \"#imports\"\n\nimport { ALL_MEDIA, AUDIO, IMAGE } from \"#shared/constants/media\"\nimport type {\n  SupportedMediaType,\n  SupportedSearchType,\n} from \"#shared/constants/media\"\nimport type { Collection } from \"#shared/types/search\"\nimport { useGetLocaleFormattedNumber } from \"~/composables/use-get-locale-formatted-number\"\n\ntype KeyCollection = {\n  zero: string\n  count: string\n  countMore: string\n}\ntype KeyMapping = Record<SupportedMediaType, KeyCollection> & {\n  all?: KeyCollection\n}\n/**\n * Not using dynamically-generated keys to ensure that\n * correct line is shown in the 'po' locale files\n */\nconst searchResultKeys = {\n  [ALL_MEDIA]: {\n    zero: \"browsePage.allNoResults\",\n    count: \"browsePage.allResultCount\",\n    countMore: \"browsePage.allResultCountMore\",\n  },\n  [IMAGE]: {\n    zero: \"browsePage.contentLink.image.zero\",\n    count: \"browsePage.contentLink.image.count\",\n    countMore: \"browsePage.contentLink.image.countMore\",\n  },\n  [AUDIO]: {\n    zero: \"browsePage.contentLink.audio.zero\",\n    count: \"browsePage.contentLink.audio.count\",\n    countMore: \"browsePage.contentLink.audio.countMore\",\n  },\n} satisfies KeyMapping\n\nconst collectionKeys = {\n  source: {\n    [IMAGE]: {\n      zero: \"collection.resultCountLabel.source.image.zero\",\n      count: \"collection.resultCountLabel.source.image.count\",\n      countMore: \"collection.resultCountLabel.source.image.countMore\",\n    },\n    [AUDIO]: {\n      zero: \"collection.resultCountLabel.source.audio.zero\",\n      count: \"collection.resultCountLabel.source.audio.count\",\n      countMore: \"collection.resultCountLabel.source.audio.countMore\",\n    },\n  },\n  creator: {\n    [IMAGE]: {\n      zero: \"collection.resultCountLabel.creator.image.zero\",\n      count: \"collection.resultCountLabel.creator.image.count\",\n      countMore: \"collection.resultCountLabel.creator.image.countMore\",\n    },\n    [AUDIO]: {\n      zero: \"collection.resultCountLabel.creator.audio.zero\",\n      count: \"collection.resultCountLabel.creator.audio.count\",\n      countMore: \"collection.resultCountLabel.creator.audio.countMore\",\n    },\n  },\n  tag: {\n    [IMAGE]: {\n      zero: \"collection.resultCountLabel.tag.image.zero\",\n      count: \"collection.resultCountLabel.tag.image.count\",\n      countMore: \"collection.resultCountLabel.tag.image.countMore\",\n    },\n    [AUDIO]: {\n      zero: \"collection.resultCountLabel.tag.audio.zero\",\n      count: \"collection.resultCountLabel.tag.audio.count\",\n      countMore: \"collection.resultCountLabel.tag.audio.countMore\",\n    },\n  },\n} satisfies Record<Collection, KeyMapping>\n\nexport function getCountKey(resultsCount: number): keyof KeyCollection {\n  return resultsCount === 0\n    ? \"zero\"\n    : resultsCount >= 240\n      ? \"countMore\"\n      : \"count\"\n}\n\n/**\n * Returns the localized text for the number of search results.\n */\nexport function useI18nResultsCount() {\n  const { t } = useNuxtApp().$i18n\n  const getLocaleFormattedNumber = useGetLocaleFormattedNumber()\n\n  const getLoading = () => t(\"header.loading\")\n\n  const getI18nKey = (\n    resultsCount: number,\n    searchType: SupportedSearchType\n  ) => {\n    const countKey = getCountKey(resultsCount)\n    return searchResultKeys[searchType][countKey]\n  }\n\n  /**\n   * Returns the localized text for the content link label.\n   * E.g. \"See 240 image results for 'cats'\".\n   */\n  const getI18nContentLinkLabel = (\n    resultsCount: number,\n    query: string,\n    mediaType: SupportedMediaType\n  ) => {\n    return t(getI18nKey(resultsCount, mediaType), {\n      count: resultsCount,\n      localeCount: getLocaleFormattedNumber(resultsCount),\n      query,\n      mediaType,\n    })\n  }\n  const getI18nCollectionResultCountLabel = (\n    resultCount: number,\n    mediaType: SupportedMediaType,\n    collectionType: Collection,\n    params: Record<string, string> | undefined = undefined\n  ) => {\n    const key =\n      collectionKeys[collectionType][mediaType][getCountKey(resultCount)]\n    return t(key, {\n      count: resultCount,\n      localeCount: getLocaleFormattedNumber(resultCount),\n      ...params,\n    })\n  }\n\n  /**\n   * Returns the localized text for the number of search results, using corresponding\n   * pluralization rules and decimal separators.\n   * E.g. \"No results\", \"132 results\", \"Top 240 results\".\n   */\n  const getI18nCount = (resultsCount: number) => {\n    return t(getI18nKey(resultsCount, ALL_MEDIA), {\n      count: resultsCount,\n      localeCount: getLocaleFormattedNumber(resultsCount),\n    })\n  }\n\n  return {\n    getI18nCount,\n    getI18nContentLinkLabel,\n    getI18nCollectionResultCountLabel,\n    getLoading,\n  }\n}\n"],"names":["searchResultKeys","ALL_MEDIA","IMAGE","AUDIO","collectionKeys","getCountKey","resultsCount","useI18nResultsCount","t","useNuxtApp","getLocaleFormattedNumber","useGetLocaleFormattedNumber","getLoading","getI18nKey","searchType","countKey","query","mediaType","resultCount","collectionType","params","key"],"mappings":"mcAsBA,MAAMA,EAAmB,CACvB,CAACC,CAAS,EAAG,CACX,KAAM,0BACN,MAAO,4BACP,UAAW,+BACb,EACA,CAACC,CAAK,EAAG,CACP,KAAM,oCACN,MAAO,qCACP,UAAW,wCACb,EACA,CAACC,CAAK,EAAG,CACP,KAAM,oCACN,MAAO,qCACP,UAAW,wCAAA,CAEf,EAEMC,EAAiB,CACrB,OAAQ,CACN,CAACF,CAAK,EAAG,CACP,KAAM,gDACN,MAAO,iDACP,UAAW,oDACb,EACA,CAACC,CAAK,EAAG,CACP,KAAM,gDACN,MAAO,iDACP,UAAW,oDAAA,CAEf,EACA,QAAS,CACP,CAACD,CAAK,EAAG,CACP,KAAM,iDACN,MAAO,kDACP,UAAW,qDACb,EACA,CAACC,CAAK,EAAG,CACP,KAAM,iDACN,MAAO,kDACP,UAAW,qDAAA,CAEf,EACA,IAAK,CACH,CAACD,CAAK,EAAG,CACP,KAAM,6CACN,MAAO,8CACP,UAAW,iDACb,EACA,CAACC,CAAK,EAAG,CACP,KAAM,6CACN,MAAO,8CACP,UAAW,iDAAA,CACb,CAEJ,EAEO,SAASE,EAAYC,EAA2C,CACrE,OAAOA,IAAiB,EACpB,OACAA,GAAgB,IACd,YACA,OACR,CAKO,SAASC,GAAsB,CACpC,KAAM,CAAE,EAAAC,CAAA,EAAMC,EAAA,EAAa,MACrBC,EAA2BC,EAA4B,EAEvDC,EAAa,IAAMJ,EAAE,gBAAgB,EAErCK,EAAa,CACjBP,EACAQ,IACG,CACG,MAAAC,EAAWV,EAAYC,CAAY,EAClC,OAAAN,EAAiBc,CAAU,EAAEC,CAAQ,CAC9C,EA6CO,MAAA,CACL,aARoBT,GACbE,EAAEK,EAAWP,EAAcL,CAAS,EAAG,CAC5C,MAAOK,EACP,YAAaI,EAAyBJ,CAAY,CAAA,CACnD,EAKD,wBAzC8B,CAC9BA,EACAU,EACAC,IAEOT,EAAEK,EAAWP,EAAcW,CAAS,EAAG,CAC5C,MAAOX,EACP,YAAaI,EAAyBJ,CAAY,EAClD,MAAAU,EACA,UAAAC,CAAA,CACD,EAgCD,kCA9BwC,CACxCC,EACAD,EACAE,EACAC,EAA6C,SAC1C,CACG,MAAAC,EACJjB,EAAee,CAAc,EAAEF,CAAS,EAAEZ,EAAYa,CAAW,CAAC,EACpE,OAAOV,EAAEa,EAAK,CACZ,MAAOH,EACP,YAAaR,EAAyBQ,CAAW,EACjD,GAAGE,CAAA,CACJ,CACH,EAkBE,WAAAR,CACF,CACF"}