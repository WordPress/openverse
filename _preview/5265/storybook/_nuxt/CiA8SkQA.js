import{r as k,c as f,d as V,D as B,E as x,j as p,U as E,Q as h,k as v,L as r,e as g,I as T,l as w,u as m,a4 as M,a5 as A,J as ee,K as ae,M as _,V as Be,G as Re,b as Ee,w as Pe,N as F,O as je,P as qe,a3 as se}from"./DwwldUEF.js";import{A as Ge}from"./CAa63J2U.js";import{e as oe,b as ne,f as te}from"./uxIvVnM7.js";import{f as Oe}from"./Bkc2CSET.js";import{d as We}from"./Z8zkSHZ1.js";import{w as Ke}from"./TLA9Fm80.js";import{u as re}from"./VcnMPoS3.js";import"./CWoQmekT.js";import{u as Ue}from"./Ds_kB4O7.js";import{t as He,u as Je,V as Qe}from"./--wmzdkw.js";import{u as I}from"./jkP_3ymO.js";import{u as Xe,a as Ye}from"./B8gBvgeW.js";import{V as Ze}from"./DvhnXGlP.js";import{u as ea}from"./C33K8QHx.js";import{V as aa}from"./Dhs1Or-2.js";import{_ as sa}from"./B9kEwDX-.js";import{u as P}from"./BbQZ5Ga4.js";import{_ as le}from"./CtAt4zxF.js";import{V as R}from"./DJXVTcEq.js";import{_ as j}from"./DhTbjJlp.js";import{u as ue}from"./D93TPuWH.js";import{_ as de}from"./DqyB4W5h.js";import{u as oa}from"./BtS8wA1z.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new t.Error().stack;a&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[a]="ed3a0ab0-bde5-418d-ab92-17542a68828d",t._sentryDebugIdIdentifier="sentry-dbid-ed3a0ab0-bde5-418d-ab92-17542a68828d")}catch{}})();const ta="active-media",ia=We(ta,{state:()=>({type:null,id:null,status:"ejected",message:null}),actions:{setActiveMediaItem({type:t,id:a,status:e="playing"}){this.type=t,this.id=a,this.status=e},pauseActiveMediaItem(){this.status="paused"},ejectActiveMediaItem(){this.status="ejected",this.id=null,this.type=null},setMessage({message:t}){this.message=t},playAudio(t){const a=t==null?void 0:t.play();if(a===void 0){Ke("Play promise is undefined");return}a.catch(e=>{const n=Object.keys(oe).includes(e.name)?oe[e.name]:"err_unknown";if(n==="err_unknown"){const{$captureException:u}=re();u(e)}this.setMessage({message:n}),t==null||t.pause()})}}}),na=k(void 0);function ra(){return Object.freeze({obj:na})}const ie=Symbol("NotSet"),la=t=>{const a=k(ie);return f({get(){return a.value===ie?t():a.value},set(e){a.value=e}})},ua=()=>{const t=k(!1),a=()=>{t.value=!0},e=()=>{t.value?t.value=!1:I().showInstructionsSnackbar()},n=()=>{I().hideInstructionsSnackbar()},u=()=>{I().dismissInstructionsSnackbar()};return{isVisible:f(()=>I().areInstructionsVisible),show:e,hide:n,dismiss:u,handleMouseDown:a,isMouseDown:t}},ce=V({__name:"VGetMediaButton",props:{media:{},mediaType:{}},setup(t){const a=t,{resultParams:e}=ea(),{$sendCustomEvent:n}=re(),u=()=>{n("GET_MEDIA",{...e.value,provider:a.media.provider,mediaType:a.mediaType})};return(d,c)=>(p(),B(aa,{as:"VLink",href:d.media.foreign_landing_url,size:"large",variant:"filled-pink-8","has-icon-end":"","show-external-icon":"","external-icon-size":6,class:"description-bold","send-external-link-click-event":!1,onClick:u},{default:x(()=>[E(h(d.$t(`${d.mediaType}Details.weblink`)),1)]),_:1},8,["href"]))}});ce.__docgenInfo={exportName:"default",displayName:"VGetMediaButton",description:"",tags:{},props:[{name:"media",required:!0,type:{name:"Media"}},{name:"mediaType",required:!0,type:{name:"SupportedMediaType"}}],sourceFiles:["/home/runner/work/openverse/openverse/frontend/src/components/VMediaInfo/VGetMediaButton.vue"]};const da={class:"w-full lg:w-auto"},ca={class:"heading-6 mb-3 sm:mb-1"},me=V({__name:"VMediaInfo",props:{media:{}},setup(t){return(a,e)=>(p(),v("div",da,[r("h1",ca,h(a.media.title),1),g(sa,{media:a.media},null,8,["media"])]))}});me.__docgenInfo={exportName:"default",displayName:"VMediaInfo",description:"",tags:{},props:[{name:"media",required:!0,type:{name:"Media"}}],sourceFiles:["/home/runner/work/openverse/openverse/frontend/src/components/VMediaInfo/VMediaInfo.vue"]};const ma={class:"full-track w-full"},pa={class:"relative border-b border-default"},fa={key:0,class:"pointer-events-none absolute left-0 hidden h-full w-4 bg-complementary md:block lg:w-10","aria-hidden":""},va={key:1,class:"pointer-events-none absolute right-0 hidden h-full w-4 bg-complementary md:block lg:w-10","aria-hidden":""},ba={class:"md:mx-4 lg:mx-10"},ga={class:"mx-auto grid grid-cols-1 grid-rows-[auto,1fr] gap-y-6 p-6 pb-0 sm:grid-cols-[1fr,auto] sm:grid-rows-1 sm:gap-x-6 lg:mb-6 lg:max-w-5xl"},ya={class:"row-start-1 flex justify-between gap-x-6 sm:col-start-2 sm:mt-1"},pe=V({__name:"VFullLayout",props:{audio:{},size:{},status:{},currentTime:{}},setup(t){return(a,e)=>(p(),v("div",ma,[r("div",pa,[a.currentTime>0?(p(),v("span",fa)):T("",!0),a.status==="played"?(p(),v("span",va)):T("",!0),r("div",ba,[w(a.$slots,"controller",{features:m(ne),usableFrac:.8})])]),r("div",ga,[r("div",ya,[w(a.$slots,"audio-control",M(A({layout:"full",size:"medium"}))),g(ce,{media:a.audio,"media-type":"audio",class:"col-start-2 !w-full px-0 sm:!w-auto sm:flex-shrink-0"},null,8,["media"])]),g(me,{media:a.audio,class:"min-w-0"},null,8,["media"])])]))}});pe.__docgenInfo={exportName:"default",displayName:"VFullLayout",description:"",tags:{},props:[{name:"audio",required:!0,type:{name:"AudioDetail"}},{name:"size",required:!1,type:{name:"AudioSize"}},{name:"status",required:!1,type:{name:"AudioStatus"}},{name:"currentTime",required:!0,type:{name:"number"}}],slots:[{name:"controller",scoped:!0,bindings:[{name:"features",title:"binding"},{name:"usable-frac",title:"binding"}]},{name:"audio-control",scoped:!0,bindings:[{name:"layout",title:"binding"},{name:"size",title:"binding"}]}],sourceFiles:["/home/runner/work/openverse/openverse/frontend/src/components/VAudioTrack/layouts/VFullLayout.vue"]};const ha={class:"z-10 col-span-full row-span-full self-end justify-self-start"},_a={role:"document",class:"flex min-w-0 flex-shrink-0 flex-col gap-1"},wa={key:0,class:"flex flex-col gap-1"},ka={class:"flex flex-row"},$a={class:"flex"},Ta={key:0,class:"dot-before"},Va={key:1,class:"flex flex-shrink-0 flex-row"},fe=V({__name:"VRowLayout",props:{audio:{},size:{}},setup(t){const a=t,e={},n=f(()=>a.size==="s"),u=f(()=>a.size==="m"),d=f(()=>a.size==="l"),{isHidden:c}=P(a.audio),$=I(),l=f(()=>$.isBreakpoint("md"));return(i,L)=>{const s=Be("i18n-t");return p(),v("article",{class:_(["row-track grid p-2 hover:bg-surface md:p-4",[`size-${i.size}`,{"items-start":n.value}]])},[r("div",{class:_(["thumbnail grid overflow-hidden rounded-sm",{"h-20 w-20":n.value}])},[g(le,{audio:i.audio,class:"col-span-full row-span-full"},null,8,["audio"]),ee(r("div",ha,[w(i.$slots,"audio-control",M(A({size:"small",layout:"row",isTabbable:!1})),void 0,!0)],512),[[ae,n.value]])],2),r("div",_a,[r("h2",{class:_(["decoration-inherit line-clamp-1 block overflow-hidden text-ellipsis whitespace-nowrap rounded-sm text-default hover:text-default group-hover:underline",[{"blur-text":m(c)},n.value?"label-bold":"description-bold"]])},h(m(c)?i.$t("sensitiveContent.title.audio"):i.audio.title),3),r("div",{class:_(["flex text-secondary",[n.value?"caption-regular":"label-regular",u.value?"flex-row items-center":"flex-col gap-1"]])},[g(s,{tag:"div",keypath:"audioTrack.creator",scope:"global",class:_(["line-clamp-1 inline-block overflow-hidden text-ellipsis whitespace-nowrap",{"blur-text":m(c)}])},{creator:x(()=>[E(h(m(c)?i.$t("sensitiveContent.creator"):i.audio.creator),1)]),_:1},8,["class"]),n.value?(p(),v("div",wa,[r("div",ka,[r("span",$a,h(m(He)(i.audio.duration||0,!0)),1),i.audio.category?(p(),v("span",Ta,h(i.$t(`filters.audioCategories.${i.audio.category}`)),1)):T("",!0)]),g(R,{"hide-name":!0,license:i.audio.license},null,8,["license"])])):(p(),v("div",Va,[i.audio.category?(p(),v("span",{key:0,class:_({"dot-before":u.value})},h(i.$t(`filters.audioCategories.${i.audio.category}`)),3)):T("",!0),g(R,{"hide-name":!l.value,license:i.audio.license,class:_({"dot-before":u.value||d.value&&i.audio.category})},null,8,["hide-name","license","class"])]))],2)]),ee(r("div",{class:_(["controller flex flex-row",{"ms-2":d.value}])},[w(i.$slots,"audio-control",M(A({size:d.value?"large":"medium",layout:"row",isTabbable:!1})),void 0,!0),w(i.$slots,"controller",{features:m(ne),featureNotices:e,isTabbable:!1},void 0,!0)],2),[[ae,!n.value]])],2)}}}),Sa=j(fe,[["__scopeId","data-v-7f4524aa"]]);fe.__docgenInfo={exportName:"default",displayName:"VRowLayout",description:"",tags:{},props:[{name:"audio",required:!0,type:{name:"AudioDetail"}},{name:"size",required:!1,type:{name:"AudioSize"}}],slots:[{name:"audio-control",scoped:!0,bindings:[{name:"size",title:"binding"},{name:"layout",title:"binding"},{name:"isTabbable",title:"binding"}]},{name:"controller",scoped:!0,bindings:[{name:"features",title:"binding"},{name:"feature-notices",title:"binding"},{name:"is-tabbable",title:"binding"}]}],sourceFiles:["/home/runner/work/openverse/openverse/frontend/src/components/VAudioTrack/layouts/VRowLayout.vue"]};const xa={class:"box-track group relative h-0 w-full rounded-sm bg-complementary pt-full text-default"},za={class:"absolute inset-0 flex flex-col"},Ia={class:"info flex flex-grow flex-col justify-between px-4 pt-4"},Ma={class:"info"},Aa={key:0,class:"label-regular mt-2"},La={class:"player flex h-12 flex-row items-end"},Na={class:"flex-none p-2"},Da={key:0,class:"label-regular self-center"},ve=V({__name:"VBoxLayout",props:{audio:{},size:{}},setup(t){const a=t,{t:e}=ue({useScope:"global"}),n=f(()=>a.size==="s"),u=f(()=>e(`filters.audioCategories.${a.audio.category}`)),{isHidden:d}=P(a.audio);return(c,$)=>(p(),v("div",xa,[r("div",za,[r("div",Ia,[r("h2",{class:_(["label-bold line-clamp-3",{"blur-text":m(d)}])},h(m(d)?c.$t("sensitiveContent.title.audio"):c.audio.title),3),r("div",Ma,[g(R,{class:"hidden group-hover:block group-focus:block","hide-name":"",license:c.audio.license},null,8,["license"]),c.audio.category&&!n.value?(p(),v("div",Aa,h(u.value),1)):T("",!0)])]),r("div",La,[r("div",Na,[w(c.$slots,"audio-control",M(A({size:"small",layout:"box",isTabbable:!1})),void 0,!0)]),c.audio.category&&n.value?(p(),v("p",Da,h(u.value),1)):T("",!0),n.value?T("",!0):w(c.$slots,"controller",{key:1,features:[],isTabbable:!1},void 0,!0)])])]))}}),Ca=j(ve,[["__scopeId","data-v-865931b4"]]);ve.__docgenInfo={exportName:"default",displayName:"VBoxLayout",description:"",tags:{},props:[{name:"audio",required:!0,type:{name:"AudioDetail"}},{name:"size",required:!0,type:{name:"Extract",elements:[{name:"AudioSize"},{name:"union",elements:[{name:'"s"'},{name:'"l"'}]}]}}],slots:[{name:"audio-control",scoped:!0,bindings:[{name:"size",title:"binding"},{name:"layout",title:"binding"},{name:"isTabbable",title:"binding"}]},{name:"controller",scoped:!0,bindings:[{name:"features",title:"binding"},{name:"is-tabbable",title:"binding"}]}],sourceFiles:["/home/runner/work/openverse/openverse/frontend/src/components/VAudioTrack/layouts/VBoxLayout.vue"]};const Fa={class:"global-track grid w-full grid-cols-[3rem,1fr] grid-rows-[3rem,3rem] rounded ring-1 ring-[--color-gray-3] ring-opacity-20"},Ba={class:"h-12 w-12 rounded-ss"},Ra={class:"flex h-12 items-center justify-between rounded-se bg-default"},be=V({__name:"VGlobalLayout",props:{audio:{}},setup(t){const a=t,{audio:e}=Re(a),{isHidden:n}=P(e);return(u,d)=>(p(),v("div",Fa,[r("div",Ba,[g(le,{class:"rounded-ss",audio:m(e)},null,8,["audio"])]),r("div",Ra,[g(de,{href:`/audio/${m(e).id}`,class:_(["hover-underline label-bold z-10 flex flex-row items-center px-3 pe-12 text-default",{"blur-text":m(n)}])},{default:x(()=>[E(h(m(n)?u.$t("sensitiveContent.title.audio"):m(e).title),1)]),_:1},8,["href","class"])]),w(u.$slots,"audio-control",M(A({size:"medium",layout:"global"})),void 0,!0),w(u.$slots,"controller",{usableFrac:1},void 0,!0)]))}}),Ea=j(be,[["__scopeId","data-v-de5164c4"]]);be.__docgenInfo={exportName:"default",displayName:"VGlobalLayout",description:"",tags:{},props:[{name:"audio",required:!0,type:{name:"AudioDetail"}}],slots:[{name:"audio-control",scoped:!0,bindings:[{name:"size",title:"binding"},{name:"layout",title:"binding"}]},{name:"controller",scoped:!0,bindings:[{name:"usable-frac",title:"binding"}]}],sourceFiles:["/home/runner/work/openverse/openverse/frontend/src/components/VAudioTrack/layouts/VGlobalLayout.vue"]};const Pa=V({__name:"VAudioTrack",props:{audio:{},layout:{},size:{},href:{}},emits:["shift-tab","interacted","mousedown","focus"],setup(t,{emit:a}){var Z;const e=t,n=a,{t:u}=ue({useScope:"global"}),d=ia(),c=oa(),$=ra(),l=k("paused"),i=k(0),L=()=>{s||(s=new Audio(e.audio.url)),Object.entries(U).forEach(([o,b])=>s.addEventListener(o,b)),s.paused?s.ended?K():W():O(),i.value=s.currentTime};let s=((Z=$.obj.value)==null?void 0:Z.src)===e.audio.url?$.obj.value:void 0;const q=()=>{s&&(te.includes(l.value)?(i.value=s.currentTime,window.requestAnimationFrame(q)):i.value=s.currentTime)},G=Ue(),ge=()=>{G.setMediaProperties("audio",e.audio.id,{hasLoaded:!0}),l.value="playing"},ye=()=>{l.value="loading"},O=()=>{e.audio.hasLoaded?l.value="playing":l.value="loading",$.obj.value=s,d.setActiveMediaItem({type:"audio",id:e.audio.id}),d.setMessage({message:null}),q()},W=()=>{l.value="paused",d.pauseActiveMediaItem()},K=()=>l.value="played",he=()=>{l.value!=="playing"&&s&&(i.value=s.currentTime,l.value==="played"&&(l.value="paused"))},z=la(()=>{var o;return s?s.duration:typeof((o=e.audio)==null?void 0:o.duration)=="number"?e.audio.duration/1e3:0}),U={play:O,pause:W,ended:K,timeupdate:he,durationchange:()=>{s&&(z.value=s.duration)},waiting:ye,playing:ge};s&&L(),Ee(()=>{if(!s)return;Object.entries(U).forEach(([Ce,Fe])=>s==null?void 0:s.removeEventListener(Ce,Fe));const{matches:o}=Xe(),{matches:b}=Ye(),y=Oe(c==null?void 0:c.params.id);b.value&&y&&y===e.audio.id||o.value&&G.getItemById(Ge,e.audio.id)||s.pause()});const _e=()=>{s||L(),d.playAudio(s)},we=()=>s==null?void 0:s.pause();Pe($.obj,o=>{o!==s&&(l.value==="playing"||l.value==="loading")&&(s==null||s.pause())},{immediate:!0});const ke=f(()=>d.message?u(`audioTrack.messages.${d.message}`):""),D=o=>{let b;if(!o)switch(l.value){case"playing":{o="paused";break}case"paused":case"played":{o="playing";break}}switch(o){case"playing":{_e(),b="play";break}case"paused":{we(),b="pause";break}}H(b)},H=o=>{o&&(N.dismiss(),n("interacted",{event:o,id:e.audio.id,provider:e.audio.provider}))},J=o=>{s||L(),s&&(Number.isFinite(z.value)?s.currentTime=o*z.value:Number.isFinite(s.duration)?s.currentTime=o*s.duration:console.warn("Duration is not finite. Skipping seek.")),H("seek")},$e={full:pe,row:Sa,box:Ca,global:Ea},Te=f(()=>$e[e.layout]),Ve=f(()=>{if(!(e.layout==="box"&&!e.size))return e.size??"m"}),Se=k(null),Q=k(null),xe=o=>{var y;const b=((y=Q.value)==null?void 0:y.$el.contains(o.target))??!1;N.handleMouseDown(),n("mousedown",{event:o,inWaveform:b})},S=f(()=>["box","row"].includes(e.layout)),ze=f(()=>u(S.value?"audioTrack.ariaLabelInteractiveSeekable":"audioTrack.ariaLabel",{title:e.audio.title})),Ie=()=>{l.value=te.includes(l.value)?"paused":"playing",D(l.value)},{isSeeking:Me,...C}=Je({duration:z,currentTime:i,isReady:k(!0),isSeekable:f(()=>e.layout!=="box"),onSeek:J,onTogglePlayback:Ie}),Ae=o=>{C.listeners.keydown(o)},Le=f(()=>S.value?C.attributes.value:{}),N=ua(),X=o=>{N.show(),n("focus",o)},Y=()=>{N.hide(),C.listeners.blur()},Ne=o=>{S.value||X(o)},De=()=>{S.value||Y()};return(o,b)=>(p(),B(se(S.value?de:"div"),F({href:o.href},Le.value,{class:["audio-track group block overflow-hidden rounded-sm hover:no-underline",{"audio-link cursor-pointer focus-visible:focus-bold-filled":o.layout==="box","cursor-pointer focus-visible:focus-slim-tx":o.layout==="row"}],"aria-label":ze.value,role:S.value?"application":void 0,onKeydown:[b[0]||(b[0]=je(qe(y=>o.$emit("shift-tab",y),["shift","exact"]),["tab"])),Ae],onBlur:Y,onMousedown:xe,onFocus:X}),{default:x(()=>[(p(),B(se(Te.value),{audio:o.audio,size:Ve.value,status:l.value,"current-time":i.value},{controller:x(y=>[g(Qe,F({ref_key:"waveformRef",ref:Q},y,{"is-parent-seeking":m(Me),peaks:o.audio.peaks,"audio-id":o.audio.id,"current-time":i.value,duration:m(z),message:ke.value,onSeeked:J,onTogglePlayback:D,onBlur:De,onFocus:Ne}),null,16,["is-parent-seeking","peaks","audio-id","current-time","duration","message"])]),"audio-control":x(y=>[g(Ze,F({ref_key:"audioControlRef",ref:Se,status:l.value},y,{onToggle:D}),null,16,["status"])]),_:1},8,["audio","size","status","current-time"]))]),_:1},16,["href","class","aria-label","role"]))}});Pa.__docgenInfo={exportName:"default",displayName:"VAudioTrack",description:"",tags:{},props:[{name:"audio",description:"The information about the track, typically from a track's detail endpoint",required:!0,type:{name:"AudioDetail"}},{name:"layout",description:`The arrangement of the contents on the canvas. This determines the
overall L&F of the audio component.`,required:!0,type:{name:"AudioLayout"}},{name:"size",description:`The size of the component; Both 'box' and 'row' layouts offer multiple
sizes to choose from.`,required:!1,type:{name:"AudioSize"}},{name:"href",description:`The URL for the single result page. Can include search term and position
in the search results.`,required:!1,type:{name:"string"}}],events:[{name:"shift-tab",type:{names:["KeyboardEvent"]}},{name:"interacted",type:{names:["Pick"],elements:[{name:"AudioInteractionData"},{name:"union",elements:[{name:'"event"'},{name:'"id"'},{name:'"provider"'}]}]}},{name:"mousedown",type:{names:["AudioTrackClickEvent"]}},{name:"focus",type:{names:["FocusEvent"]}}],sourceFiles:["/home/runner/work/openverse/openverse/frontend/src/components/VAudioTrack/VAudioTrack.vue"]};export{Pa as _,me as a,ce as b,ua as u};
