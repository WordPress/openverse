{"version":3,"file":"B-gxTr-H.js","sources":["../../src/components/VCollectionHeader/VCollectionHeader.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { computed } from \"vue\"\n\nimport type { SupportedMediaType } from \"#shared/constants/media\"\nimport type { CollectionParams } from \"#shared/types/search\"\nimport { useMediaStore } from \"~/stores/media\"\nimport { useProviderStore } from \"~/stores/provider\"\nimport { useSearchStore } from \"~/stores/search\"\nimport { useAnalytics } from \"~/composables/use-analytics\"\nimport { useI18nResultsCount } from \"~/composables/use-i18n-utilities\"\n\nimport VIcon from \"~/components/VIcon/VIcon.vue\"\nimport VButton from \"~/components/VButton.vue\"\nimport VScrollableLine from \"~/components/VScrollableLine.vue\"\n\nconst icons = {\n  tag: \"tag\",\n  source: \"institution\",\n  creator: \"person\",\n}\n\n/**\n * Renders the header of a tag/creator/source collection page.\n */\nconst props = defineProps<{\n  mediaType: SupportedMediaType\n  collectionParams: CollectionParams\n  creatorUrl?: string\n}>()\n\nconst mediaStore = useMediaStore()\nconst providerStore = useProviderStore()\nconst searchStore = useSearchStore()\n\nconst iconName = computed(() => icons[props.collectionParams.collection])\nconst collection = computed(() => props.collectionParams.collection)\n\nconst source = computed(() => {\n  if (props.collectionParams.collection === \"tag\") {\n    return {\n      name: \"\",\n      link: \"\",\n    }\n  }\n  return {\n    name: providerStore.getProviderName(\n      props.collectionParams.source,\n      props.mediaType\n    ),\n    link: providerStore.getSourceUrl(\n      props.collectionParams.source,\n      props.mediaType\n    ),\n  }\n})\n\nconst title = computed(() => {\n  if (props.collectionParams.collection === \"tag\") {\n    return props.collectionParams.tag\n  } else if (props.collectionParams.collection === \"creator\") {\n    return props.collectionParams.creator\n  }\n  return source.value.name\n})\n\nconst url = computed(() => {\n  if (props.collectionParams.collection === \"tag\") {\n    return undefined\n  } else if (props.collectionParams.collection === \"creator\") {\n    return props.creatorUrl\n  }\n  return source.value.link\n})\n\nconst sourceCollectionLink = computed(() => {\n  if (props.collectionParams.collection !== \"creator\") {\n    return \"\"\n  }\n  return searchStore.getCollectionPath({\n    type: props.mediaType,\n    collectionParams: {\n      collection: \"source\",\n      source: props.collectionParams.source,\n    },\n  })\n})\n\nconst showCollectionExternalLink = computed(() => {\n  return Boolean(props.collectionParams.collection !== \"tag\" && url.value)\n})\n\nconst { getI18nCollectionResultCountLabel } = useI18nResultsCount()\n\nconst resultsLabel = computed(() => {\n  if (mediaStore.resultCount === 0 && mediaStore.fetchState.isFetching) {\n    return \"\"\n  }\n  const resultsCount = mediaStore.results[props.mediaType].count\n\n  return getI18nCollectionResultCountLabel(\n    resultsCount,\n    props.mediaType,\n    props.collectionParams.collection\n  )\n})\n\nconst { sendCustomEvent } = useAnalytics()\n\nconst sendAnalyticsEvent = () => {\n  if (props.collectionParams.collection === \"tag\") {\n    return\n  }\n\n  const eventName =\n    props.collectionParams.collection === \"creator\"\n      ? \"VISIT_CREATOR_LINK\"\n      : \"VISIT_SOURCE_LINK\"\n  sendCustomEvent(eventName, {\n    url: url.value,\n    source: props.collectionParams.source,\n  })\n}\n</script>\n\n<template>\n  <div\n    class=\"collection-header grid gap-2 sm:grid-cols-[1fr,auto]\"\n    :class=\"{ 'no-link': !showCollectionExternalLink }\"\n  >\n    <h1 class=\"title flex flex-col gap-2 sm:flex-row\">\n      <VIcon\n        :name=\"iconName\"\n        :title=\"collection\"\n        :size=\"10\"\n        class=\"icon hidden sm:flex\"\n      />\n      <span class=\"label-regular flex text-secondary sm:hidden\">{{\n        $t(`collection.heading.${collection}`)\n      }}</span>\n      <span class=\"text-3xl font-semibold leading-snug sm:text-6xl\">{{\n        title\n      }}</span>\n    </h1>\n    <VButton\n      v-if=\"showCollectionExternalLink\"\n      as=\"VLink\"\n      variant=\"filled-dark\"\n      size=\"medium\"\n      class=\"link label-bold mt-1 !w-full\"\n      has-icon-end\n      show-external-icon\n      :external-icon-size=\"6\"\n      :href=\"url\"\n      @click=\"sendAnalyticsEvent\"\n      >{{ $t(`collection.link.${collection}`) }}</VButton\n    >\n    <div\n      class=\"results mt-6 flex w-full min-w-0 flex-col items-start gap-1 sm:mt-0 sm:flex-row sm:items-center\"\n    >\n      <p\n        class=\"label-regular w-max text-secondary sm:whitespace-nowrap\"\n        :class=\"{ 'pb-2 sm:pb-0': collection !== 'creator' }\"\n      >\n        {{ resultsLabel }}\n      </p>\n      <VScrollableLine\n        v-if=\"collection === 'creator'\"\n        class=\"-ms-2 -mt-1.5px h-8 w-[calc(100%+theme(space.4))] sm:ms-0\"\n      >\n        <VButton\n          as=\"VLink\"\n          size=\"disabled\"\n          variant=\"transparent-gray\"\n          class=\"label-bold m-1.5px h-8 w-max gap-x-1 whitespace-nowrap p-1\"\n          :href=\"sourceCollectionLink\"\n          has-icon-start\n          ><VIcon\n            name=\"institution\"\n            :title=\"$t('collection.link.source')\"\n          /><span class=\"w-max whitespace-nowrap\">{{\n            source.name\n          }}</span></VButton\n        >\n      </VScrollableLine>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.collection-header {\n  grid-template-areas: \"title\" \"link\" \"results\";\n}\n.no-link {\n  grid-template-areas: \"title\" \"results\";\n}\n\n@screen sm {\n  .collection-header {\n    grid-template-rows: minmax(3.75rem, auto) minmax(2rem, auto);\n    grid-template-areas: \"title link\" \"results results\";\n  }\n  .no-link {\n    grid-template-rows: minmax(3.625rem, auto) minmax(2rem, auto);\n    grid-template-columns: auto;\n    grid-template-areas: \"title\" \"results\";\n  }\n}\n.title {\n  grid-area: title;\n}\n.link {\n  grid-area: link;\n}\n.results {\n  grid-area: results;\n}\n</style>\n"],"names":["icons","props","__props","mediaStore","useMediaStore","providerStore","useProviderStore","searchStore","useSearchStore","iconName","computed","collection","source","title","url","sourceCollectionLink","showCollectionExternalLink","getI18nCollectionResultCountLabel","useI18nResultsCount","resultsLabel","resultsCount","sendCustomEvent","useAnalytics","sendAnalyticsEvent","eventName"],"mappings":"2lCAeA,MAAMA,EAAQ,CACZ,IAAK,MACL,OAAQ,cACR,QAAS,QACX,EAKMC,EAAQC,EAMRC,EAAaC,EAAc,EAC3BC,EAAgBC,EAAiB,EACjCC,EAAcC,EAAe,EAE7BC,EAAWC,EAAS,IAAMV,EAAMC,EAAM,iBAAiB,UAAU,CAAC,EAClEU,EAAaD,EAAS,IAAMT,EAAM,iBAAiB,UAAU,EAE7DW,EAASF,EAAS,IAClBT,EAAM,iBAAiB,aAAe,MACjC,CACL,KAAM,GACN,KAAM,EACR,EAEK,CACL,KAAMI,EAAc,gBAClBJ,EAAM,iBAAiB,OACvBA,EAAM,SACR,EACA,KAAMI,EAAc,aAClBJ,EAAM,iBAAiB,OACvBA,EAAM,SAAA,CAEV,CACD,EAEKY,EAAQH,EAAS,IACjBT,EAAM,iBAAiB,aAAe,MACjCA,EAAM,iBAAiB,IACrBA,EAAM,iBAAiB,aAAe,UACxCA,EAAM,iBAAiB,QAEzBW,EAAO,MAAM,IACrB,EAEKE,EAAMJ,EAAS,IAAM,CACrB,GAAAT,EAAM,iBAAiB,aAAe,MAE/B,OAAAA,EAAM,iBAAiB,aAAe,UACxCA,EAAM,WAERW,EAAO,MAAM,IAAA,CACrB,EAEKG,EAAuBL,EAAS,IAChCT,EAAM,iBAAiB,aAAe,UACjC,GAEFM,EAAY,kBAAkB,CACnC,KAAMN,EAAM,UACZ,iBAAkB,CAChB,WAAY,SACZ,OAAQA,EAAM,iBAAiB,MAAA,CACjC,CACD,CACF,EAEKe,EAA6BN,EAAS,IACnC,GAAQT,EAAM,iBAAiB,aAAe,OAASa,EAAI,MACnE,EAEK,CAAE,kCAAAG,CAAkC,EAAIC,EAAoB,EAE5DC,EAAeT,EAAS,IAAM,CAClC,GAAIP,EAAW,cAAgB,GAAKA,EAAW,WAAW,WACjD,MAAA,GAET,MAAMiB,EAAejB,EAAW,QAAQF,EAAM,SAAS,EAAE,MAElD,OAAAgB,EACLG,EACAnB,EAAM,UACNA,EAAM,iBAAiB,UACzB,CAAA,CACD,EAEK,CAAE,gBAAAoB,CAAgB,EAAIC,EAAa,EAEnCC,EAAqB,IAAM,CAC3B,GAAAtB,EAAM,iBAAiB,aAAe,MACxC,OAGF,MAAMuB,EACJvB,EAAM,iBAAiB,aAAe,UAClC,qBACA,oBACNoB,EAAgBG,EAAW,CACzB,IAAKV,EAAI,MACT,OAAQb,EAAM,iBAAiB,MAAA,CAChC,CACH"}