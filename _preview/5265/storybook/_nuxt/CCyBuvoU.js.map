{"version":3,"file":"CCyBuvoU.js","sources":["../../src/components/VHeader/VHeaderInternal.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { useNuxtApp, useRoute } from \"#imports\"\nimport { computed, ref, SetupContext, watch } from \"vue\"\n\nimport { PAGES_DIALOG } from \"#shared/constants/dialogs\"\nimport { useUiStore } from \"~/stores/ui\"\nimport { useDialogControl } from \"~/composables/use-dialog-control\"\nimport { useHydrating } from \"~/composables/use-hydrating\"\n\nimport VHomeLink from \"~/components/VHeader/VHomeLink.vue\"\nimport VPageLinks from \"~/components/VHeader/VPageLinks.vue\"\nimport VModalContent from \"~/components/VModal/VModalContent.vue\"\nimport VPopoverContent from \"~/components/VPopover/VPopoverContent.vue\"\nimport VWordPressLink from \"~/components/VHeader/VWordPressLink.vue\"\nimport VIconButton from \"~/components/VIconButton/VIconButton.vue\"\n\nconst emit = defineEmits<{\n  open: []\n  close: []\n}>() as SetupContext[\"emit\"]\n\nconst menuButtonRef = ref<InstanceType<typeof VIconButton> | null>(null)\nconst nodeRef = ref<HTMLElement | null>(null)\nconst modalContentRef = ref<InstanceType<typeof VModalContent> | null>(null)\n\nconst uiStore = useUiStore()\n\nconst route = useRoute()\n\nconst { $sendCustomEvent } = useNuxtApp()\n\nconst isModalVisible = ref(false)\n\nconst isSm = computed(() => uiStore.isBreakpoint(\"sm\"))\n\nconst triggerElement = computed(\n  () => (menuButtonRef.value?.$el as HTMLElement) || null\n)\n\nconst lockBodyScroll = computed(() => !isSm.value)\n\nconst deactivateFocusTrap = computed(\n  () => modalContentRef.value?.deactivateFocusTrap\n)\n\nconst { doneHydrating } = useHydrating()\n\nconst {\n  close: closePageMenu,\n  open: openPageMenu,\n  onTriggerClick: internalOnTriggerClick,\n  triggerA11yProps,\n} = useDialogControl({\n  id: PAGES_DIALOG,\n  visibleRef: isModalVisible,\n  nodeRef,\n  lockBodyScroll,\n  emit,\n  deactivateFocusTrap,\n})\n\nconst onTriggerClick = () => {\n  if (!isModalVisible.value) {\n    $sendCustomEvent(\"OPEN_PAGES_MENU\", {})\n  }\n  return internalOnTriggerClick()\n}\n\n// When clicking on an internal link in the modal, close the modal\nwatch(route, () => {\n  if (isModalVisible.value) {\n    closePageMenu()\n  }\n})\n</script>\n\n<template>\n  <header\n    ref=\"nodeRef\"\n    class=\"main-header z-30 flex h-20 w-full items-stretch justify-between gap-x-2 border-b border-tx px-2 py-4 md:py-4 lg:pe-10 lg:ps-6\"\n  >\n    <VHomeLink />\n    <nav class=\"hidden lg:flex\">\n      <VPageLinks\n        mode=\"light\"\n        class=\"flex items-center gap-6 text-sm\"\n        @close=\"closePageMenu\"\n      />\n    </nav>\n    <div class=\"flex lg:hidden\">\n      <VIconButton\n        id=\"menu-button\"\n        ref=\"menuButtonRef\"\n        variant=\"transparent-dark\"\n        size=\"large\"\n        :disabled=\"!doneHydrating\"\n        :icon-props=\"{ name: 'menu' }\"\n        :label=\"$t('header.aria.menu')\"\n        v-bind=\"triggerA11yProps\"\n        @click=\"onTriggerClick\"\n      />\n      <template v-if=\"triggerElement\">\n        <VPopoverContent\n          v-if=\"isSm\"\n          :id=\"PAGES_DIALOG\"\n          z-index=\"popover\"\n          :hide=\"closePageMenu\"\n          :visible=\"isModalVisible\"\n          :trigger-element=\"triggerElement\"\n          :trap-focus=\"false\"\n          aria-labelledby=\"menu-button\"\n        >\n          <VPageLinks\n            mode=\"dark\"\n            variant=\"itemgroup\"\n            class=\"label-regular w-50 items-start\"\n            @close=\"closePageMenu\"\n          />\n        </VPopoverContent>\n        <VModalContent\n          v-else-if=\"!isSm\"\n          :id=\"PAGES_DIALOG\"\n          ref=\"modalContentRef\"\n          aria-labelledby=\"menu-button\"\n          :hide=\"closePageMenu\"\n          variant=\"full\"\n          mode=\"dark\"\n          content-classes=\"flex sm:hidden\"\n          :visible=\"isModalVisible\"\n          @open=\"openPageMenu\"\n        >\n          <template #top-bar>\n            <div class=\"flex h-20 w-full justify-between px-2 py-4\">\n              <VHomeLink />\n              <VIconButton\n                variant=\"transparent-tx\"\n                size=\"large\"\n                :icon-props=\"{ name: 'close' }\"\n                class=\"text-white hover:bg-surface focus-visible:focus-slim-tx\"\n                :label=\"$t('modal.closePagesMenu')\"\n                @click=\"closePageMenu\"\n              />\n            </div>\n          </template>\n          <template #default>\n            <nav>\n              <VPageLinks\n                mode=\"dark\"\n                class=\"mt-3 flex flex-col items-end gap-y-6\"\n                nav-link-classes=\"text-white text-3xl focus-visible:outline-focus\"\n                :is-in-modal=\"true\"\n                @close=\"closePageMenu\"\n              />\n            </nav>\n            <VWordPressLink class=\"mt-auto\" />\n          </template>\n        </VModalContent>\n      </template>\n    </div>\n  </header>\n</template>\n"],"names":["emit","__emit","menuButtonRef","ref","nodeRef","modalContentRef","uiStore","useUiStore","route","useRoute","$sendCustomEvent","useNuxtApp","isModalVisible","isSm","computed","triggerElement","_a","lockBodyScroll","deactivateFocusTrap","doneHydrating","useHydrating","closePageMenu","openPageMenu","internalOnTriggerClick","triggerA11yProps","useDialogControl","PAGES_DIALOG","onTriggerClick","watch"],"mappings":"w+BAgBA,MAAMA,EAAOC,EAKPC,EAAgBC,EAA6C,IAAI,EACjEC,EAAUD,EAAwB,IAAI,EACtCE,EAAkBF,EAA+C,IAAI,EAErEG,EAAUC,EAAW,EAErBC,EAAQC,EAAS,EAEjB,CAAE,iBAAAC,CAAiB,EAAIC,EAAW,EAElCC,EAAiBT,EAAI,EAAK,EAE1BU,EAAOC,EAAS,IAAMR,EAAQ,aAAa,IAAI,CAAC,EAEhDS,EAAiBD,EACrB,WAAO,QAAAE,EAAAd,EAAc,QAAd,YAAAc,EAAqB,MAAuB,KACrD,EAEMC,EAAiBH,EAAS,IAAM,CAACD,EAAK,KAAK,EAE3CK,EAAsBJ,EAC1B,IAAM,OAAA,OAAAE,EAAAX,EAAgB,QAAhB,YAAAW,EAAuB,oBAC/B,EAEM,CAAE,cAAAG,CAAc,EAAIC,EAAa,EAEjC,CACJ,MAAOC,EACP,KAAMC,EACN,eAAgBC,EAChB,iBAAAC,GACEC,EAAiB,CACnB,GAAIC,EACJ,WAAYd,EACZ,QAAAR,EACA,eAAAa,EACA,KAAAjB,EACA,oBAAAkB,CAAA,CACD,EAEKS,EAAiB,KAChBf,EAAe,OACDF,EAAA,kBAAmB,EAAE,EAEjCa,EAAuB,GAIhC,OAAAK,EAAMpB,EAAO,IAAM,CACbI,EAAe,OACHS,EAAA,CAChB,CACD"}