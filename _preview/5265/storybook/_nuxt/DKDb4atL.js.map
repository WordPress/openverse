{"version":3,"file":"DKDb4atL.js","sources":["../../src/components/VModal/VModalContent.vue"],"sourcesContent":["<script setup lang=\"ts\">\n/**\n * Renders the inner content of a modal and manages focus.\n */\nimport { toRefs, ref, computed, useAttrs } from \"vue\"\n\nimport { useElementSize } from \"@vueuse/core\"\n\nimport type { ModalColorMode, ModalVariant } from \"#shared/types/modal\"\nimport { useDialogContent } from \"~/composables/use-dialog-content\"\n\nimport VIconButton from \"~/components/VIconButton/VIconButton.vue\"\n\ndefineOptions({\n  inheritAttrs: false,\n})\n\nconst props = withDefaults(\n  defineProps<{\n    id: string\n    visible: boolean\n    hide: () => void\n    hideOnEsc?: boolean\n    hideOnClickOutside?: boolean\n    autoFocusOnShow?: boolean\n    autoFocusOnHide?: boolean\n    trapFocus?: boolean\n    triggerElement?: HTMLElement | null\n    initialFocusElement?: HTMLElement | null\n    variant?: ModalVariant\n    mode?: ModalColorMode\n    /**\n     * The tailwind classes to apply to the modal backdrop element.\n     * Can be used to make the modal hidden on some breakpoint.\n     */\n    contentClasses?: string\n  }>(),\n  {\n    hideOnEsc: true,\n    hideOnClickOutside: false,\n    autoFocusOnShow: true,\n    autoFocusOnHide: true,\n    trapFocus: true,\n    triggerElement: null,\n    initialFocusElement: null,\n    variant: \"default\",\n    mode: \"light\",\n    contentClasses: \"\",\n  }\n)\n\nconst emit = defineEmits<{\n  keydown: [KeyboardEvent]\n  focus: [FocusEvent]\n  blur: [FocusEvent]\n  close: []\n  open: []\n}>()\n\nconst attrs = useAttrs()\n\nconst propsRefs = toRefs(props)\nconst closeButton = ref<InstanceType<typeof VIconButton> | null>(null)\nconst initialFocusElement = computed(\n  () => props.initialFocusElement || closeButton.value?.$el\n)\nconst dialogRef = ref<HTMLElement | null>(null)\nconst { onKeyDown, onBlur, deactivateFocusTrap } = useDialogContent({\n  dialogElements: {\n    dialogRef,\n    initialFocusElementRef: initialFocusElement,\n    triggerElementRef: propsRefs.triggerElement,\n  },\n  visibleRef: propsRefs.visible,\n  dialogOptions: {\n    hideOnEscRef: propsRefs.hideOnEsc,\n    hideOnClickOutsideRef: propsRefs.hideOnClickOutside,\n    autoFocusOnShowRef: propsRefs.autoFocusOnShow,\n    autoFocusOnHideRef: propsRefs.autoFocusOnHide,\n    trapFocusRef: propsRefs.trapFocus,\n  },\n  hideRef: propsRefs.hide,\n  emit: emit as (event: string) => void,\n  attrs,\n})\n\nconst handleClose = (event: MouseEvent) => {\n  event.stopPropagation()\n  props.hide()\n}\n\nconst modalHeaderRef = ref<HTMLElement | null>(null)\nconst { height: modalHeaderHeight } = useElementSize(\n  modalHeaderRef,\n  { width: 0, height: 0 },\n  { box: \"border-box\" }\n)\n\ndefineExpose({\n  dialogRef,\n  deactivateFocusTrap,\n})\n</script>\n\n<template>\n  <Teleport to=\"#teleports\">\n    <div\n      v-show=\"visible\"\n      class=\"backdrop h-dyn-screen min-h-dyn-screen fixed inset-0 z-40 flex justify-center overflow-y-auto\"\n      :class=\"[\n        { 'flex-col items-center': variant === 'centered' },\n        variant === 'mobile-input' ? 'bg-tx' : 'bg-modal-layer bg-opacity-75',\n        contentClasses,\n        variant,\n      ]\"\n    >\n      <!-- re: disabled static element interactions rule https://github.com/WordPress/openverse/issues/2906 -->\n      <!-- eslint-disable-next-line vuejs-accessibility/no-static-element-interactions -->\n      <div\n        :id=\"id\"\n        ref=\"dialogRef\"\n        v-bind=\"$attrs\"\n        class=\"flex flex-col\"\n        :class=\"[\n          mode === 'dark'\n            ? 'dark-mode bg-black text-default'\n            : 'bg-overlay text-default',\n          {\n            'w-full md:max-w-[768px] lg:w-[768px] xl:w-[1024px] xl:max-w-[1024px]':\n              variant === 'default',\n            'w-full': variant === 'full',\n            'mt-auto h-2/3 w-full rounded-se-lg rounded-ss-lg bg-overlay':\n              variant === 'two-thirds',\n            'mt-auto w-full rounded-se-lg rounded-ss-lg bg-overlay':\n              variant === 'fit-content',\n            'm-6 max-w-90 rounded sm:m-0 sm:w-90': variant === 'centered',\n          },\n        ]\"\n        :style=\"`--modal-header-height: ${modalHeaderHeight}px;`\"\n        role=\"dialog\"\n        aria-modal=\"true\"\n        @keydown=\"onKeyDown\"\n        @blur=\"onBlur\"\n      >\n        <slot name=\"top-bar\" :close=\"hide\">\n          <!--\n                  These specific padding and margin values serve to\n                  visually align the Openverse logo button in the modal\n                  with the header logo button so that there isn't a\n                  jarring \"shifting\" effect when opening the mobile modal.\n                -->\n          <div\n            v-if=\"variant === 'default'\"\n            class=\"flex w-full shrink-0 justify-between bg-overlay py-4 pe-3 ps-4 md:justify-end md:bg-tx md:px-0 md:py-3\"\n          >\n            <VIconButton\n              ref=\"closeButton\"\n              :label=\"$t('modal.ariaClose')\"\n              variant=\"filled-white\"\n              size=\"small\"\n              @click=\"handleClose\"\n            />\n          </div>\n        </slot>\n        <header\n          v-if=\"variant === 'centered'\"\n          ref=\"modalHeaderRef\"\n          class=\"flex items-center justify-between p-5 ps-7 sm:p-7 sm:ps-9\"\n        >\n          <slot name=\"title\" />\n          <slot name=\"close-button\" :close=\"handleClose\">\n            <VIconButton\n              :label=\"$t('modal.close')\"\n              :icon-props=\"{ name: 'close' }\"\n              variant=\"transparent-gray\"\n              size=\"small\"\n              @click=\"handleClose\"\n            />\n          </slot>\n        </header>\n\n        <div\n          class=\"modal-content flex w-full flex-grow flex-col text-default\"\n          :class=\"[\n            {\n              'text-left align-bottom md:rounded-se-lg md:rounded-ss-lg':\n                variant === 'default',\n              'w-auto rounded': variant === 'centered',\n              'mt-auto w-full rounded-se-lg rounded-ss-lg bg-overlay':\n                variant === 'fit-content',\n              'flex w-full flex-col justify-between px-6 pb-10':\n                variant === 'full',\n              'overflow-y-hidden rounded-se-lg rounded-ss-lg':\n                variant === 'two-thirds',\n              'h-full': variant === 'mobile-input',\n              'fallback-padding':\n                variant === 'fit-content' ||\n                variant === 'two-thirds' ||\n                variant === 'mobile-input',\n            },\n            variant === 'mobile-input'\n              ? 'bg-default'\n              : mode === 'dark'\n                ? 'bg-black'\n                : 'bg-overlay',\n          ]\"\n        >\n          <slot />\n        </div>\n      </div>\n    </div>\n  </Teleport>\n</template>\n\n<style scoped>\n.backdrop.mobile-input {\n  height: calc(100dvh - var(--header-height, 80px));\n  top: var(--header-height, 80px);\n}\n/*\nFor mobiles that do not support dvh units, we add a fallback padding\nto the modal content to make sure that no clickable elements are hidden\nby the address bar.\n*/\n@supports not (height: 100dvh) {\n  .modal-content.fallback-padding {\n    @apply pb-10;\n  }\n}\n.modal-content {\n  max-height: calc(100vh - var(--modal-header-height, 0) - 6rem);\n  overflow-y: auto;\n}\n</style>\n"],"names":["props","__props","emit","__emit","attrs","useAttrs","propsRefs","toRefs","closeButton","ref","initialFocusElement","computed","_a","dialogRef","onKeyDown","onBlur","deactivateFocusTrap","useDialogContent","handleClose","event","modalHeaderRef","modalHeaderHeight","useElementSize","__expose"],"mappings":"guCAiBA,MAAMA,EAAQC,EAkCRC,EAAOC,EAQPC,EAAQC,EAAS,EAEjBC,EAAYC,EAAOP,CAAK,EACxBQ,EAAcC,EAA6C,IAAI,EAC/DC,EAAsBC,EAC1B,IAAA,OAAM,OAAAX,EAAM,uBAAuBY,EAAAJ,EAAY,QAAZ,YAAAI,EAAmB,KACxD,EACMC,EAAYJ,EAAwB,IAAI,EACxC,CAAE,UAAAK,EAAW,OAAAC,EAAQ,oBAAAC,CAAA,EAAwBC,EAAiB,CAClE,eAAgB,CACd,UAAAJ,EACA,uBAAwBH,EACxB,kBAAmBJ,EAAU,cAC/B,EACA,WAAYA,EAAU,QACtB,cAAe,CACb,aAAcA,EAAU,UACxB,sBAAuBA,EAAU,mBACjC,mBAAoBA,EAAU,gBAC9B,mBAAoBA,EAAU,gBAC9B,aAAcA,EAAU,SAC1B,EACA,QAASA,EAAU,KACnB,KAAAJ,EACA,MAAAE,CAAA,CACD,EAEKc,EAAeC,GAAsB,CACzCA,EAAM,gBAAgB,EACtBnB,EAAM,KAAK,CACb,EAEMoB,EAAiBX,EAAwB,IAAI,EAC7C,CAAE,OAAQY,CAAA,EAAsBC,EACpCF,EACA,CAAE,MAAO,EAAG,OAAQ,CAAE,EACtB,CAAE,IAAK,YAAa,CACtB,EAEa,OAAAG,EAAA,CACX,UAAAV,EACA,oBAAAG,CAAA,CACD;"}