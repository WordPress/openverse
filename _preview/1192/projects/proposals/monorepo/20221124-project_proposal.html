<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Trust &amp; Safety" href="../trust_and_safety/index.html" /><link rel="prev" title="Monorepo" href="index.html" />

    <link rel="shortcut icon" href="https://raw.githubusercontent.com/WordPress/openverse/master/brand/icon.svg"/><!-- Generated with Sphinx 6.1.3 and Furo 2023.03.27 -->
        <title>Project Proposal - 2022-11-24 - Openverse documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Openverse  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/logo_light.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/logo_dark.svg" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../guides/index.html">Guides</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../guides/general_setup.html">General setup guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guides/quickstart.html">Quickstart guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guides/deployment.html">Deployments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guides/logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guides/zero-downtime-database-management.html">Zero Downtime and Database Management</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../guides/api/index.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../guides/api/quickstart.html">Quickstart guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../guides/api/test.html">Testing guide</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../guides/ingestion_server/index.html">Ingestion server</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../guides/ingestion_server/quickstart.html">Quickstart guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../guides/ingestion_server/test.html">Testing guide</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../guides/frontend/index.html">Frontend</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../guides/frontend/quickstart.html">Quickstart guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../guides/frontend/test.html">Testing guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../guides/frontend/analytics.html">Analytics</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../guides/documentation/index.html">Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../guides/documentation/quickstart.html">Quickstart guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../guides/documentation/guidelines.html">Documentation Guidelines</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../reference/index.html">Reference</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/github_contribution_practices.html">GitHub contribution practices</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../reference/decision_making/index.html">Openverse Decision-Making Process</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/decision_making/process_description.html">Process description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/decision_making/additional_practices.html">Additional practices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/decision_making/how_to_use.html">How to follow the process in different settings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/dev_flow.html">Development workflow</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../reference/api/index.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/api/authentication_and_throttling.html">Authentication and Throttling</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../reference/frontend/index.html">Frontend</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/frontend/feature_flags.html">Feature flags</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/search_algorithm.html">Search Algorithm</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../index.html">Projects</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../planning.html">Project Planning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../templates/implementation-plan.html">Implementation Plan Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../templates/project-proposal.html">Project Proposal Template</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../3d_model_support/index.html">3D Model Support</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../3d_model_support/20220221-project_proposal.html">Project Proposal - 2022-02-21</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../analytics/index.html">Analytics</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../analytics/20221006-implementation_plan_frontend.html">Implentation Plan: Frontend event tracking - 2022-10-06</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analytics/20230307-backend_service.html">Implementation Plan: Analytics backend and visualisation service - 2023-03-07</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../core_user_interface_improvement/index.html">Core User Interface Improvements</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../core_user_interface_improvement/20230314-project_proposal_core_ui_improvement.html">Project Proposal - 2023-03-14</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../detecting_sensitive_textual_content/index.html">Detecting and Blurring Sensitive Textual Content</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../detecting_sensitive_textual_content/20230309-implementation_plan_sensitive_terms_list.html">Implementation Plan: Sensitive Terms List - 2023-03-09</a></li>
<li class="toctree-l3"><a class="reference internal" href="../detecting_sensitive_textual_content/20230309-project_proposal_detecting_sensitive_textual_content.html">Project Proposal - 2023-03-09</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../feature_flags/index.html">Feature Flags</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../feature_flags/20220309-project_proposal.html">Project Proposal - 2022-03-09</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../frontend_ui_state_cookie/index.html">Frontend UI State Cookie</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../frontend_ui_state_cookie/20220218-project_proposal.html">2022-02-18 Project Propsal: Frontend UI State Cookie</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../monitoring/index.html">Monitoring</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../monitoring/20220307-project_proposal.html">Project Proposal - 2022-03-07</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Monorepo</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Project Proposal - 2022-11-24</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../trust_and_safety/index.html">Trust &amp; Safety</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../trust_and_safety/20230109-trust_and_safety_preliminary_overview_and_exploration.html">2023-01-09 Project Proposal</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../visual_regression_testing/index.html">Visual Regression Testing</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../visual_regression_testing/20220217-implementation_plan.html">Implementation Plan - 2022-02-17</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../vuex_to_pina_conversion/index.html">Pinia Conversion</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../vuex_to_pina_conversion/20220223-project_proposal.html">Project Proposal - 2022-02-23</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../changelogs/index.html">Changelogs</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../changelogs/api/index.html">API changelogs</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelogs/api/2023.04.13.23.36.40.html">2023.04.13.23.36.40</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../changelogs/frontend/index.html">Frontend changelogs</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../changelogs/ingestion_server/index.html">Ingestion server changelogs</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../terms_of_service.html">Openverse API Terms of Service</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/WordPress/openverse">GitHub repo</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="project-proposal-2022-11-24">
<h1>Project Proposal - 2022-11-24<a class="headerlink" href="#project-proposal-2022-11-24" title="Permalink to this heading">#</a></h1>
<section id="reviewers">
<h2>Reviewers<a class="headerlink" href="#reviewers" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>[ ] &#64;zackkrida</p></li>
<li><p>[ ] &#64;sarayourfriend</p></li>
</ul>
</section>
<section id="rationale">
<h2>Rationale<a class="headerlink" href="#rationale" title="Permalink to this heading">#</a></h2>
<p>For a comprehensive discussion about the pros, the cons and the counterpoints to
each see <a class="reference external" href="https://github.com/WordPress/openverse/issues/192">discussion</a>. Some
of the more nuanced points are listed below, biased towards the overall benefits
of a monorepo to justify the RFC. This RFC also proceeds to go into the
implementation details hoping that the benefits are cumulatively enough of an
improvement to convince everyone to migrate.</p>
<section id="benefits-of-monorepo">
<h3>Benefits of monorepo<a class="headerlink" href="#benefits-of-monorepo" title="Permalink to this heading">#</a></h3>
<ol class="arabic">
<li><p>Single place for everything:</p>
<p><strong>Current criticism:</strong> We currently have many repos, and issues and PRs
spanning all of them. While this makes it easier for us as maintainers to
focus our efforts, it’s not easy for contributors. Let’s say you were a new
contributor looking for good-first Python issues. We shouldn’t expect them to
search in 3 repos <code class="docutils literal notranslate"><span class="pre">openverse</span></code>, <code class="docutils literal notranslate"><span class="pre">openverse-api</span></code> and <code class="docutils literal notranslate"><span class="pre">openverse-catalog</span></code>. We
address this by making tools like Overvue or using search terms like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ow">is</span><span class="p">:</span><span class="nb">open</span> <span class="ow">is</span><span class="p">:</span><span class="n">issue</span> <span class="n">repo</span><span class="p">:</span><span class="n">WordPress</span><span class="o">/</span><span class="n">openverse</span><span class="o">-</span><span class="n">catalog</span> <span class="n">repo</span><span class="p">:</span><span class="n">WordPress</span><span class="o">/</span><span class="n">openverse</span> <span class="n">repo</span><span class="p">:</span><span class="n">WordPress</span><span class="o">/</span><span class="n">openverse</span><span class="o">-</span><span class="n">api</span> <span class="n">repo</span><span class="p">:</span><span class="n">WordPress</span><span class="o">/</span><span class="n">openverse</span><span class="o">-</span><span class="n">frontend</span> <span class="n">repo</span><span class="p">:</span><span class="n">WordPress</span><span class="o">/</span><span class="n">openverse</span><span class="o">-</span><span class="n">infrastructure</span> <span class="n">sort</span><span class="p">:</span><span class="n">updated</span><span class="o">-</span><span class="n">desc</span>
</pre></div>
</div>
<p>The search term above perfectly illustrates the problem: we forgot about the
extension. It’s unwieldy and hard to quickly reach and share.</p>
<p><strong>Monorepo solution:</strong> We could use GitHub’s own filters to narrow down what
we’re looking for.</p>
</li>
<li><p>Meta-issues:</p>
<p><strong>Current criticism:</strong> If an issue spans more than a single layer of the
stack, we need to open a meta issue in <code class="docutils literal notranslate"><span class="pre">WordPress/openverse</span></code>, open sub-issues
in each of the different repos, then manually close meta issues after the
sub-issues are closed. Same goes for PRs. We make individual PRs for every
layer and then have to cross-reference them so that reviewers can see the
full picture. Meta issues are good when a work needs to split into subtasks,
but they are not good for cross-repo work splitting, especially when the work
happens completely outside the knowledge of the meta-issue.</p>
<p><strong>Monorepo solution:</strong> A monorepo allows our cross-layer PRs to be viewed
more holistically and be reviewed as a complete change.</p>
</li>
<li><p>No more sync:</p>
<p>Current criticism: We use complex sync workflows to keep files in sync. Some
workflows need to by synced to some repos only. Some workflows shouldn’t even
be in the repo they’re synced from. Some files need subtle differences so we
compile Jinja templates for them. We also sync GitHub labels and branch
management rules. It’s a mess (I would know!).</p>
<p><strong>Monorepo solution:</strong> A monorepo eliminates all of this and saves the time
and effort that goes into maintaining these systems.</p>
</li>
<li><p>Unified documentation:</p>
<p><strong>Current criticism:</strong> Having many repos, each with its own doc site means
two things. Common docs such as contribution process needs to be repeated
several times and repo-specific docs get siloed and can only reference each
other with external links. Also changing docs in one repo will break any
links pointing to it.</p>
<p><strong>Monorepo solution:</strong> A better system would be one cohesive doc site, for
which the API already has a framework that other repos can just use.</p>
</li>
<li><p>Infra included:</p>
<p><strong>Current criticism:</strong> Our deployment workflows have code duplication.
Secrets are stored in lots of repos, we keep secrets synced using Terraform.
Containers are used in the infra repo but published in their individual
repos.</p>
<p><strong>Monorepo solution:</strong> Monorepo enables the infra to coexist with the code
(albeit in a separate module). Apart from the (encrypted) private secrets,
the IaC could be open-sourced similar to the rest of the codebase. Our
deployment workflows can share code and deployment secrets.</p>
</li>
<li><p>GitHub Milestones:</p>
<p>Milestones are confined by repository boundaries. To have milestones that
cover issues in different layers of our stack, the only way is for them to be
in a monorepo. This is a limitation imposed by GitHub and there is no
workaround for this.</p>
</li>
</ol>
<p>The overarching theme is that there are workarounds for everything. We have been
working with split repos quite productively for over a year. My proposition is
the the monorepo solutions are better than workarounds.</p>
<p>The <a class="reference internal" href="#step-4-integration"><span class="xref myst">integration</span></a> section in the latter part of the
document describes more interesting outcomes made possible by the monorepo. They
may or may not be exclusive to monorepos but they’re surely made easier by it.</p>
</section>
</section>
<section id="migration-path">
<h2>Migration path<a class="headerlink" href="#migration-path" title="Permalink to this heading">#</a></h2>
<p>First we will merge the API and the frontend repos into <code class="docutils literal notranslate"><span class="pre">WordPress/openverse</span></code>.
This decision was made for the following reasons.</p>
<ol class="arabic simple">
<li><p>API and frontend are tightly linked. The frontend is a direct consumer of
what the API produces.</p></li>
<li><p>The API and frontend form the “service” side of Openverse that directly faces
the users (both API consumers and Search engine users).</p></li>
<li><p>The frontend uses ECS deployments and the API is well on the same track. This
makes it possible for them to share some deployment code.</p></li>
<li><p>I am very familiar with the scripts repo, the API and the frontend so merging
them would be easier. Adding a third component would make the task daunting.</p></li>
<li><p>Merging incurs a productivity hit for the initial transition. So merging
everything in one swoop is not ideal. While we merge these three, effort can
be diverted to the catalog.</p></li>
<li><p>The API’s comprehensive tooling for developer documentation can benefit
frontend devs and create a unified docs site for contributors.</p></li>
<li><p>The merge of two JavaScript codebases provides fertile ground for testing
<code class="docutils literal notranslate"><span class="pre">pnpm</span></code> workspaces.</p>
<ul class="simple">
<li><p>It also allows us to merge the browser extension later and split the design
system/component library stuff into a separate package.</p></li>
</ul>
</li>
<li><p>The API is already organised by stack folders so the <code class="docutils literal notranslate"><span class="pre">frontend/</span></code> directory
will fit right in with the others like <code class="docutils literal notranslate"><span class="pre">api/</span></code> and <code class="docutils literal notranslate"><span class="pre">ingestion_server/</span></code>.
Similarly the scripts repo is nicely organised in folders, reducing
conflicts.</p></li>
<li><p>The API and frontend share identical tooling for Git hooks, linting and
formatting. We will fight our tools less and encounter minimal friction.</p>
<ul class="simple">
<li><p>The frontend’s approach for <code class="docutils literal notranslate"><span class="pre">pre-commit</span></code> expanded this type of usage to the
API as well!</p></li>
<li><p>We’re expanding the use of double-quoted strings to JavaScript to further
unify our style guides.</p></li>
</ul>
</li>
<li><p>The entire system can be integration tested during releases. The real API,
populated with test data, can replace the Talkback server as long as we
disable network calls and make output deterministic.</p></li>
</ol>
<p>The <code class="docutils literal notranslate"><span class="pre">WordPress/openverse</span></code> repo will absorb the <code class="docutils literal notranslate"><span class="pre">WordPress/openverse-api</span></code> and
<code class="docutils literal notranslate"><span class="pre">WordPress/openverse-frontend</span></code> repos. The <code class="docutils literal notranslate"><span class="pre">WordPress/openverse-catalog</span></code> will
also be merged, <em>later</em>.</p>
<section id="reference">
<h3>Reference<a class="headerlink" href="#reference" title="Permalink to this heading">#</a></h3>
<p>I’m following the steps listed below in a fork at
<s><a class="reference external" href="https://github.com/dhruvkb/monopenverse/">&#64;dhruvkb/monopenverse</a></s>
<a class="reference external" href="https://github.com/dhruvkb/monoverse/">&#64;dhruvkb/monoverse</a>. You can refer to
the fork, but note that it is a comes from a place of haste and has not been
treated with the same level of love and care that the final treatment will
receive.</p>
</section>
<section id="step-0-prerequisites">
<h3>Step 0: Prerequisites<a class="headerlink" href="#step-0-prerequisites" title="Permalink to this heading">#</a></h3>
<section id="get-the-timing-right">
<h4>Get the timing right<a class="headerlink" href="#get-the-timing-right" title="Permalink to this heading">#</a></h4>
<p>The first step will be to release the API and frontend, call a code freeze on
both of them and pause work on both. This is to prevent the repos from
continuing to drift as we merge a snapshot of them into the
<code class="docutils literal notranslate"><span class="pre">WordPress/openverse</span></code> repo.</p>
<p>This can prove difficult given how productive our team is, so we will need to
channel this productivity towards the catalog in the meantime. I can foresee the
end-to-end migration taking one week (ideal scenario) to becoming workable
again, and another week (for us to iron out any gaps in the docs and
references).</p>
<section id="timeline-breakdown">
<h5>Timeline breakdown<a class="headerlink" href="#timeline-breakdown" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>Day 1: Merging the repos and resolving conflicts, restoring broken workflows
except deploys</p></li>
<li><p>Day 2: Restoring deployment workflows including staging auto-deploy</p></li>
<li><p>Day 3: Transfer of issues from individual repos to monorepo</p></li>
<li><p>Day 4: Documentation fixes</p></li>
<li><p>Day 5: Housekeeping</p></li>
</ul>
<p>The second week is planned as a buffer in case any of these tasks ends up taking
more time than a day, if something breaks or if someone falls ill etc. The ideal
scenario is that we’re completely back next week, the worst one takes two.</p>
<p>Note that in the transition period nothing will break. The old repos will
continue to exists as they are, till we ensure everything works and then we
archive the current split repos.</p>
</section>
</section>
</section>
<section id="step-1-merge-with-histories">
<h3>Step 1: Merge with histories<a class="headerlink" href="#step-1-merge-with-histories" title="Permalink to this heading">#</a></h3>
<p>This should be quick save for a few merge conflicts. In case of conflict refer
to the resolution adopted by
<a class="reference external" href="https://github.com/dhruvkb/monoverse/">&#64;dhruvkb/monoverse</a>, and apply the
resolution to the files. Do not blindly copy code from
<a class="reference external" href="https://github.com/dhruvkb/monoverse/">&#64;dhruvkb/monoverse</a> as it might be out
of sync with the current state of the files.</p>
<p>Add remotes.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>api<span class="w"> </span>../openverse-api
$<span class="w"> </span>git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>frontend<span class="w"> </span>../openverse-frontend
</pre></div>
</div>
<section id="merging-api">
<h4>Merging API<a class="headerlink" href="#merging-api" title="Permalink to this heading">#</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>pull<span class="w"> </span>api<span class="w"> </span>main<span class="w"> </span>--allow-unrelated-histories
</pre></div>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Expected conflicts</p></th>
<th class="head"><p>Resolution</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>.github/CODEOWNERS</p></td>
<td><p>Folderwise separation of owners, use from <a class="reference external" href="https://github.com/dhruvkb/monoverse/">&#64;dhruvkb/monoverse</a></p></td>
</tr>
<tr class="row-odd"><td><p>.prettierignore</p></td>
<td><p>Merge entries from all repos, use from <a class="reference external" href="https://github.com/dhruvkb/monoverse/">&#64;dhruvkb/monoverse</a></p></td>
</tr>
<tr class="row-even"><td><p>.pre-commit-config.yaml</p></td>
<td><p>Python + Node.js linting, use from <a class="reference external" href="https://github.com/dhruvkb/monoverse/">&#64;dhruvkb/monoverse</a></p></td>
</tr>
<tr class="row-odd"><td><p>justfile</p></td>
<td><p>Split into many smaller <code class="docutils literal notranslate"><span class="pre">justfile</span></code>s and one root<sup>a</sup></p></td>
</tr>
<tr class="row-even"><td><p>.gitignore</p></td>
<td><p>Split into many smaller <code class="docutils literal notranslate"><span class="pre">.gitignore</span></code>s and one root<sup>b</sup></p></td>
</tr>
<tr class="row-odd"><td><p>CONTRIBUTING.md</p></td>
<td><p>Write new, referencing doc site</p></td>
</tr>
<tr class="row-even"><td><p>README.md</p></td>
<td><p>Write new, referencing doc site</p></td>
</tr>
</tbody>
</table>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>.<span class="w"> </span><span class="c1"># Stage files with conflicts resolved</span>
$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Merge branch &#39;main&#39; of openverse-api&quot;</span>
</pre></div>
</div>
<p><strong>a:</strong> see the following:</p>
<ul class="simple">
<li><p>https://github.com/dhruvkb/monoverse/blob/main/justfile</p></li>
<li><p>https://github.com/dhruvkb/monoverse/blob/main/automations/justfile</p></li>
<li><p>https://github.com/dhruvkb/monoverse/blob/main/api/justfile</p></li>
<li><p>https://github.com/dhruvkb/monoverse/blob/main/ingestion_server/justfile</p></li>
<li><p>https://github.com/dhruvkb/monoverse/blob/main/load_testing/justfile</p></li>
</ul>
<p><strong>b:</strong> see the following</p>
<ul class="simple">
<li><p>https://github.com/dhruvkb/monoverse/blob/main/.gitignore</p></li>
<li><p>https://github.com/dhruvkb/monoverse/blob/main/api/.gitignore</p></li>
<li><p>https://github.com/dhruvkb/monoverse/blob/main/ingestion_server/.gitignore</p></li>
<li><p>https://github.com/dhruvkb/monoverse/blob/main/ingestion_server/test/.gitignore
(unchanged)</p></li>
<li><p>https://github.com/dhruvkb/monoverse/blob/main/load_testing/.gitignore
(unchanged)</p></li>
<li><p>https://github.com/dhruvkb/monoverse/blob/main/nginx/.gitignore (unchanged)</p></li>
</ul>
</section>
<section id="merging-frontend">
<h4>Merging frontend<a class="headerlink" href="#merging-frontend" title="Permalink to this heading">#</a></h4>
<p>Change workdir to WordPress/openverse-frontend repo.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mkdir<span class="w"> </span>frontend
</pre></div>
</div>
<p>Move everything into it except the following directories and files:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>File / directory</p></th>
<th class="head"><p>Reason</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>.git/</p></td>
<td><p>For obvious reasons</p></td>
</tr>
<tr class="row-odd"><td><p>.github/</p></td>
<td><p>Must be in the root</p></td>
</tr>
<tr class="row-even"><td><p>.npmrc</p></td>
<td><p>For <code class="docutils literal notranslate"><span class="pre">pnpm</span></code> workspaces</p></td>
</tr>
<tr class="row-odd"><td><p>.pnpmfile.cjs</p></td>
<td><p>For <code class="docutils literal notranslate"><span class="pre">pnpm</span></code> workspaces</p></td>
</tr>
<tr class="row-even"><td><p>.editorconfig</p></td>
<td><p>Useful across the monorepo</p></td>
</tr>
<tr class="row-odd"><td><p>.eslintignore</p></td>
<td><p>Read by ESLint running in pre-commit</p></td>
</tr>
<tr class="row-even"><td><p>.eslintrc.js</p></td>
<td><p>Read by ESLint running in pre-commit</p></td>
</tr>
<tr class="row-odd"><td><p>.prettierignore</p></td>
<td><p>Read by Prettier running in pre-commit</p></td>
</tr>
<tr class="row-even"><td><p>prettier.config.js</p></td>
<td><p>Read by Prettier running in pre-commit</p></td>
</tr>
<tr class="row-odd"><td><p>.pre-commit-config.yaml</p></td>
<td><p>Read by pre-commit</p></td>
</tr>
<tr class="row-even"><td><p>LICENSE</p></td>
<td><p>Root-level docs</p></td>
</tr>
<tr class="row-odd"><td><p>README.md</p></td>
<td><p>Root-level docs</p></td>
</tr>
<tr class="row-even"><td><p>CODE_OF_CONDUCT.md</p></td>
<td><p>Root-level docs</p></td>
</tr>
<tr class="row-odd"><td><p>CONTRIBUTING.md</p></td>
<td><p>Root-level docs</p></td>
</tr>
</tbody>
</table>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>.<span class="w"> </span><span class="c1"># Stage all renamed files</span>
$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Nest code under \`frontend/\`&quot;</span>
</pre></div>
</div>
<p>Switch to the monorepo.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>pull<span class="w"> </span>frontend<span class="w"> </span>main<span class="w"> </span>--allow-unrelated-histories
</pre></div>
</div>
<p>Since we fixed these files when merging the API, almost all these conflicts are
redundant.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Expected conflicts</p></th>
<th class="head"><p>Resolution</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>.github/CODEOWNERS</p></td>
<td><p>Use existing</p></td>
</tr>
<tr class="row-odd"><td><p>.prettierignore</p></td>
<td><p>Use existing</p></td>
</tr>
<tr class="row-even"><td><p>.pre-commit-config.yaml</p></td>
<td><p>Uncomment the commented regions</p></td>
</tr>
<tr class="row-odd"><td><p>.gitignore</p></td>
<td><p>Use existing</p></td>
</tr>
<tr class="row-even"><td><p>prettier.config.js</p></td>
<td><p>Use existing</p></td>
</tr>
<tr class="row-odd"><td><p>README.md</p></td>
<td><p>Use existing</p></td>
</tr>
<tr class="row-even"><td><p>CONTRIBUTING.md</p></td>
<td><p>Use existing</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="housekeeping">
<h4>Housekeeping<a class="headerlink" href="#housekeeping" title="Permalink to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Create “stack: *” labels to help with issue and PR management.
Spoiler/foreshadowing: these labels will be used for more things later.</p></li>
<li><p>Migrate issues from <code class="docutils literal notranslate"><span class="pre">WordPress/openverse-frontend</span></code> and
<code class="docutils literal notranslate"><span class="pre">WordPress/openverse-api</span></code>. We can directly transfer the issues, retaining all
their comments. Apply the “stack: frontend” / “stack: backend” label to them
after moving.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Substitute repo with WordPress/openverse-frontend and WordPress/openverse-api</span>
$<span class="w"> </span>gh<span class="w"> </span>api<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-X<span class="w"> </span>GET<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>repos/WordPress/&lt;repo&gt;/issues<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-f<span class="w"> </span><span class="nv">pulls</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-f<span class="w"> </span><span class="nv">state</span><span class="o">=</span>all<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--jq<span class="w"> </span><span class="s1">&#39;.[].number&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--paginate<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-I<span class="w"> </span>num<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>gh<span class="w"> </span>issue<span class="w"> </span>transfer<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>num<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>WordPress/openverse<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-R<span class="w"> </span>WordPress/&lt;repo&gt;
</pre></div>
</div>
<p>With this done, we can archive the API and frontend repo. The following notice
will be added to the <code class="docutils literal notranslate"><span class="pre">README.md</span></code> files for clarification before archiving.</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>This repository has moved to
<a class="reference external" href="https://github.com/wordpress/openverse">WordPress/openverse</a> as part of a
monorepo.</p>
</div></blockquote>
</section>
</section>
<section id="step-1-restore-functionality">
<h3>Step 1. Restore functionality<a class="headerlink" href="#step-1-restore-functionality" title="Permalink to this heading">#</a></h3>
<section id="combine-linting">
<h4>Combine linting<a class="headerlink" href="#combine-linting" title="Permalink to this heading">#</a></h4>
<p>All lint steps can be combined in <code class="docutils literal notranslate"><span class="pre">.pre-commit-config.yaml</span></code>. This also implies
the CI jobs can now be merged.</p>
<ol class="arabic simple">
<li><p>Remove pre-commit scripts from <code class="docutils literal notranslate"><span class="pre">frontend/package.json</span></code> and the
<code class="docutils literal notranslate"><span class="pre">install-pre-commit.sh</span></code> script.</p></li>
<li><p>Remove <code class="docutils literal notranslate"><span class="pre">lint</span></code> job from CI, there are plenty of those.</p></li>
</ol>
</section>
<section id="pnpm-workspace">
<h4><code class="docutils literal notranslate"><span class="pre">pnpm</span></code> workspace<a class="headerlink" href="#pnpm-workspace" title="Permalink to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Move <code class="docutils literal notranslate"><span class="pre">frontend/.pnpmfile.cjs</span></code> outside to the root directory, update the
reference to <code class="docutils literal notranslate"><span class="pre">frontend/package.json</span></code>.</p></li>
<li><p>Remove <code class="docutils literal notranslate"><span class="pre">frontend/.npmrc</span></code> created earlier because <code class="docutils literal notranslate"><span class="pre">pnpm</span></code> will automatically
use the one in the root of the workspace.</p></li>
<li><p>Create <code class="docutils literal notranslate"><span class="pre">pnpm-workspaces.yaml</span></code> file, see
https://github.com/dhruvkb/monoverse/blob/main/.pre-commit-config.yaml.</p></li>
<li><p>Update the <code class="docutils literal notranslate"><span class="pre">package.json</span></code> files, see the following:</p>
<ul class="simple">
<li><p>https://github.com/dhruvkb/monoverse/blob/main/package.json</p></li>
<li><p>https://github.com/dhruvkb/monoverse/blob/main/frontend/package.json</p></li>
<li><p>https://github.com/dhruvkb/monoverse/blob/main/automations/js/package.json</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">pnpm</span> <span class="pre">i</span></code> in the monorepo root.</p></li>
<li><p>Update the recipe <code class="docutils literal notranslate"><span class="pre">pnpm</span></code> in <code class="docutils literal notranslate"><span class="pre">frontend/justfile</span></code> to include
<code class="docutils literal notranslate"><span class="pre">--filter</span> <span class="pre">&quot;openverse-frontend&quot;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">-m</span> <span class="pre">&quot;Setup</span> <span class="pre">workspaces&quot;</span></code></p></li>
</ol>
</section>
</section>
<section id="step-3-restore-workflows">
<h3>Step 3. Restore workflows<a class="headerlink" href="#step-3-restore-workflows" title="Permalink to this heading">#</a></h3>
<section id="new-actions">
<h4>New actions<a class="headerlink" href="#new-actions" title="Permalink to this heading">#</a></h4>
<p>To clean up the workflows we will define three new actions. The code for all
three is available at
<a class="reference external" href="https://github.com/dhruvkb/monoverse/">&#64;dhruvkb/monoverse</a>.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">setup-env</span></code> to setup Just, Node.js and Python or a subset of these.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">load-img</span></code> to download Docker images into <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> and load them in Docker.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">build-docs</span></code> to build and merge Sphinx, Storybook and Tailwind Config Viewer.</p></li>
</ol>
</section>
<section id="update-workflows">
<h4>Update workflows<a class="headerlink" href="#update-workflows" title="Permalink to this heading">#</a></h4>
<p>Workflows with major changes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ci_cd.yml</span></code> from the API will absorb <code class="docutils literal notranslate"><span class="pre">ci.yml</span></code> from the frontend</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lint.yml</span></code> will be deleted</p></li>
</ul>
<p>Updates:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">migration_safety_warning.yml</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">generate_pot.yml</span></code></p></li>
</ul>
<p>With this done, the development on the API and frontend can continue inside
their subdirectories. The development of both parts will be independent, at
least until we reach <a class="reference internal" href="#step-5-long-term-consolidation">long-term consolidation</a>.</p>
</section>
<section id="deployment">
<h4>Deployment<a class="headerlink" href="#deployment" title="Permalink to this heading">#</a></h4>
<section id="staging">
<h5>Staging<a class="headerlink" href="#staging" title="Permalink to this heading">#</a></h5>
<p>The soon-to-be-ECS-based API and ECS-based frontend will continue to deploy to
staging via the CI + CD pipeline, with deployment starting as soon as all CI
checks have passed. They will use similar code as the frontend auto-deploy for
staging used currently.</p>
<p>These will be separate jobs with specific
<a class="reference external" href="https://github.com/dorny/paths-filter">path-based filters</a>.</p>
</section>
<section id="production">
<h5>Production<a class="headerlink" href="#production" title="Permalink to this heading">#</a></h5>
<p>For production, we will not be able to use GitHub Releases and will have to use
a manually-triggered workflow to build the assets and tag them. The tag can be
set via a workflow input (simple) or can be calculated based on the update scope
of major, minor or patch (not as simple).</p>
</section>
</section>
</section>
<section id="step-3-housekeeping-and-dx-cleanup">
<h3>Step 3. Housekeeping and DX cleanup<a class="headerlink" href="#step-3-housekeeping-and-dx-cleanup" title="Permalink to this heading">#</a></h3>
<p>There will be a few rough edges that I cannot foresee and we can continuously
fix those as we spot them. But up to this point we should be in a position where
we can continue to build the API and the frontend independently but from one
repo.</p>
<ol class="arabic simple">
<li><p>The action <code class="docutils literal notranslate"><span class="pre">banyan/auto-label</span></code> will need to be configured (<code class="docutils literal notranslate"><span class="pre">auto-label.json</span></code>)
to add the “stack: *” labels based on the modified directory.</p></li>
</ol>
</section>
<section id="step-4-documentation-merge">
<h3>Step 4. Documentation merge<a class="headerlink" href="#step-4-documentation-merge" title="Permalink to this heading">#</a></h3>
<p>The following documentation files will need reorganisation or merge.</p>
<ul class="simple">
<li><p>README.md (both repos)</p></li>
<li><p>CODE_OF_CONDUCT.md (both repos)</p></li>
<li><p>CONTRIBUTING.md (both repos)</p></li>
<li><p>CONTRIBUTORS.md (API only; also why?)</p></li>
<li><p>DOCUMENTATION_GUIDELINES.md (API only)</p></li>
<li><p>TESTING_GUIDELINES.md (frontend only)</p></li>
<li><p>DEPLOYMENT.md (frontend only)</p></li>
</ul>
<p>I will need more information about this because IANAL.</p>
<ul class="simple">
<li><p>LICENSE (both repos)</p></li>
</ul>
</section>
<section id="step-5-long-term-consolidation">
<h3>Step 5. Long-term consolidation<a class="headerlink" href="#step-5-long-term-consolidation" title="Permalink to this heading">#</a></h3>
<p>This is the long term combination of code for the frontend and the API. Ideas
like end-to-end testing go here. This is beyond my imagination at the moment,
and more importantly, beyond the scope of this RFC. It will surely be covered in
future RFCs.</p>
<p>Thanks for reading and providing feedback.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../trust_and_safety/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Trust &amp; Safety</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Monorepo</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Project Proposal - 2022-11-24</a><ul>
<li><a class="reference internal" href="#reviewers">Reviewers</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a><ul>
<li><a class="reference internal" href="#benefits-of-monorepo">Benefits of monorepo</a></li>
</ul>
</li>
<li><a class="reference internal" href="#migration-path">Migration path</a><ul>
<li><a class="reference internal" href="#reference">Reference</a></li>
<li><a class="reference internal" href="#step-0-prerequisites">Step 0: Prerequisites</a><ul>
<li><a class="reference internal" href="#get-the-timing-right">Get the timing right</a><ul>
<li><a class="reference internal" href="#timeline-breakdown">Timeline breakdown</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#step-1-merge-with-histories">Step 1: Merge with histories</a><ul>
<li><a class="reference internal" href="#merging-api">Merging API</a></li>
<li><a class="reference internal" href="#merging-frontend">Merging frontend</a></li>
<li><a class="reference internal" href="#housekeeping">Housekeeping</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-1-restore-functionality">Step 1. Restore functionality</a><ul>
<li><a class="reference internal" href="#combine-linting">Combine linting</a></li>
<li><a class="reference internal" href="#pnpm-workspace"><code class="docutils literal notranslate"><span class="pre">pnpm</span></code> workspace</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-3-restore-workflows">Step 3. Restore workflows</a><ul>
<li><a class="reference internal" href="#new-actions">New actions</a></li>
<li><a class="reference internal" href="#update-workflows">Update workflows</a></li>
<li><a class="reference internal" href="#deployment">Deployment</a><ul>
<li><a class="reference internal" href="#staging">Staging</a></li>
<li><a class="reference internal" href="#production">Production</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#step-3-housekeeping-and-dx-cleanup">Step 3. Housekeeping and DX cleanup</a></li>
<li><a class="reference internal" href="#step-4-documentation-merge">Step 4. Documentation merge</a></li>
<li><a class="reference internal" href="#step-5-long-term-consolidation">Step 5. Long-term consolidation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="https://unpkg.com/mermaid@9.4.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    </body>
</html>