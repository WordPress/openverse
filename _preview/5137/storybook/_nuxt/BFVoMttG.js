import{d as W,a as N}from"./DTU7yJca.js";import{_ as Y}from"./CTdiwjRx.js";import{u as K}from"./BnDRGrsR.js";import{u as x}from"./HSkZLNjo.js";import{f as B}from"./Xs_VBmP5.js";import{d as k,C as r,w as O,H as o,F as S,G as M,P as g,Q as D,V as v,I as b,D as w,E as Q,n as z,K as p,L as U,M as X,R as T,Y as V,S as J,N as Z,O as P}from"./-WkxctKM.js";import{I as ee}from"./CRWjC3CT.js";import{g as te,V as ae}from"./BOoHbPWX.js";import{_ as se}from"./D7Nvdm8A.js";import{h as ie,w as ne}from"./C36Bf8YV.js";import{a as le}from"./C_4PSVgb.js";import{_ as oe}from"./CP1e7QSb.js";import{V as G}from"./CmiN-34A.js";import{V as F}from"./CVV9gpzL.js";import{u as re}from"./DNZ0QEaN.js";import{_ as ce}from"./BKKKF4W5.js";import{u as ue}from"./RxpDUvxm.js";import{v as de}from"./BPwGQkdi.js";import{u as me}from"./CB8vaXoq.js";import{_ as pe}from"./03xrtDWI.js";import{u as fe}from"./BXAcwQ7Y.js";import{_ as he}from"./C0aPY4k7.js";const it=k({__name:"VRelatedMedia",props:{mediaType:{},relatedTo:{}},setup(n){const a=n,t=W(),s=K(),e=r(()=>{const f=t.media??[];return{type:a.mediaType,items:f}});O(s,async f=>{const $=B(f==null?void 0:f.params.id);$&&$!==t.mainMediaId&&await t.fetchMedia(a.mediaType,$)},{immediate:!0});const c=r(()=>t.fetchState.isFetching),d=r(()=>e.value.items.length>0||c.value),i=r(()=>B(s==null?void 0:s.query.q)??""),{t:h}=x({useScope:"global"}),m=r(()=>{const f=a.mediaType==="audio"?"audioDetails.relatedAudios":"imageDetails.relatedImages";return h(f)});return(f,$)=>d.value?(o(),S(Y,{key:0,results:e.value,"is-fetching":c.value,"collection-label":m.value,kind:"related","related-to":f.relatedTo,"search-term":i.value,"aria-label":m.value},{header:M(()=>[g("h2",{id:"related-heading",class:D(["heading-6 mb-6",e.value.type==="image"?"md:heading-5":"lg:heading-6"])},v(m.value),3)]),_:1},8,["results","is-fetching","collection-label","related-to","search-term","aria-label"])):b("",!0)}}),ge={class:"-my-1.5px"},ve=3,E=k({__name:"VCollapsibleTagSection",props:{tags:{},mediaType:{}},setup(n){const a=n,t=w(),s=N(),{$sendCustomEvent:e}=re(),c=l=>s.getCollectionPath({type:a.mediaType,collectionParams:{collection:"tag",tag:l}}),d=r(()=>Array.from(new Set(a.tags.map(l=>l.name)))),i=w(),{localeProperties:h}=x({useScope:"global"}),m=r(()=>h.value.dir);function f(l,u){return m.value==="rtl"?l.offsetLeft<u.offsetLeft:l.offsetLeft>u.offsetLeft}function $(l){const u=Array.from(l.children);if(!u.length)return 0;let y=0;for(let C=0;C<u.length;C++){const R=u[C],A=R.previousElementSibling;if(A?f(A,R)&&y++:y++,y===ve+1)return C}return u.length}const q=r(()=>i.value&&_.value==="show"?d.value.slice(0,i.value):d.value),I=r(()=>i.value&&i.value<d.value.length);Q(()=>{t.value&&(i.value=$(t.value))});const _=w("show"),H=()=>{_.value=_.value==="show"?"hide":"show",e("TOGGLE_TAG_EXPANSION",{toState:_.value==="show"?"collapsed":"expanded"}),_.value==="hide"&&i.value&&z(()=>{var u;if(!i.value)return;const l=(u=t.value)==null?void 0:u.children.item(i.value);le(l==null?void 0:l.querySelector("a"))})},j=r(()=>I.value?_.value==="show"?"max-h-[7.6875rem]":"mah-h-none":"max-h-none"),L=w();return ie(t,l=>{L.value=l[0].contentRect.width}),ne(L,(l,u)=>{if(!t.value)return;u&&l&&l>u&&(i.value=d.value.length),z(()=>{t.value&&(i.value=$(t.value))})},{debounce:300}),(l,u)=>(o(),p("div",ge,[g("ul",{ref_key:"tagsContainerRef",ref:t,class:D(["flex flex-wrap gap-3 overflow-y-hidden p-1.5px",j.value])},[(o(!0),p(U,null,X(q.value,y=>(o(),p("li",{key:y},[T(oe,{href:c(y)},{default:M(()=>[V(v(y),1)]),_:2},1032,["href"])]))),128))],2),I.value?(o(),S(G,{key:0,size:"small",variant:"transparent-tx","has-icon-end":"",class:"label-bold -ms-2 mt-4 hover:underline","aria-expanded":_.value==="show"?"false":"true",onClick:H},{default:M(()=>[V(v(l.$t(_.value==="show"?"mediaDetails.tags.showMore":"mediaDetails.tags.showLess")),1),T(F,{name:"caret-down",size:4,class:D({"-scale-y-100 transform":_.value==="hide"})},null,8,["class"])]),_:1},8,["aria-expanded"])):b("",!0)]))}}),_e={class:"flex flex-col gap-6 sm:gap-8"},ye={key:0},Te={key:0,class:"label-regular mb-2"},be={key:1,class:"sr-only"},$e={key:1},Se={class:"label-regular mb-2 flex gap-2"},ke=k({__name:"VMediaTags",props:{tags:{},mediaType:{},provider:{}},setup(n){const a=n,t=r(()=>{const i=[],h=[];for(const m of a.tags)m.unstable__provider&&m.unstable__provider!==a.provider?i.push(m):h.push(m);return{generated:i,source:h}}),s=r(()=>t.value.source.length>0),e=r(()=>t.value.generated.length>0),c=ue(),d=r(()=>c("/tags"));return(i,h)=>(o(),p("div",_e,[s.value?(o(),p("div",ye,[e.value?(o(),p("h3",Te,v(i.$t("mediaDetails.tags.source.heading")),1)):(o(),p("h3",be,v(i.$t("mediaDetails.tags.title")),1)),T(E,{"media-type":i.mediaType,tags:t.value.source},null,8,["media-type","tags"])])):b("",!0),e.value?(o(),p("div",$e,[g("div",Se,[g("h3",null,v(i.$t("mediaDetails.tags.generated.heading")),1),T(ce,{href:d.value},{default:M(()=>[V(v(i.$t("mediaDetails.tags.generated.pageTitle")),1)]),_:1},8,["href"])]),T(E,{"media-type":i.mediaType,tags:t.value.generated},null,8,["media-type","tags"])])):b("",!0)]))}}),we={class:"flex flex-col gap-y-6 md:gap-y-8"},Me={class:"flex flex-row items-center justify-between"},Ce={class:"heading-6 md:heading-5"},xe={class:"flex flex-col items-start gap-6 md:flex-row"},Pe={class:"flex flex-col gap-6 md:gap-8"},De={class:"flex w-full flex-grow flex-col items-start gap-6 md:flex-row"},Ve={key:0},nt=k({__name:"VMediaDetails",props:{media:{}},setup(n){const a=n,t=x({useScope:"global"}),s=r(()=>{if(!a.media)return null;const e=a.media.frontendMediaType===ee?{width:a.media.width,height:a.media.height,type:a.media.filetype}:{};return te(a.media,t,e)});return(e,c)=>(o(),p("section",we,[g("header",Me,[g("h2",Ce,v(e.$t(`mediaDetails.${e.media.frontendMediaType}Info`)),1),T(se,{media:e.media},null,8,["media"])]),g("div",xe,[J(e.$slots,"thumbnail"),g("div",Pe,[g("div",De,[e.media.description?(o(),p("p",Ve,v(e.media.description),1)):b("",!0),s.value?(o(),S(ae,{key:1,metadata:s.value},null,8,["metadata"])):b("",!0)]),T(ke,{tags:e.media.tags,"media-type":e.media.frontendMediaType,provider:e.media.provider},null,8,["tags","media-type","provider"])])])]))}}),Ie={class:"hidden md:block"},Le=k({__name:"VHideButton",emits:["click"],setup(n){const a=fe(),t=r(()=>a.isBreakpoint("md"));return(s,e)=>(o(),p("div",null,[t.value?(o(),S(G,{key:0,variant:"transparent-gray",class:"label-bold",size:"small","has-icon-end":"",onClick:e[0]||(e[0]=c=>s.$emit("click"))},{default:M(()=>[g("span",Ie,v(s.$t("sensitiveContent.singleResult.hide")),1),T(F,{name:"eye-closed"})]),_:1})):(o(),S(he,{key:1,variant:"transparent-gray","icon-props":{name:"eye-closed"},size:"small",label:s.$t("sensitiveContent.singleResult.hide"),onClick:e[1]||(e[1]=c=>s.$emit("click"))},null,8,["label"]))]))}}),Re={class:"flex w-full justify-between px-4 pb-4 md:px-8"},lt=k({__name:"VSingleResultControls",props:{media:{}},setup(n){const a=n,t=N(),s=r(()=>t.backToSearchPath),{hide:e,canBeHidden:c}=me(a.media);return(d,i)=>Z((o(),p("div",Re,[s.value?(o(),S(pe,{key:0,id:d.media.id,href:s.value},null,8,["id","href"])):b("",!0),P(c)?(o(),S(Le,{key:1,class:"ml-auto",onClick:P(e)},null,8,["onClick"])):b("",!0)],512)),[[de,P(c)||s.value]])}}),Ae=({title:n,thumbnail:a,isSensitive:t})=>{const s={meta:[]},e=[];return n&&e.push({key:"og:title",property:"og:title",content:n}),a&&!t&&e.push({key:"og:image",property:"og:image",content:a}),s.meta=e,s},ot=n=>{var h;const{t:a}=x({useScope:"global"}),t=()=>n.value?{genericTitle:`${a(`mediaDetails.reuse.${n.value.frontendMediaType}`)}`,sensitiveTitle:`${a(`sensitiveContent.title.${n.value.frontendMediaType}`)}`}:{genericTitle:"",sensitiveTitle:""},s=r(()=>{var m;return((m=n.value)==null?void 0:m.isSensitive)??!1}),e=()=>n.value?s.value?t().sensitiveTitle:n.value.title??t().genericTitle:"",c=()=>`${e()} | Openverse`,d=w(c()),i=Ae({title:e(),thumbnail:(h=n.value)==null?void 0:h.thumbnail,isSensitive:s.value});return O(n,()=>{d.value=c()}),{pageTitle:d,detailPageMeta:i}};export{lt as _,nt as a,it as b,ot as u};
