import{u as z}from"./HSkZLNjo.js";import{D as w,C as b,d as S,Z as E,H as n,F as u,G as d,R,Y as f,V as s,O as p,K as h,P as l,N as P,L as G,M as H,I as K}from"./-WkxctKM.js";import{o as W}from"./CGhfLDww.js";import{m as Z}from"./Xs_VBmP5.js";import{V as C}from"./CmiN-34A.js";import{V as j}from"./DjzJpTMR.js";import{_ as N}from"./BKKKF4W5.js";import{c as Q}from"./BPwGQkdi.js";import{u as X,d as Y}from"./DNZ0QEaN.js";const _="dmca",J="sensitive",$="other",ee=[_,J,$],y="sent",U="failed",M="wip",F="https://docs.google.com/forms/d/e/1FAIpQLSd0I8GsEbGQLdaX4K_F6V2NbHZqN137WMZgnptUpzwd-kbDKA/viewform",Ve=()=>{const m=w(M),r=c=>{m.value=c},{t:i}=z({useScope:"global"}),t=b(()=>m.value===M?i("mediaDetails.contentReport.long"):m.value===y?i("mediaDetails.contentReport.success.title"):i("mediaDetails.contentReport.failure.title"));return{status:m,updateStatus:r,title:t}},te=S({__name:"VDmcaNotice",props:{foreignLandingUrl:{},provider:{}},emits:["click"],setup(m){return(r,i)=>{const t=E("i18n-t");return n(),u(t,{scope:"global",class:"dmca-notice leading-normal",keypath:"mediaDetails.contentReport.form.dmca.note",tag:"p"},{form:d(()=>[R(N,{"aria-label":r.$t("mediaDetails.contentReport.form.dmca.form"),href:p(F),class:"text-link hover:underline",onClick:i[0]||(i[0]=c=>r.$emit("click"))},{default:d(()=>[f(s(r.$t("mediaDetails.contentReport.form.dmca.form")),1)]),_:1},8,["aria-label","href"])]),source:d(()=>[R(N,{href:r.foreignLandingUrl,class:"text-link hover:underline"},{default:d(()=>[f(s(r.provider),1)]),_:1},8,["href"])]),_:1})}}}),oe={class:"other-form min-h-[7rem]",for:"description"},ae={class:"flex flex-row items-center justify-between"},ne=["placeholder","required","minlength"],se=S({__name:"VReportDescForm",props:{content:{default:""},reason:{}},emits:["update:content"],setup(m,{emit:r}){const i=m,t=r,c=b({get:()=>i.content,set:a=>t("update:content",a)}),o=b(()=>i.reason===$);return(a,g)=>(n(),h("label",oe,[l("span",ae,[l("span",null,s(a.$t("mediaDetails.contentReport.form.other.note")),1),l("span",null,s(a.$t(`mediaDetails.contentReport.form.${a.reason}.subLabel`)),1)]),P(l("textarea",{id:"description","onUpdate:modelValue":g[0]||(g[0]=k=>c.value=k),class:"placeholder-text-secondary mt-2 h-20 w-full rounded-sm border border-tertiary bg-default p-2 text-default focus-visible:border-focus disabled:bg-surface",placeholder:a.$t(`mediaDetails.contentReport.form.${a.reason}.placeholder`),required:o.value,minlength:o.value?20:0,maxlength:"500"},null,8,ne),[[Q,c.value]])]))}}),re={id:"content-report-form"},ie={key:0},le={key:1},de={class:"text-sm"},me={key:2},ce={class:"mb-4 text-sm leading-normal"},ue={class:"flex flex-col gap-y-4"},pe={class:"label-bold mb-4"},fe={class:"leading-normal"},ve={class:"flex flex-row items-center justify-end gap-x-4"},Ce=S({__name:"VContentReportForm",props:{media:{},status:{},allowCancel:{type:Boolean}},emits:["close","update-status"],setup(m,{expose:r,emit:i}){const t=m,c=i,o=w(_),a=w(""),g=()=>{o.value=_,a.value=""},k=b(()=>`${Y().public.apiUrl}v1/${Z(t.media.frontendMediaType)}/${t.media.id}/report/`),L=b(()=>`${F}?entry.917669540=https://openverse.org/${t.media.frontendMediaType}/${t.media.id}`),I=()=>{g(),c("close")},x=b(()=>o.value===$&&a.value.length<20),{$sendCustomEvent:q}=X(),T=()=>{V(y)},A=async e=>{e.preventDefault();try{await W(k.value,{method:"POST",body:{mediaType:t.media.frontendMediaType,reason:o.value,identifier:t.media.id,description:a.value}}),V(y)}catch{V(U)}},V=e=>{e===y&&q("REPORT_MEDIA",{id:t.media.id,mediaType:t.media.frontendMediaType,provider:t.media.provider,reason:o.value}),c("update-status",e)};return r({resetForm:g}),(e,D)=>{const B=E("i18n-t");return n(),h("div",re,[e.status===p(y)?(n(),h("div",ie,[R(B,{scope:"global",keypath:"mediaDetails.contentReport.success.note",class:"text-sm",tag:"p"},{source:d(()=>[R(N,{href:e.media.foreign_landing_url,class:"text-link hover:underline"},{default:d(()=>[f(s(e.media.providerName),1)]),_:1},8,["href"])]),_:1})])):e.status===p(U)?(n(),h("div",le,[l("p",de,s(e.$t("mediaDetails.contentReport.failure.note")),1)])):(n(),h("div",me,[l("p",ce,s(e.$t("mediaDetails.contentReport.form.disclaimer",{openverse:"Openverse"})),1),l("form",{class:"flex flex-col gap-y-4 text-sm",onSubmit:A},[l("fieldset",ue,[l("legend",pe,s(e.$t("mediaDetails.contentReport.form.question")),1),(n(!0),h(G,null,H(p(ee),v=>(n(),u(j,{id:v,key:v,modelValue:o.value,"onUpdate:modelValue":D[0]||(D[0]=O=>o.value=O),name:"reason",value:v},{default:d(()=>[f(s(e.$t(`mediaDetails.contentReport.form.${v}.option`)),1)]),_:2},1032,["id","modelValue","value"]))),128))]),l("div",fe,[o.value===p(_)?(n(),u(te,{key:0,provider:e.media.providerName,"foreign-landing-url":e.media.foreign_landing_url,onClick:T},null,8,["provider","foreign-landing-url"])):(n(),u(se,{key:"other",content:a.value,"onUpdate:content":D[1]||(D[1]=v=>a.value=v),reason:o.value,"is-required":o.value===p($)},null,8,["content","reason","is-required"]))]),l("div",ve,[e.allowCancel?(n(),u(C,{key:0,variant:"bordered-gray",size:"medium",class:"label-bold",onClick:I},{default:d(()=>[f(s(e.$t("mediaDetails.contentReport.form.cancel")),1)]),_:1})):K("",!0),o.value===p(_)?(n(),u(C,{key:"dmca",as:"VLink",variant:"filled-dark",size:"medium",class:"label-bold","has-icon-end":"","show-external-icon":"","external-icon-size":6,href:L.value,"send-external-link-click-event":!1,target:"_blank",onClick:T},{default:d(()=>[f(s(e.$t("mediaDetails.contentReport.form.dmca.open")),1)]),_:1},8,["href"])):(n(),u(C,{key:"non-dmca",type:"submit",disabled:x.value,"focusable-when-disabled":!0,variant:"filled-dark",size:"medium",class:"label-bold",value:e.$t("mediaDetails.contentReport.form.submit")},{default:d(()=>[f(s(e.$t("mediaDetails.contentReport.form.submit")),1)]),_:1},8,["disabled","value"]))])],32)]))])}}});export{M as W,Ce as _,Ve as u};
