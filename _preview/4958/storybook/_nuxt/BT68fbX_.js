import{u as M}from"./2vq21tXV.js";import{u as R}from"./xwskLidM.js";import{u as V}from"./CIg47mny.js";import{v as L}from"./C67TMzvP.js";import{s as w}from"./DivIZ7Lb.js";import{b as k}from"./CzMkt2mC.js";import{u as B,a as C}from"./nLTbcOiO.js";import{V as P}from"./9Q23NzEb.js";import{d as D,G as s,z as l,H as x,T as p,D as F,I as N,M as A,E as I,C as U,X as z,U as H}from"./lKNUlTH_.js";const W=D({__name:"VLoadMore",props:{kind:{},searchTerm:{},relatedTo:{},searchType:{},isFetching:{type:Boolean}},emits:["load-more"],setup(f,{emit:h}){const o=f,g=h,r=s(null),v=V(),{t:n}=M({useScope:"global"}),c=B(),a=C(),{$sendCustomEvent:i}=R(),{currentPage:b}=w(c),u=l(()=>{let e=a.strategy==="default"?"search":"collection";const m=a.collectionValue??"null";return{searchType:o.searchType,query:o.searchTerm,resultPage:b.value||1,kind:e,collectionType:m,collectionValue:a.collectionValue??"null"}}),y=l(()=>c.canLoadMore),t=s(!1),E=async()=>{o.isFetching||(t.value=!1,i("LOAD_MORE_RESULTS",u.value),g("load-more"))},S=()=>{i("REACH_RESULT_END",u.value)},T=l(()=>o.isFetching?n("browsePage.loading"):n("browsePage.load")),d=s(null);x(()=>{d.value=document.getElementById("main-page")});const _=k(r,{scrollTarget:d});return p(v,()=>{t.value=!1}),p(_,e=>{if(e){if(t.value)return;S(),t.value=!0}}),(e,m)=>(F(),N("div",{ref_key:"loadMoreSectionRef",ref:r,class:"w-full"},[A(I(P,{class:"label-bold lg:description-bold h-16 w-full lg:h-18",variant:"filled-gray",size:"disabled",disabled:e.isFetching,"data-testid":"load-more",onClick:E},{default:U(()=>[z(H(T.value),1)]),_:1},8,["disabled"]),[[L,y.value]])],512))}});export{W as _};
